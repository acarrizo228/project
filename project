script_name('helper-for-mia')
script_version(11.7)

require 'lib.moonloader'
local weapons           = require 'lib.game.weapons'
local sf                = require 'lib.sampfuncs'
local mad               = require 'MoonAdditions'
local KEY               = require 'vkeys'
local rkeys             = require 'rkeys'
local memory            = require 'memory'
local imgui             = require 'imgui'
local pie               = require 'imgui_piemenu'
local encoding          = require 'encoding'
local color             = require "colorise"
local inicfg            = require 'inicfg'
local ffi               = require "ffi"
local getBonePosition   = ffi.cast("int (__thiscall*)(void*, float*, int, bool)", 0x5E4280)
local lanes             = require('lanes').configure()
local dlstatus          = require('moonloader').download_status
local font_flag         = require('moonloader').font_flag
local bNotf, notf       = pcall(import, "imgui_notf1.lua")
lsampev, sampev         = pcall(require, 'lib.samp.events')
imgui.HotKey            = require('imgui_addons').HotKey
encoding.default        = 'CP1251'
u8                      = encoding.UTF8

local tCarsName = {"Landstalker", "Bravura", "Buffalo", "Linerunner", "Perrenial", "Sentinel", "Dumper", "Firetruck", "Trashmaster", "Stretch", "Manana", "Infernus",
	"Voodoo", "Pony", "Mule", "Cheetah", "Ambulance", "Leviathan", "Moonbeam", "Esperanto", "Taxi", "Washington", "Bobcat", "Whoopee", "BFInjection", "Hunter",
	"Premier", "Enforcer", "Securicar", "Banshee", "Predator", "Bus", "Rhino", "Barracks", "Hotknife", "Trailer", "Previon", "Coach", "Cabbie", "Stallion", "Rumpo",
	"RCBandit", "Romero","Packer", "Monster", "Admiral", "Squalo", "Seasparrow", "Pizzaboy", "Tram", "Trailer", "Turismo", "Speeder", "Reefer", "Tropic", "Flatbed",
	"Yankee", "Caddy", "Solair", "Berkley'sRCVan", "Skimmer", "PCJ-600", "Faggio", "Freeway", "RCBaron", "RCRaider", "Glendale", "Oceanic", "Sanchez", "Sparrow",
	"Patriot", "Quad", "Coastguard", "Dinghy", "Hermes", "Sabre", "Rustler", "ZR-350", "Walton", "Regina", "Comet", "BMX", "Burrito", "Camper", "Marquis", "Baggage",
	"Dozer", "Maverick", "NewsChopper", "Rancher", "FBIRancher", "Virgo", "Greenwood", "Jetmax", "Hotring", "Sandking", "BlistaCompact", "PoliceMaverick",
	"Boxvillde", "Benson", "Mesa", "RCGoblin", "HotringRacerA", "HotringRacerB", "BloodringBanger", "Rancher", "SuperGT", "Elegant", "Journey", "Bike",
	"MountainBike", "Beagle", "Cropduster", "Stunt", "Tanker", "Roadtrain", "Nebula", "Majestic", "Buccaneer", "Shamal", "hydra", "FCR-900", "NRG-500", "HPV1000",
	"CementTruck", "TowTruck", "Fortune", "Cadrona", "FBITruck", "Willard", "Forklift", "Tractor", "Combine", "Feltzer", "Remington", "Slamvan", "Blade", "Freight",
	"Streak", "Vortex", "Vincent", "Bullet", "Clover", "Sadler", "Firetruck", "Hustler", "Intruder", "Primo", "Cargobob", "Tampa", "Sunrise", "Merit", "Utility", "Nevada",
	"Yosemite", "Windsor", "Monster", "Monster", "Uranus", "Jester", "Sultan", "Stratum", "Elegy", "Raindance", "RCTiger", "Flash", "Tahoma", "Savanna", "Bandito",
	"FreightFlat", "StreakCarriage", "Kart", "Mower", "Dune", "Sweeper", "Broadway", "Tornado", "AT-400", "DFT-30", "Huntley", "Stafford", "BF-400", "NewsVan",
	"Tug", "Trailer", "Emperor", "Wayfarer", "Euros", "Hotdog", "Club", "FreightBox", "Trailer", "Andromada", "Dodo", "RCCam", "Launch", "PoliceCar", "PoliceCar",
	"PoliceCar", "PoliceRanger", "Picador", "SWAT", "Alpha", "Phoenix", "GlendaleShit", "SadlerShit", "Luggage A", "Luggage B", "Stairs", "Boxville", "Tiller",
	"UtilityTrailer"
}

local tCarsTypeName = {"Автомобиль", "Мотоцикл", "Вертолёт", "Самолёт", "Прицеп", "Лодка", "Другое", "Поезд", "Велосипед"}

local tCarsSpeed = {43, 40, 51, 30, 36, 45, 30, 41, 27, 43, 36, 61, 46, 30, 29, 53, 42, 30, 32, 41, 40, 42, 38, 27, 37,
	54, 48, 45, 43, 55, 51, 36, 26, 30, 46, 0, 41, 43, 39, 46, 37, 21, 38, 35, 30, 45, 60, 35, 30, 52, 0, 53, 43, 16, 33, 43,
	29, 26, 43, 37, 48, 43, 30, 29, 14, 13, 40, 39, 40, 34, 43, 30, 34, 29, 41, 48, 69, 51, 32, 38, 51, 20, 43, 34, 18, 27,
	17, 47, 40, 38, 43, 41, 39, 49, 59, 49, 45, 48, 29, 34, 39, 8, 58, 59, 48, 38, 49, 46, 29, 21, 27, 40, 36, 45, 33, 39, 43,
	43, 45, 75, 75, 43, 48, 41, 36, 44, 43, 41, 48, 41, 16, 19, 30, 46, 46, 43, 47, -1, -1, 27, 41, 56, 45, 41, 41, 40, 41,
	39, 37, 42, 40, 43, 33, 64, 39, 43, 30, 30, 43, 49, 46, 42, 49, 39, 24, 45, 44, 49, 40, -1, -1, 25, 22, 30, 30, 43, 43, 75,
	36, 43, 42, 42, 37, 23, 0, 42, 38, 45, 29, 45, 0, 0, 75, 52, 17, 32, 48, 48, 48, 44, 41, 30, 47, 47, 40, 41, 0, 0, 0, 29, 0, 0
}

local tCarsType = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1,
	3, 1, 1, 1, 1, 6, 1, 1, 1, 1, 5, 1, 1, 1, 1, 1, 7, 1, 1, 1, 1, 6, 3, 2, 8, 5, 1, 6, 6, 6, 1,
	1, 1, 1, 1, 4, 2, 2, 2, 7, 7, 1, 1, 2, 3, 1, 7, 6, 6, 1, 1, 4, 1, 1, 1, 1, 9, 1, 1, 6, 1,
	1, 3, 3, 1, 1, 1, 1, 6, 1, 1, 1, 3, 1, 1, 1, 7, 1, 1, 1, 1, 1, 1, 1, 9, 9, 4, 4, 4, 1, 1, 1,
	1, 1, 4, 4, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 7, 1, 1, 1, 1, 8, 8, 7, 1, 1, 1, 1, 1, 1, 1,
	1, 3, 1, 1, 1, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 1, 1, 1, 1, 8, 8, 7, 1, 1, 1, 1, 1, 4,
	1, 1, 1, 2, 1, 1, 5, 1, 2, 1, 1, 1, 7, 5, 4, 4, 7, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 5, 5, 1, 5, 5
}

local TypeWeapon = {1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 3, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1}

local InfoWeapon = {{'Щит', false, 'shit', 'bshit', 1},
	{'Дубинка', false, 'button', 'bbutton', 1},
	{'Бронежилет', false, 'armour', 'barmour', 1},
	{'Маска', false, 'mask', 'bmask', 1},
	{'SD pistol', true, 'sd', 'bsd', 250},
	{'Desert Eagle', true, 'deagle', 'bdeagle', 250},
	{'MP5', true, 'mp5', 'bmp5', 400},
	{'ShotGun', true, 'shotgun', 'bshotgun', 100},
	{'Дымовые шашки', true, 'smoke', 'bsmoke', 25},
	{'Sniper Rifle', true, 'sniper', 'bsniper', 50},
	{'M4', true, 'm4', 'bm4', 350},
	{'AK-47', true, 'ak47', 'bak47', 350}
}

local commands = {
	'КОМАНДА | УРОВЕНЬ | ОПИСАНИЕ',
	'/r | 1 | Сообщение в обычную рацию',
	'/rn | 1 | NRP-chat обычной рации',
	'/f | 1 | Сообщение в общую волну',
	'/fn | 1 | NRP-chat общей волны',
	'/cuff | 1 | Надеть наручники на подозреваемого',
	'/uncuff | 1 | Снять наручники с подозреваемого',
	'/arrest | 1 | Отправить подозреваемого в департамент',
	'/pull | 1 | Вытащить подозреваемого из автомобиля',
	'/su | 1 | Объявить подозреваемого в розыск',
	'/skip | 1 | Выдать временный пропуск игроку',
	'/clear | 1 | Очистить уровень розыска для игрока',
	'/follow | 1 | Начать прослушивание',
	'/hold | 1 | Тащить игрока за собой',
	'/ticket | 1 | Выписать штраф нарушителю',
	'/takelic | 1 | Изъять лицензию на вождение',
	'/rights | 1 | Зачитать права игроку',
	'/putpl | 1 | Посадить подозреваемого в автомобиль',
	'/search | 1 | Обыскать подозреваемого',
	'/hack | 1 | Взломать дверь дома',
	'/ud | 1 | Показать удостоверение',
	'/pas | 1 | Запросить документы у игрока',
	'/invite | 1 | Принять игрока в организацию',
	'/uninvite | 1 | Уволить игрока из организации',
	'/rang | 1 | Изменить ранг игрока',
	'/changeskin | 1 | Изменить внешность игрока',
	'  |   |  ',
	'ДОП. КОМАНДА | УРОВЕНЬ | ОПИСАНИЕ',
	'/mh | 1 | Открыть основное меню',
	'/update | 1 | Информация о последнем обновлении',
	'/admins | 2 | Открыть админ-список',
	'/users | 1 | Открыть список пользователей',
	'/gov | 4 | Отправить гос. новость',
	'/rec | 1 | Переподключится к серверу',
	'/recn | 1 | Переподключится к серверу со сменой ника',
	'/recd | 1 | Переподключится к другому серверу',
	'/account | 1 | Авто-подключение к серверу',
	'/bl_name | 1 | Проверить никнейм на наличие в ЧС',
	'/bl_hist | 1 | Проверить весь history на наличие в ЧС',
	'/ainfo | 1 | Открыть информационное меню',
	'/rkinfo | 1 | Получить информацию о RK',
	'/rep | 1 | Быстрая отправка сообщения в репорт',
	'/asms | 1 | Быстрая отправка SMS-сообщений',
	'/addbl | 1 | Добавить в чёрный список телефона',
	'/delbl | 1 | Удалить из чёрного списка телефона',
	'/епк | 1 | Найти информацию о ЕПК',
	'/устав | 1 | Найти информацию о УМВД',
	'/sw | 1 | Изменить погоду',
	'/st | 1 | Изменить время',
	'/skin | 2 | Установить визуальный скин для игрока',
	'/hist | 1 | Открыть history игрока по его ID',
	'/strobes | 1 | Включить стробоскопы',
	'  |   |  ',
	'КЛАВИША | УРОВЕНЬ | ОПИСАНИЕ',
	'NumPad3 | 1 | Открыть основное меню',
	'ПКМ + 1 | 1 | Съесть еду',
	'ПКМ + 2 | 1 | Открыть шлагбаум',
	'ПКМ + 3 | 1 | Потребовать автомобиль остановится',
	'ПКМ + 4 | 1 | Объявить о пешей погоне',
	'ПКМ + 5 | 1 | Объявить игрока в розыск',
	'ПКМ + Z | 1 | Быстрое меню (взаимод. с игроком)',
	'ПКМ | 1 | Полу-автоматическая отыгровка оружия',
	'Alt + R | 1 | Полу-автоматическая отыгровка оружия',
	'C + 1 | 1 | Включить CamHack',
	'C + 2 | 1 | Выключить CamHack',
	'Z | 1 | Быстрое меню',
	'Alt | 1 | Включить стробоскопы',
	'L | 1 | Открыть или закрыть свою машину'
}

local frac = {
	name = {'mvd', 'prav', 'mm', 'mo', 'mz', 'lcn', 'rm', 'yak', 'grv', 'bal', 'vag', 'azt', 'rif', 'civ', 'mask', 'all'},
	fullname = {'Министерство внутренних дел', 'Правительство', 'Средства массовой информации', 'Министерство обороны', 'Министерство здравоохранения', 'La Cosa Nostra', 'Russian Mafia', 'Yakuza', 'Grove Street', 'The Ballas', 'Los Santos Vagos', 'Varios los Aztecas', 'The Rifa', 'Гражданские', 'В маске', 'Прочее'},
	color = {'{0000ff}', '{ccff00}', '{ff6600}', '{996633}', '{ff6666}', '{993366}', '{007575}', '{bb0000}', '{009900}', '{cc00ff}', '{ffcd00}', '{00ccff}', '{6666ff}', '{ffffff}', '{ffffff}', '{ffffff}'},
}

local descript_f = {
	ScrollbarGrab = 'Неизвестно', 
	CloseButtonHovered = 'Цвет при наведение на крестик, закрывающий меню.', 
	ComboBg = 'Не используется', 
	ResizeGrip = 'Цвет окон ввода данных', 
	ScrollbarGrabActive = 'Цвет клавиши скролла при нажатие', 
	HeaderHovered = 'Неизвестно', 
	ButtonHovered = 'Цвет клавиши при наведение', 
	FrameBgHovered = 'Неизвестно', 
	FrameBgActive = 'Неизвестно', 
	FrameBg = 'Неизвестно', 
	ScrollbarBg = 'Цвет скролла', 
	ButtonActive = 'Цвет клавиши при нажатие', 
	ResizeGripHovered = 'Цвет окна ввода при наведение', 
	ResizeGripActive = 'Цвет окна ввода при нажатие', 
	CheckMark = 'Цвет галочки в окнах выбора', 
	ScrollbarGrabHovered = 'Цвет скролла при наведение', 
	SliderGrabActive = 'Неизвестно', 
	HeaderActive = 'Неизвестно', 
	Button = 'Цвет клавиши', 
	CloseButtonActive = 'Цвет при нажатие на крестик, закрывающий меню', 
	TitleBgActive = 'Цвет верхней полосы в меню', 
	CloseButton = 'Цвет крестика, закрывающего меню', 
	WindowBg = 'Цвет фона', 
	TextSelectedBg = 'Неизвестно', 
	SliderGrab = 'Неизвестно', 
	Header = 'Неизвестно', 
	TitleBgCollapsed = 'Не используется', 
	TitleBg = 'Не используется', 
	Text = 'Цвет текста'
}

local static = {
	skin = nil,
	clock = {hour = nil, minute = nil},
	weather = nil
}

local ini = inicfg.load({
	info = {
		name                 = '',
		rang                 = '',
		frac                 = '',
		number               = '',
		male                 = true,
		female               = false,
		rteg                 = '',
		fteg                 = ''
	},
	set = {
		masktimer            = false,
		camera               = false,
		stopad               = false,
		strobes              = false,
		radio                = false,
		autopass             = false,
		autoweapon           = false,
		lowrp                = false,
		rpweapon             = false,
		autorpweapon         = false,
		halfrpweapon         = false,
		delay_rk             = 10,
		message_megafon      = false,
		new_leaders          = true,
		new_find             = true,
		new_clock            = true,
		new_group            = true,
		new_wanted           = true,
		blacklist            = '',
		streetlight          = false,
		slhour               = 21,
		mslhour              = 7,
		kvadrocopter         = false,
		pkvadrocopter        = false,
		skvadrocopter        = false,
		strob_lr             = 500
	},
	weapon = {
		shit                 = false,
		button               = false,
		armour               = false,
		mask                 = false,
		sd                   = false,
		bsd                  = 1,
		deagle               = false,
		bdeagle              = 1,
		mp5                  = false,
		bmp5                 = 1,
		shotgun              = false,
		bshotgun             = 1,
		smoke                = false,
		bsmoke               = 1,
		sniper               = false,
		bsniper              = 1,
		m4                   = false,
		bm4                  = 1,
		ak47                 = false,
		bak47                = 1
	},
	rpweapon = {
		Brass_Knuckles       = '',
		Golf_Club            = '',
		Nightstick           = '',
		Knife                = '',
		Baseball_Bat         = '',
		Shovel               = '',
		Pool_Cue             = '',
		Katana               = '',
		Chainsaw             = '',
		Purple_Dildo         = '',
		Dildo                = '',
		Vibrator             = '',
		Silver_Vibrator      = '',
		Flowers              = '',
		Cane                 = '',
		Grenade              = '',
		Tear_Gas             = '',
		Molotov_Cocktail     = '',
		p9mm                 = '',
		Silenced_9mm         = '',
		Desert_Eagle         = 'схатившись правой рукой за пистолет, вытащил его из кобуры',
		Shotgun              = 'взявшись за ремень дробовика, снял его с плеча и взял в руки',
		Sawnoff_Shotgun      = '',
		Combat_Shotgun       = '',
		Micro_Uzi            = '',
		MP5                  = 'скинул пистолет-пулемёт MP-5 с плеча и взял его в руки',
		AK_47                = '',
		M4                   = '',
		Tec_9                = '',
		Country_Rifle        = '',
		Sniper_Rifle         = '',
		RPG                  = '',
		HS_Rocket            = '',
		Flamethrower         = '',
		Minigun              = '',
		Satchel_Charge       = '',
		Detonator            = '',
		Spraycan             = '',
		Fire_Extinguisher    = '',
		Camera               = '',
		Night_Vis_Goggles    = '',
		Thermal_Goggles      = '',
		Parachute            = ''
	},
	rpweaponoff = {
		Brass_Knuckles       = '',
		Golf_Club            = '',
		Nightstick           = '',
		Knife                = '',
		Baseball_Bat         = '',
		Shovel               = '',
		Pool_Cue             = '',
		Katana               = '',
		Chainsaw             = '',
		Purple_Dildo         = '',
		Dildo                = '',
		Vibrator             = '',
		Silver_Vibrator      = '',
		Flowers              = '',
		Cane                 = '',
		Grenade              = '',
		Tear_Gas             = '',
		Molotov_Cocktail     = '',
		p9mm                 = '',
		Silenced_9mm         = '',
		Desert_Eagle         = 'убрал пистолет обратно в кобуру, застягнув её',
		Shotgun              = 'повесил дробовик обратно на плечо, придерживая за ремень',
		Sawnoff_Shotgun      = '',
		Combat_Shotgun       = '',
		Micro_Uzi            = '',
		MP5                  = 'повесил пистолет-пулемёт MP-5 обратно на плечо',
		AK_47                = '',
		M4                   = '',
		Tec_9                = '',
		Country_Rifle        = '',
		Sniper_Rifle         = '',
		RPG                  = '',
		HS_Rocket            = '',
		Flamethrower         = '',
		Minigun              = '',
		Satchel_Charge       = '',
		Detonator            = '',
		Spraycan             = '',
		Fire_Extinguisher    = '',
		Camera               = '',
		Night_Vis_Goggles    = '',
		Thermal_Goggles      = '',
		Parachute            = ''
	},
	lowrp = {
		rphealme             = false,
		rpmask               = false,
		rpfbi                = false,
		rpbar                = false,
		rpradio              = false,
		unmask               = false
	},
	custom = {
		ScrollbarGrab = 1525125412,
		CloseButtonHovered = 1525125412,
		ComboBg = 1525125412,
		ResizeGrip = 1522877218,
		ScrollbarGrabActive = 1525125412,
		HeaderHovered = 1525125412,
		ButtonHovered = 2529510178,
		FrameBgHovered = 1522877218,
		FrameBgActive = 2529510178,
		FrameBg = 1522877218,
		ScrollbarBg = 1525125412,
		ButtonActive = 1522877218,
		ResizeGripHovered = 2191869489,
		ResizeGripActive = 2529510178,
		CheckMark = 1525125412,
		ScrollbarGrabHovered = 1522877218,
		SliderGrabActive = 1525125412,
		HeaderActive = 1525125412,
		Button = 1522877218,
		CloseButtonActive = 1525125412,
		TitleBgActive = 4039459618,
		CloseButton = 2529510178,
		WindowBg = 4028175123,
		TextSelectedBg = 1525125412,
		SliderGrab = 1522877218,
		Header = 1525125412,
		TitleBgCollapsed = 851788578,
		TitleBg = 24124124,
		Text = 4294967295
	},
	cmd = {
		admins = 'admins | -1',
		r = 'r | r',
		rn = 'rn | -1',
		f = 'f | f',
		fn = 'fn | -1',
		cuff = 'cuff | cuff',
		uncuff = 'uncuff | uncuff',
		arrest = 'arrest | arrest',
		pull = 'pull | pull',
		su = 'su | su',
		skip = 'skip | skip',
		clear = 'clear | clear',
		hold = 'hold | hold',
		ticket = 'ticket | ticket',
		takelic = 'takelic | takelic',
		putpl = 'putpl | putpl',
		rights = 'rights | -1',
		search = 'search | search',
		follow = 'follow | follow',
		hack = 'hack | hack',
		invite = 'invite | invite',
		uninvite = 'uninvite | uninvite',
		rang = 'rang | rang',
		changeskin = 'changeskin | changeskin',
		ud = 'ud | -1',
		pas = 'pas | -1',
		rep = 'rep | -1',
		uk = 'ук | -1',
		ak = 'ак | -1',
		kod = 'код | -1',
		ustav = 'устав | -1',
		sw = 'sw | -1',
		st = 'st | -1',
		skin = 'skin | -1',
		history = 'hist | history',
		asms = 'asms | sms',
		gov = 'gov | -1',
		addbl = 'addbl | -1',
		delbl = 'delbl | -1',
		pay = 'pay | pay',
		users = 'users | -1',
		rkinfo = 'rkinfo | -1',
		sms = 'sms | sms',
		open = 'open | open',
		bl_hist = 'bl_hist | -1',
		bl_name = 'bl_name | -1',
		akick = 'akick | -1',
		rec = 'rec | -1',
		recn = 'recn | -1',
		recd = 'recd | -1',
		account = 'account | -1',
		radio_tag = 'rtag | -1',
		add_obj = 'add_obj | -1',
		edit_obj = 'edit_obj | -1',
		del_obj = 'del_obj | -1',
		add_text = 'add_text | -1',
		del_text = 'del_text | -1',
		edit_text = 'edit_text | -1',
	},
	hkey = {
		eat = '2, 49',
		open = '2, 50',
		onvec_m = '2, 51',
		onfoot_m = '2, 52',
		smart_su = '2, 53',
		lock = '76',
		menu = '99',
		fast_menu = '90',
		camera = '123',
		camhack_on = '67, 49',
		camhack_off = '67, 50',
		strob_left = '77',
		strob_right = '66'
	},
	custom_hkey = {
	},
	number = {
	}
}, 'Helper for MIA.ini')

local pass = inicfg.load({
	red = {},
	green = {},
	yellow = {},
	orange = {},
	blue = {},
	white = {},
	silver = {},
	purple = {},
	chocolate = {} 
}, 'password.ini')

local hotkey_butt = {
	eat = {key = {v = {}}, last = {}, bind = -1, name = 'Использоние еды (/eat)'},
	open = {key = {v = {}}, last = {}, bind = -1, name = 'Открытие шлагбаума (/open)'},
	lock = {key = {v = {}}, last = {}, bind = -1, name = 'Открыть или закрыть машину (/lock)'},
	menu = {key = {v = {}}, last = {}, bind = -1, name = 'Открыть или закрыть основное меню'},
	fast_menu = {key = {v = {}}, last = {}, bind = -1, name = 'Открыть или закрыть быстрое меню'},
	camera = {key = {v = {}}, last = {}, bind = -1, name = 'Клавиша для использования RP-камеры'},
	onvec_m = {key = {v = {}}, last = {}, bind = -1, name = 'Использование мегафона в машине'},
	onfoot_m = {key = {v = {}}, last = {}, bind = -1, name = 'Сообщение о погоне в рацию'},
	smart_su = {key = {v = {}}, last = {}, bind = -1, name = 'Использование быстрого розыска'},
	camhack_on = {key = {v = {}}, last = {}, bind = -1, name = 'Включить CamHack'},
	camhack_off = {key = {v = {}}, last = {}, bind = -1, name = 'Выключить CamHack'},
	strob_left = {key = {v = {}}, last = {}, bind = -1, name = 'Включить правый поворотник'},
	strob_right = {key = {v = {}}, last = {}, bind = -1, name = 'Включить левый поворотник'}
}

local hotkey_cust_butt = {}

local color_red          = '{CD5C5C}'
local color_orange       = '{F4A460}'
local color_green        = '{00CD66}'
local show_player        = ''
local users              = ''
local server             = ''
local skin_table         = {}
local lgov               = {}
local info_scene         = {}
local logchat            = {}
local logdmg             = {}
local dreason            = {}
local gnews              = {}
local suspect_id         = {}
local last_message       = {name = '', id = -1}
local player_rang        = {}
local object             = {}
local weapon             = {}
local sus_table          = {}
local command_t          = {}
local static_camera      = {}
local mark_vehicle       = {}
local smart_suspect      = {id = nil, text = {}}
local param_cmd          = 0
local last_sms           = 0
local lweap              = 0
local gov_delay          = 0
local rpweaponid         = 1
local speed              = 0.3
local flymode            = false
local showtimer          = false
local autopass           = false
local cActive            = false
local follow_state       = false
local timerActive        = false
local skillplus          = false
local openbar            = false
local successful_login   = false
local player_status      = 0
local show_menu          = imgui.ImBool(false)
local piemenu            = imgui.ImBool(false)
local show_help          = imgui.ImBool(false)
local show_info          = imgui.ImBool(false)
local show_suspect       = imgui.ImBool(false)
local show_uk_list       = imgui.ImBool(false)
local vfilt              = imgui.ImBool(false)
local lines              = imgui.ImBool(false)
local command_edit       = imgui.ImBool(false)
local spypass            = imgui.ImBool(true)
local show_item          = imgui.ImInt(8)
local set_item           = imgui.ImInt(0)
local page_num           = imgui.ImInt(0)
local weaponid           = imgui.ImInt(46)
local strob_lr           = imgui.ImInt(ini.set.strob_lr)
local commandid          = imgui.ImInt(0)
local inpball            = imgui.ImInt(5)
local pdelay_rk          = imgui.ImInt(ini.set.delay_rk)
local pgaline1           = imgui.ImBuffer(250)
local pgline1            = imgui.ImBuffer(250)
local pgline2            = imgui.ImBuffer(250)
local pgline3            = imgui.ImBuffer(250)
local idnews             = imgui.ImBuffer(4)
local pname              = imgui.ImBuffer(256)
local prang              = imgui.ImBuffer(256)
local pfrac              = imgui.ImBuffer(256)
local pnumber            = imgui.ImBuffer(256)
local rteg               = imgui.ImBuffer(256)
local fteg               = imgui.ImBuffer(256)
local name_cmd           = imgui.ImBuffer(256)
local takeweap           = imgui.ImBuffer(256)
local takeweapoff        = imgui.ImBuffer(256)
local url_bl             = imgui.ImBuffer(500)
local cmduse             = imgui.ImBuffer(30)
local cmdinp             = imgui.ImBuffer(30)
local inpcomment         = imgui.ImBuffer(1000)
local search_place       = imgui.ImBuffer(1000)
local text_cmd           = imgui.ImBuffer(9999)
local admins             = imgui.ImBuffer(9999)
local male				 = imgui.ImBool(not ini.info.male)
local pcamera            = imgui.ImBool(ini.set.camera)
local pstopad            = imgui.ImBool(ini.set.stopad)
local pmasktimer         = imgui.ImBool(ini.set.masktimer)
local pstrobes           = imgui.ImBool(ini.set.strobes)
local pradio             = imgui.ImBool(ini.set.radio)
local pautopass          = imgui.ImBool(ini.set.autopass)
local pautoweapon        = imgui.ImBool(ini.set.autoweapon)
local prpweapon          = imgui.ImBool(ini.set.rpweapon)
local plowrp             = imgui.ImBool(ini.set.lowrp)
local pnew_leaders       = imgui.ImBool(ini.set.new_leaders)
local pnew_find          = imgui.ImBool(ini.set.new_find)
local pnew_clock         = imgui.ImBool(ini.set.new_clock)
local pnew_group         = imgui.ImBool(ini.set.new_group)
local pnew_wanted        = imgui.ImBool(ini.set.new_wanted)
local prpradio           = imgui.ImBool(ini.lowrp.rpradio)
local prphealme          = imgui.ImBool(ini.lowrp.rphealme)
local prpmask            = imgui.ImBool(ini.lowrp.rpmask)
local prpfbi             = imgui.ImBool(ini.lowrp.rpfbi)
local prpbar             = imgui.ImBool(ini.lowrp.rpbar)
local pmessage_megafon   = imgui.ImBool(ini.set.message_megafon)
local pstreetlight       = imgui.ImBool(ini.set.streetlight)
local pslhour            = imgui.ImInt(ini.set.slhour)
local pmslhour           = imgui.ImInt(ini.set.mslhour)
local punmask            = imgui.ImBool(ini.lowrp.unmask)
local pkvadrocopter      = imgui.ImBool(ini.set.kvadrocopter)
local ppkvadrocopter     = imgui.ImBool(ini.set.pkvadrocopter)
local pskvadrocopter     = imgui.ImBool(ini.set.skvadrocopter)
local editor             = imgui.ImBool(false)

function main()
	if not isSampLoaded() or not isSampfuncsLoaded() then return end
	while not isSampAvailable() do wait(100) end
	
	autoupdate('https://raw.githubusercontent.com/skezz-perry/project/master/version', 'https://raw.githubusercontent.com/skezz-perry/project/master/project')

	attempToGetFileAndDir()
	
	sampRegisterChatCommand(string.match(ini.cmd.admins, '(.+) | (.+)'), command_admins)
	sampRegisterChatCommand(string.match(ini.cmd.r, '(.+) | (.+)'), command_r)
	sampRegisterChatCommand(string.match(ini.cmd.rn, '(.+) | (.+)'), command_rn)
	sampRegisterChatCommand(string.match(ini.cmd.f, '(.+) | (.+)'), command_f)
	sampRegisterChatCommand(string.match(ini.cmd.fn, '(.+) | (.+)'), command_fn)
	sampRegisterChatCommand(string.match(ini.cmd.cuff, '(.+) | (.+)'), command_cuff)
	sampRegisterChatCommand(string.match(ini.cmd.uncuff, '(.+) | (.+)'), command_uncuff)
	sampRegisterChatCommand(string.match(ini.cmd.arrest, '(.+) | (.+)'), command_arrest)
	sampRegisterChatCommand(string.match(ini.cmd.pull, '(.+) | (.+)'), command_pull)
	sampRegisterChatCommand(string.match(ini.cmd.su, '(.+) | (.+)'), command_su)
	sampRegisterChatCommand(string.match(ini.cmd.skip, '(.+) | (.+)'), command_skip)
	sampRegisterChatCommand(string.match(ini.cmd.clear, '(.+) | (.+)'), command_clear)
	sampRegisterChatCommand(string.match(ini.cmd.hold, '(.+) | (.+)'), command_hold)
	sampRegisterChatCommand(string.match(ini.cmd.ticket, '(.+) | (.+)'), command_ticket)
	sampRegisterChatCommand(string.match(ini.cmd.takelic, '(.+) | (.+)'), command_takelic)
	sampRegisterChatCommand(string.match(ini.cmd.putpl, '(.+) | (.+)'), command_putpl)
	sampRegisterChatCommand(string.match(ini.cmd.rights, '(.+) | (.+)'), command_rights)
	sampRegisterChatCommand(string.match(ini.cmd.search, '(.+) | (.+)'), command_search)
	sampRegisterChatCommand(string.match(ini.cmd.follow, '(.+) | (.+)'), command_follow)
	sampRegisterChatCommand(string.match(ini.cmd.hack, '(.+) | (.+)'), command_hack)
	sampRegisterChatCommand(string.match(ini.cmd.invite, '(.+) | (.+)'), command_invite)
	sampRegisterChatCommand(string.match(ini.cmd.uninvite, '(.+) | (.+)'), command_uninvite)
	sampRegisterChatCommand(string.match(ini.cmd.rang, '(.+) | (.+)'), command_rang)
	sampRegisterChatCommand(string.match(ini.cmd.changeskin, '(.+) | (.+)'), command_changeskin)
	sampRegisterChatCommand(string.match(ini.cmd.ud, '(.+) | (.+)'), command_ud)
	sampRegisterChatCommand(string.match(ini.cmd.pas, '(.+) | (.+)'), command_pas)
	sampRegisterChatCommand(string.match(ini.cmd.rep, '(.+) | (.+)'), command_report)
	sampRegisterChatCommand(string.match(ini.cmd.uk, '(.+) | (.+)'), command_uk)
	sampRegisterChatCommand(string.match(ini.cmd.ak, '(.+) | (.+)'), command_ak)
	sampRegisterChatCommand(string.match(ini.cmd.kod, '(.+) | (.+)'), command_code)
	sampRegisterChatCommand(string.match(ini.cmd.ustav, '(.+) | (.+)'), command_ustav)
	sampRegisterChatCommand(string.match(ini.cmd.sw, '(.+) | (.+)'), command_setweather)
	sampRegisterChatCommand(string.match(ini.cmd.st, '(.+) | (.+)'), command_settime)
	sampRegisterChatCommand(string.match(ini.cmd.skin, '(.+) | (.+)'), command_setskin)
	sampRegisterChatCommand(string.match(ini.cmd.history, '(.+) | (.+)'), command_history) 
	sampRegisterChatCommand(string.match(ini.cmd.asms, '(.+) | (.+)'), command_asms)
	sampRegisterChatCommand(string.match(ini.cmd.gov, '(.+) | (.+)'), command_gov)
	sampRegisterChatCommand(string.match(ini.cmd.addbl, '(.+) | (.+)'), command_addbl)
	sampRegisterChatCommand(string.match(ini.cmd.delbl, '(.+) | (.+)'), command_delbl)
	sampRegisterChatCommand(string.match(ini.cmd.pay, '(.+) | (.+)'), command_apay)
	sampRegisterChatCommand(string.match(ini.cmd.users, '(.+) | (.+)'), command_users)
	sampRegisterChatCommand(string.match(ini.cmd.rkinfo, '(.+) | (.+)'), command_rkinfo)
	sampRegisterChatCommand(string.match(ini.cmd.sms, '(.+) | (.+)'), command_sms)
	sampRegisterChatCommand(string.match(ini.cmd.open, '(.+) | (.+)'), command_open)
	sampRegisterChatCommand(string.match(ini.cmd.bl_hist, '(.+) | (.+)'), command_bl)
	sampRegisterChatCommand(string.match(ini.cmd.bl_name, '(.+) | (.+)'), command_namebl)
	sampRegisterChatCommand(string.match(ini.cmd.akick, '(.+) | (.+)'), command_rofl)
	sampRegisterChatCommand(string.match(ini.cmd.rec, '(.+) | (.+)'), command_reconnect)
	sampRegisterChatCommand(string.match(ini.cmd.recn, '(.+) | (.+)'), command_reconnectwithchange)
	sampRegisterChatCommand(string.match(ini.cmd.recd, '(.+) | (.+)'), command_reconnectwithchangeip)
	sampRegisterChatCommand(string.match(ini.cmd.account, '(.+) | (.+)'), command_account)
	sampRegisterChatCommand(string.match(ini.cmd.radio_tag, '(.+) | (.+)'), command_radiotag) 
	sampRegisterChatCommand(string.match(ini.cmd.add_obj, '(.+) | (.+)'), command_cobject)
	sampRegisterChatCommand(string.match(ini.cmd.del_obj, '(.+) | (.+)'), command_dobject)
	sampRegisterChatCommand(string.match(ini.cmd.edit_obj, '(.+) | (.+)'), command_eobject)
	sampRegisterChatCommand(string.match(ini.cmd.add_text, '(.+) | (.+)'), command_ctext)
	sampRegisterChatCommand(string.match(ini.cmd.del_text, '(.+) | (.+)'), command_dtext)
	sampRegisterChatCommand(string.match(ini.cmd.edit_text, '(.+) | (.+)'), command_etext)
	
	--[[sampRegisterChatCommand('sendvk', function(text)
		if string.match(text, '(%S+)') then
			local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
			local name = sampGetPlayerNickname(id)
			
			local text = string.format('-\n%s\n(id %d ~ rang %d) %s ~ %s\n-', u8(sampGetCurrentServerName()), id, player_status, name, u8(text))
			tovk(text)
		else
			SCM('Используйте команду /sendvk [текст]')
		end
	end)]]
	
	sampRegisterChatCommand('savecords', function(id)
		if flymode then
			if string.match(id, '(%d+)') then
				if static_camera[tonumber(id)] ~= nil then
					table.insert(static_camera, tonumber(id), {posX = posX, posY = posY, posZ = posZ, poiX = poiX, poiY = poiY, poiZ = poiZ, angZ = angZ})
					SCM(string.format('Изменено и сохранено расположение камеры {FFCD00}#%d{ffffff} в текущих координатах.', id))
				else
					SCM('Невозможно сохранить расположение камеры в не индексированном месте.')
				end
			else
				if #static_camera < 9 then
					table.insert(static_camera, {posX = posX, posY = posY, posZ = posZ, poiX = poiX, poiY = poiY, poiZ = poiZ, angZ = angZ})
					SCM(string.format('Сохранено расположение камеры {FFCD00}#%d{ffffff} в текущих координатах.', #static_camera))
				else
					SCM('Использовано максимально возможное количество слотов сохранения камеры.')
				end
			end
		else
			SCM('Для использование функции сохранения позиции камеры вы должны включить CamHack.')
		end
	end)
	
	sampRegisterChatCommand('nhold', function(param)
		if not param:match('(%d+)') then SCM('Используйте команду /nhold [ид игрока]') else sampSendChat('/hold '..param) end
	end) 
	sampRegisterChatCommand('nfollow', function() 
		sampSendChat('/follow')
	end)
	sampRegisterChatCommand('ncuff', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /ncuff [ид игрока]') else sampSendChat('/cuff '..param) end 
	end)
	sampRegisterChatCommand('nuncuff', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /nuncuff [ид игрока]') else sampSendChat('/uncuff '..param) end 
	end)
	sampRegisterChatCommand('nputpl', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /nputpl [ид игрока]') else sampSendChat('/putpl '..param) end 
	end)
	sampRegisterChatCommand('narrest', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /narrest [ид игрока]') else sampSendChat('/arrest '..param) end 
	end)
	sampRegisterChatCommand('nsearch', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /nsearch [ид игрока]') else sampSendChat('/search '..param) end 
	end)
	sampRegisterChatCommand('nskip', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /nskip [ид игрока]') else sampSendChat('/skip '..param) end 
	end)
	sampRegisterChatCommand('ninvite', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /ninvite [ид игрока]') else sampSendChat('/invite '..param) end 
	end)
	sampRegisterChatCommand('nuninvite', function(param) 
		if not param:match('(%d+) (%S+)') then SCM('Используйте команду /nuninvite [ид игрока] [причина]') else sampSendChat('/uninvite '..param) end 
	end)
	sampRegisterChatCommand('nsu', function(param) 
		if not param:match('(%d+) (%d+) (%S+)') then SCM('Используйте команду /nsu [ид игрока] [кол-во звёзд] [причина]') else sampSendChat('/su '..param) end 
	end)
	sampRegisterChatCommand('nticket', function(param) 
		if not param:match('(%d+) (%d+) (%S+)') then SCM('Используйте команду /nticket [ид игрока] [сумма] [причина]') else sampSendChat('/ticket '..param) 	end 
	end)
	sampRegisterChatCommand('ntakelic', function(param) 
		if not param:match('(%d+) (%S+)') then SCM('Используйте команду /ntakelic [ид игрока] [причина]') else sampSendChat('/takelic '..param) end 
	end)
	sampRegisterChatCommand('nclear', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /nclear [ид игрока]') else sampSendChat('/clear '..param) end 
	end)
	sampRegisterChatCommand('nrang', function(param) 
		if not param:match('(%d+) [+?-]') then SCM('Используйте команду /nrang [ид игрока] [+ / -]') else sampSendChat('/rang '..param) end 
	end)
	sampRegisterChatCommand('nchangeskin', function(param) 
		if not param:match('(%d+)') then SCM('Используйте команду /nchangeskin [ид игрока]') else sampSendChat('/changeskin '..param) end 
	end)
	sampRegisterChatCommand('ainfo', function()
		show_info.v = not show_info.v
	end)
	sampRegisterChatCommand('mh', function()
		show_menu.v = not show_menu.v
	end)
	sampRegisterChatCommand('strobes', function()
		if isCharInAnyCar(PLAYER_PED) and ini.set.strobes  then
			local car = storeCarCharIsInNoSave(PLAYER_PED)
			local driverPed = getDriverOfCar(car)

			if PLAYER_PED == driverPed then
				local state = not isCarSirenOn(car)
				switchCarSiren(car, state)
			end
		end
	end)
	lua_thread.create(strobe)
	lua_thread.create(rpweapon)
	lua_thread.create(show_flymode)
	
	apply_custom_style()
	register_custom_hotkey()
	add_new_hotkey()
	
	local sX, sY = getScreenResolution()
	clock_textdraw = mad.textdraw.new('', sX - 70, sY - 40)
	clock_textdraw.style = mad.font_style.PRICEDOWN
	clock_textdraw.width = 0.75
	clock_textdraw.height = 1.5
	clock_textdraw.outline = 0
	clock_textdraw.shadow = 1
	clock_textdraw.wrap = 175
	clock_textdraw:set_text_color(245, 245, 245, 250)
	clock_textdraw:set_shadow_color(30, 30, 30, 250)
	
	while true do
		wait(0)
		
		if ini.set.halfrpweapon and ini.set.rpweapon then
			if wasKeyPressed(KEY.VK_RBUTTON) and lweap ~= getCurrentCharWeapon(PLAYER_PED) then
				if not isSampfuncsConsoleActive() and not sampIsChatInputActive() and not sampIsDialogActive() then
					if getCurrentCharWeapon(PLAYER_PED) ~= 0 then
						lua_thread.create(function()
							local result, rp = sampWeaponScene(getCurrentCharWeapon(PLAYER_PED))
							if result then
								wait(350)
								lweap = getCurrentCharWeapon(PLAYER_PED)
								sampSendChat(string.format('/me %s', rp))
								
								while lweap == getCurrentCharWeapon(PLAYER_PED) do wait(0) end
								
								wait(800)
								
								if (lweap ~= getCurrentCharWeapon(PLAYER_PED)) then
									local aresult, arp = sampWeaponSceneOff(lweap)
									if aresult then
										sampSendChat(string.format('/me %s', arp))
										lweap = -1
									end
								end
							end
						end)
					end
				end
			end
			
			if wasKeyPressed(KEY.VK_R) and isKeyDown(VK_MENU) and lweap ~= getCurrentCharWeapon(PLAYER_PED) then
				if not isSampfuncsConsoleActive() and not sampIsChatInputActive() and not sampIsDialogActive() then
					if getCurrentCharWeapon(PLAYER_PED) ~= 0 then
						lua_thread.create(function()
							local result, rp = sampWeaponScene(getCurrentCharWeapon(PLAYER_PED))
							if result then
								wait(350)
								lweap = getCurrentCharWeapon(PLAYER_PED)
								sampSendChat(string.format('/me %s', rp))
								
								while lweap == getCurrentCharWeapon(PLAYER_PED) do wait(0) end
								
								wait(800)
								
								if (lweap ~= getCurrentCharWeapon(PLAYER_PED)) then
									local aresult, arp = sampWeaponSceneOff(lweap)
									if aresult then
										sampSendChat(string.format('/me %s', arp))
										lweap = -1
									end
								end
							end
						end)
					end
				end
			end
		end
		
		if wasKeyPressed(KEY.VK_OEM_6) then
			if isKeyCheckAvailable() then
				sampSetChatInputEnabled(true)
			else
				lua_thread.create(function()
					local timer = os.clock()
				
					while isKeyDown(VK_OEM_6) do
						wait(0)
						
						if os.clock() - timer >= 0.3 then
							sampSetChatInputEnabled(false)
						end
					end
				end)
			end
		end
		
		if show_menu.v or piemenu.v or show_info.v or show_suspect.v or show_uk_list.v then
			imgui.Process = true
		else
			imgui.Process = false
		end
		
		if ini.set.streetlight then
			local hour = getTimeOfDay() 
			if hour >= ini.set.slhour or hour <= ini.set.mslhour then 
				local x, y, z = getCharCoordinates(PLAYER_PED)
				for _, object in ipairs(mad.get_all_objects(x, y, z, 300)) do
					local model = getObjectModel(object)
					if model == 1226 and getObjectHealth(object) > 0 then
						local matrix = mad.get_object_matrix(object)
						if matrix then
							local objx, objy, objz = matrix:get_coords_with_offset(-1.3, 0.165, 3.69)
							local ground_z = getGroundZFor3dCoord(objx, objy, objz)
							mad.draw_spotlight(objx, objy, objz, objx, objy, ground_z, 0.065, 27)
						end
					end
				end
			end
		end
		
		if successful_login and sampGetCurrentServerName() ~= 'SA-MP' then
			local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
			local name = sampGetPlayerNickname(id)
			local text = string.format('-\n%s\n(id %d ~ rang %d) %s successfully logged in as a user.\n-', u8(sampGetCurrentServerName()), id, player_status, name)
			tovk(text, true)
			successful_login = false
		end
		
		if isCharInAnyCar(PLAYER_PED) and ini.set.strobes then

			local car = storeCarCharIsInNoSave(PLAYER_PED)
			local driverPed = getDriverOfCar(car)

			if isKeyDown(VK_LMENU) and isKeyCheckAvailable() and driverPed == PLAYER_PED then
				local state = true

				for i = 1, 10 do
					wait(100)
					if not isKeyDown(VK_LMENU) then state = false end
				end

				if isKeyDown(VK_LMENU) and state then

					local state = not isCarSirenOn(car)
					switchCarSiren(car, state)

					while isKeyDown(VK_LMENU) do wait(0) end

				end

			end

		end
		
		if flymode and not sampIsChatInputActive() and not isSampfuncsConsoleActive() then
			for key = 49, 58 do
				if wasKeyPressed(key) and isKeyCheckAvailable() then
					if static_camera[key - 48] ~= nil then
						local t = static_camera[key - 48]
						posX, posY, posZ, poiX, poiY, poiZ, angZ = t.posX, t.posY, t.posZ, t.poiX, t.poiY, t.poiZ, t.angZ
						setFixedCameraPosition(t.posX, t.posY, t.posZ, 0.0, 0.0, 0.0)
						pointCameraAtPoint(t.poiX, t.poiY, t.poiZ, 2)
						setCharHeading(playerPed, t.angZ)
					end
				end
			end
			
			offMouX, offMouY = getPcMouseMovement()
			  
			offMouX = offMouX / 4.0
			offMouY = offMouY / 4.0
			angZ = angZ + offMouX
			angY = angY + offMouY

			if angZ > 360.0 then angZ = angZ - 360.0 end
			if angZ < 0.0 then angZ = angZ + 360.0 end

			if angY > 89.0 then angY = 89.0 end
			if angY < -89.0 then angY = -89.0 end   

			curZ = angZ + 180.0
			curY = angY * -1.0      
			radZ = math.rad(curZ) 
			radY = math.rad(curY)                   
			sinZ = math.sin(radZ)
			cosZ = math.cos(radZ)      
			sinY = math.sin(radY)
			cosY = math.cos(radY)       
			sinZ = sinZ * cosY      
			cosZ = cosZ * cosY 
			sinZ = sinZ * 10.0     
			cosZ = cosZ * 10.0       
			sinY = sinY * 10.0                       
			posPlX = posX + sinZ 
			posPlY = posY + cosZ 
			posPlZ = posZ + sinY              
			angPlZ = angZ * -1.0

			if isKeyDown(VK_W) then      
				radZ = math.rad(angZ) 
				radY = math.rad(angY)                   
				sinZ = math.sin(radZ)
				cosZ = math.cos(radZ)      
				sinY = math.sin(radY)
				cosY = math.cos(radY)       
				sinZ = sinZ * cosY      
				cosZ = cosZ * cosY 
				sinZ = sinZ * speed      
				cosZ = cosZ * speed       
				sinY = sinY * speed  
				posX = posX + sinZ 
				posY = posY + cosZ 
				posZ = posZ + sinY      
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)      
			end 

			if isKeyDown(VK_S) then  
				curZ = angZ + 180.0
				curY = angY * -1.0      
				radZ = math.rad(curZ) 
				radY = math.rad(curY)                   
				sinZ = math.sin(radZ)
				cosZ = math.cos(radZ)      
				sinY = math.sin(radY)
				cosY = math.cos(radY)       
				sinZ = sinZ * cosY      
				cosZ = cosZ * cosY 
				sinZ = sinZ * speed      
				cosZ = cosZ * speed       
				sinY = sinY * speed                       
				posX = posX + sinZ 
				posY = posY + cosZ 
				posZ = posZ + sinY      
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end 
			  
			if isKeyDown(VK_A) then  
				curZ = angZ - 90.0
				radZ = math.rad(curZ)
				radY = math.rad(angY)
				sinZ = math.sin(radZ)
				cosZ = math.cos(radZ)
				sinZ = sinZ * speed
				cosZ = cosZ * speed
				posX = posX + sinZ
				posY = posY + cosZ
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end       

			if isKeyDown(VK_D) then  
				curZ = angZ + 90.0
				radZ = math.rad(curZ)
				radY = math.rad(angY)
				sinZ = math.sin(radZ)
				cosZ = math.cos(radZ)       
				sinZ = sinZ * speed
				cosZ = cosZ * speed
				posX = posX + sinZ
				posY = posY + cosZ      
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end 
			
			if isKeyDown(VK_SPACE) then  
				posZ = posZ + speed
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end 

			if isKeyDown(VK_SHIFT) then  
				posZ = posZ - speed
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end
			
			radZ = math.rad(angZ) 
			radY = math.rad(angY)             
			sinZ = math.sin(radZ)
			cosZ = math.cos(radZ)      
			sinY = math.sin(radY)
			cosY = math.cos(radY)       
			sinZ = sinZ * cosY      
			cosZ = cosZ * cosY 
			sinZ = sinZ * 1.0      
			cosZ = cosZ * 1.0     
			sinY = sinY * 1.0
			if targetSet == nil then
				poiX = posX
				poiY = posY
				poiZ = posZ   
				poiX = poiX + sinZ 
				poiY = poiY + cosZ 
				poiZ = poiZ + sinY
			else
				local result, ped = sampGetCharHandleBySampPlayerId(targetSet)
				
				if result then
					poiX, poiY, poiZ = getCharCoordinates(ped)
				else
					targetSet = nil
				end
			end
			
			pointCameraAtPoint(poiX, poiY, poiZ, 2)

			if isKeyDown(187) then 
				speed = speed + 0.0005
			end 
			               
			if isKeyDown(189) then 
				speed = speed - 0.0005
				if speed < 0.001 then speed = 0.001 end
			end   
		end
		
		if edit_obj ~= nil and not sampIsChatInputActive() and not sampIsDialogActive() and text_id == nil then
			-- вращение
			if isKeyDown(VK_NUMPAD8) and isKeyDown(VK_CONTROL) then
				obj_qx = obj_qx + obj_srotate
				setObjectRotation(edit_obj, obj_qx, obj_qy, obj_qz)
			elseif isKeyDown(VK_NUMPAD2) and isKeyDown(VK_CONTROL) then
				obj_qx = obj_qx - obj_srotate
				setObjectRotation(edit_obj, obj_qx, obj_qy, obj_qz)
			elseif isKeyDown(VK_NUMPAD4) and isKeyDown(VK_CONTROL) then
				obj_qy = obj_qy + obj_srotate
				setObjectRotation(edit_obj, obj_qx, obj_qy, obj_qz)
			elseif isKeyDown(VK_NUMPAD6) and isKeyDown(VK_CONTROL) then
				obj_qy = obj_qy - obj_srotate
				setObjectRotation(edit_obj, obj_qx, obj_qy, obj_qz)
			elseif isKeyDown(VK_NUMPAD7) and isKeyDown(VK_CONTROL) then
				obj_qz = obj_qz + obj_srotate
				setObjectRotation(edit_obj, obj_qx, obj_qy, obj_qz)
			elseif isKeyDown(VK_NUMPAD9) and isKeyDown(VK_CONTROL) then
				obj_qz = obj_qz - obj_srotate
				setObjectRotation(edit_obj, obj_qx, obj_qy, obj_qz)
			-- движение (в стороны)
			elseif isKeyDown(VK_NUMPAD8) then
				obj_y = obj_y + obj_smove
				setObjectCoordinates(edit_obj, obj_x, obj_y, obj_z)
			elseif isKeyDown(VK_NUMPAD2) then
				obj_y = obj_y - obj_smove
				setObjectCoordinates(edit_obj, obj_x, obj_y, obj_z)
			elseif isKeyDown(VK_NUMPAD4) then
				obj_x = obj_x - obj_smove
				setObjectCoordinates(edit_obj, obj_x, obj_y, obj_z)
			elseif isKeyDown(VK_NUMPAD6) then
				obj_x = obj_x + obj_smove
				setObjectCoordinates(edit_obj, obj_x, obj_y, obj_z)
			-- движение (верх вниз)
			elseif isKeyDown(VK_SPACE) then
				obj_z = obj_z + obj_smove
				setObjectCoordinates(edit_obj, obj_x, obj_y, obj_z)
			elseif isKeyDown(VK_MENU) then
				obj_z = obj_z - obj_smove
				setObjectCoordinates(edit_obj, obj_x, obj_y, obj_z)
			-- сохранение
			elseif isKeyDown(VK_RETURN) then
				SCM('Вы закончили редактирование объекта с хендлом {FFCD00}' .. edit_obj .. '{ffffff}.')
				edit_obj = nil
			end
		end
		
		if text_id ~= nil and not sampIsChatInputActive() and not sampIsDialogActive() and edit_obj == nil then
			-- движение
			if isKeyDown(VK_NUMPAD8) then
				text_y = text_y + 0.04
				sampCreate3dTextEx(text_id, text_text, text_color, text_x, text_y, text_z, text_distance, false, -1, -1)
			elseif isKeyDown(VK_NUMPAD2) then
				text_y = text_y - 0.04
				sampCreate3dTextEx(text_id, text_text, text_color, text_x, text_y, text_z, text_distance, false, -1, -1)
			elseif isKeyDown(VK_NUMPAD4) then
				text_x = text_x - 0.04
				sampCreate3dTextEx(text_id, text_text, text_color, text_x, text_y, text_z, text_distance, false, -1, -1)
			elseif isKeyDown(VK_NUMPAD6) then
				text_x = text_x + 0.04
				sampCreate3dTextEx(text_id, text_text, text_color, text_x, text_y, text_z, text_distance, false, -1, -1)
			elseif isKeyDown(VK_SPACE) then
				text_z = text_z + 0.04
				sampCreate3dTextEx(text_id, text_text, text_color, text_x, text_y, text_z, text_distance, false, -1, -1)
			elseif isKeyDown(VK_MENU) then
				text_z = text_z - 0.04
				sampCreate3dTextEx(text_id, text_text, text_color, text_x, text_y, text_z, text_distance, false, -1, -1)
			-- сохранение
			elseif isKeyDown(VK_RETURN) then
				SCM('Вы закончили редактирование 3D текста с ID {FFCD00}' .. text_id .. '{ffffff}.')
				text_id = nil
			end 
		end
	end
end

function command_r(text)
	local cmd, ucmd = string.match(ini.cmd.r, '(.+) | (.+)')

	if not string.match(text, '(.+)') then SCM(string.format('Используйте команду /%s [текст].', cmd))
	else
		local mark = sampGetMarkCharByVehicle(PLAYER_PED)
		text = string.gsub(text, 'cod 11', '$m to DISP, занимаю маркировку $m, CODE: 1-1, RFR, over **')
		text = string.gsub(text, 'cod 13', '$m to DISP, освобождаю маркировку $m, CODE: 1-3, nRFR, over **')
		text = string.gsub(text, 'cod 14', '$m to DISP, доставляю подозреваемого в департамент, CODE: 1-4, nRFR, over **')
		text = string.gsub(text, 'tf 55', '$m to DISP, Провожу 10-55, CODE: 4, 10-20 $p, nRFR, over **')
		text = string.gsub(text, 'tf 66', '$m to DISP, Провожу 10-66, CODE: 3, 10-20 $p, nRFR, over **')
		text = string.gsub(text, 'tf 9957v', '$m to DISP, 10-99 по 10-57 V, RFR, over **')
		text = string.gsub(text, 'tf 9957f', '$m to DISP, 10-99 по 10-57 F, RFR, over **')
		text = string.gsub(text, 'tf 995', '$m to DISP, 10-99 по 10-55, RFR, over **')
		text = string.gsub(text, 'tf 996', '$m to DISP, 10-99 по 10-66, RFR, over **')
		text = string.gsub(text, 'cod 0', '$m to DISP, CODE: 0, требуется срочная помощь!, 10-20 $p, nRFR, over **')
		text = string.gsub(text, 'cod 1', '$m to DISP, CODE: 1, требуется помощь!, 10-20 $p, nRFR, over **')
		text = string.gsub(text, '%$m', mark)
		text = string.gsub(text, '%$p', string.format('%s (%s)', calculateZone(), kvadrat()))
		
		if string.len(text) > 77 then
			sampSendChat(string.format('/%s %s %s ...', ucmd, ini.info.rteg, string.sub(text, 0, 77)))
			sampSendChat(string.format('/%s ... %s', ucmd, string.sub(text, 78, string.len(text))))
		else
			sampSendChat(string.format('/%s %s %s', ucmd, ini.info.rteg, text))
		end
		
		if ini.lowrp.rpradio and ini.set.lowrp then
			lua_thread.create(function()
				wait(800)
			
				if ini.info.male then
					sampSendChat('/me снял тангету с плеча, зажал кнопку PTT и что-то произнёс по рации')
				else
					sampSendChat('/me сняла тангету с плеча, зажала кнопку PTT и что-то произнесла по рации')
				end
			end)
		end
	end
end

function command_rn(text) 
	local cmd = string.match(ini.cmd.rn, '(.+) | (.+)')
	local _, ucmd = string.match(ini.cmd.r, '(.+) | (.+)')
	
	if not string.match(text, '(.+)') then SCM(string.format('Используйте команду /%s [текст].', cmd)) else sampSendChat(string.format('/%s (( %s ))', ucmd, text)) end
end

function command_f(text)
	local cmd, ucmd = string.match(ini.cmd.f, '(.+) | (.+)')

	if not string.match(text, '(.+)') then 
		SCM(string.format('Используйте команду /%s [текст].', cmd))
	else 
		sampSendChat(string.format('/%s %s %s', ucmd, ini.info.fteg, text))
		
		if ini.lowrp.rpradio then
		
			lua_thread.create(function()
				wait(800)
			
				if ini.info.male then
					sampSendChat('/me снял тангету с плеча, зажал кнопку PTT и что-то произнёс по рации')
				else
					sampSendChat('/me снял тангету с плеча, зажала кнопку PTT и что-то произнесла по рации')
				end
			end)
		end
	end
end

function command_fn(text)
	local cmd = string.match(ini.cmd.fn, '(.+) | (.+)')
	local _, ucmd = string.match(ini.cmd.f, '(.+) | (.+)')
	
	if not string.match(text, '(.+)') then SCM(string.format('Используйте команду /%s [текст].', cmd)) else sampSendChat(string.format('/%s (( %s ))', ucmd, text)) end
end

function command_radiotag()
	local text = ''
	text = string.format('%s\n{FFCD00}cod 11\t\t{ffffff}$m to DISP, занимаю маркировку $m, CODE: 1-1, RFR, over **', text)
	text = string.format('%s\n{FFCD00}cod 13\t\t{ffffff}$m to DISP, освобождаю маркировку $m, CODE: 1-3, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}cod 14\t\t{ffffff}$m to DISP, доставляю подозреваемого в департамент, CODE: 1-4, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 55\t\t{ffffff}$m to DISP, Провожу 10-55, CODE: 4, 10-20 $p, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 66\t\t{ffffff}$m to DISP, Провожу 10-66, CODE: 3, 10-20 $p, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 9957v\t\t{ffffff}$m to DISP, 10-99 по 10-57 V, RFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 9957f\t\t{ffffff}$m to DISP, 10-99 по 10-57 F, RFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 995\t\t{ffffff}$m to DISP, 10-99 по 10-55, RFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 996\t\t{ffffff}$m to DISP, 10-99 по 10-66, RFR, over **', text)
	text = string.format('%s\n{FFCD00}cod 0\t\t{ffffff}$m to DISP, CODE: 0, требуется срочная помощь!, 10-20 $p, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}cod 1\t\t{ffffff}$m to DISP, CODE: 1, требуется помощь!, 10-20 $p, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}$m\t\t{ffffff}Маркировка автомобиля', text)
	text = string.format('%s\n{FFCD00}$p\t\t{ffffff}Местоположение (Район / Квадрат)', text)
	
	sampShowDialog(1005, '{FFCD00}Список радио-тэгов для рации', text, 'Закрыть', '', 2)
end

function command_account(parametrs)
	local cmd, ucmd = string.match(ini.cmd.account, '(.+) | (.+)')

	if string.match(parametrs, '(%S+) (%d+) (%S+)') then
		local name, id, passw = string.match(parametrs, '(%S+) (%d+) (%S+)')
		if string.len(passw) >= 6 and string.len(passw) <= 15 then
			local id = tonumber(id)
			if id >= 1 and id <= 9 then
				local serv = {'red', 'green', 'yellow', 'orange', 'blue', 'white', 'silver', 'purple', 'chocolate'}
				SCM(string.format('Вы добавили аккаунт {FFCD00}%s{ffffff} с паролем {FFCD00}%s{ffffff} на сервере %s.', name, string.gsub(passw, '.', '•'), serv[id]))
				pass[serv[id]][name] = passw
				inicfg.save(pass, 'password.ini')
			else
				SCM('Номер сервера не должен быть менее 1 и более 9.')
			end
		else
			SCM('Длина пароля не должна быть менее 6 и более 15 символов.')
		end
	else
		SCM(string.format('Используйте команду /%s [никнейм] [номер сервера] [пароль].', cmd))
	end
end

function command_cobject(id)
	local cmd = string.match(ini.cmd.add_obj, '(.+) | (.+)')
	
	if string.match(id, '(%d+) (.+) (.+)') then
		id, smove, srotate = string.match(id, '(%d+) (.+) (.+)')
		x, y, z = getCharCoordinates(PLAYER_PED)
		object = createObject(id, x, y, z)
		if doesObjectExist(object) and edit_obj == nil then
			setObjectCollision(object, false)
			SCM('Был создан объект {FFCD00}' .. id .. '{ffffff} с хендлом {FFCD00}' .. object .. '{ffffff}.')
			SCM('Для редактирование объекта используйте стрелки на NumPad, Space (поднять), Alt (опустить), Ctrl + стрелки NumPad (вращение).')
			SCM('Чтобы сохранить нажмите {FFCD00}ENTER{ffffff}, для удаления используйте команду /del_obj [хендл объекта].')
			obj_x = x; obj_y = y; obj_z = z
			obj_qx = 0; obj_qy = 0; obj_qz = 0 
			edit_obj = object
			obj_smove = tonumber(smove); obj_srotate = tonumber(srotate)
		else
			SCM('Произошла ошибка при создании объекта.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид объекта] [шаг движения (рек. 0.04)] [шаг врашения (рек. 1.0)].', cmd))
	end
end

function command_eobject(id)
	local cmd = string.match(ini.cmd.edit_obj, '(.+) | (.+)')

	if string.match(id, '(%d+) (.+) (.+)') then
		id, smove, srotate = string.match(id, '(%d+) (.+) (.+)')
		if doesObjectExist(id) and edit_obj == nil then
			SCM('Вы начали редактировать объект с хендлом {FFCD00}' .. id .. '{ffffff}.')
			SCM('Для редактирование объекта используйте стрелки на NumPad, Space (поднять), Alt (опустить), Ctrl + NumPad (вращение).')
			SCM('Чтобы сохранить нажмите {FFCD00}ENTER{ffffff}, для удаления используйте команду /del_obj [хендл объекта].')
			_, obj_x, obj_y, obj_z = getObjectCoordinates(id)
			obj_qx = 0; obj_qy = 0; obj_qz = 0 
			edit_obj = id
			obj_smove = tonumber(smove); obj_srotate = tonumber(srotate)
		else
			SCM('Произошла ошибка при начале редактирования объекта.')
		end
	else
		SCM(string.format('Используйте команду /%s [хендл объекта] [шаг движения] [шаг врашения].', cmd))
	end
end

function command_dobject(id)
	local cmd = string.match(ini.cmd.del_obj, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if doesObjectExist(id) and edit_obj == nil then
			deleteObject(id)
			SCM('Вы успешно удалили объект с хендлом {FFCD00}' .. id .. '{ffffff}.')
		else
			SCM('Произошла ошибка при удалении объекта.')
		end
	else
		SCM(string.format('Используйте команду /%s [хендл объекта].', cmd))
	end
end

function command_ctext(param)
	local cmd = string.match(ini.cmd.add_text, '(.+) | (.+)')

	if string.match(param, '(%S+) (%d+) (.+)') then
		local text, distance, color = string.match(param, '(.+) (%d+) (.+)')
		x, y, z = getCharCoordinates(PLAYER_PED)
		id = sampCreate3dText(text, color, x, y, z, distance, false, -1, -1)
		if sampIs3dTextDefined(id) and text_id == nil then
			SCM('Был создан 3D текст с ID {FFCD00}' ..id .. '{ffffff}.')
			SCM('Для редактирование 3D текста используйте стрелки на NumPad, Space (поднять), Alt (опустить).')
			SCM('Чтобы сохранить нажмите {FFCD00}ENTER{ffffff}, для удаления используйте команду /del_text [ид 3D текста].')
			text_x = x; text_y = y; text_z = z; text_distance = distance; text_color = color; text_text = text
			text_id = id
		else
			SCM('Произошла ошибка при создании 3D текста.')
		end
	else
		SCM(string.format('Используйте команду /%s [текст] [дистанция] [цвет].', cmd))
	end
end

function command_etext(id)
	local cmd = string.match(ini.cmd.edit_text, '(.+) | (.+)')
	
	if string.match(id, '(%d+)') then
		if sampIs3dTextDefined(id) and text_id == nil then
			SCM('Вы начали редактировать #d текст с ID {FFCD00}' .. id .. '{ffffff}.')
			SCM('Для редактирование 3D текста используйте стрелки на NumPad, Space (поднять), Alt (опустить).')
			SCM('Чтобы сохранить нажмите {FFCD00}ENTER{ffffff}, для удаления используйте команду /del_text [ид 3D текста].')
			text, color, x, y, z, distance, _1, _2, _3 = sampGet3dTextInfoById(id)
			text_x = x; text_y = y; text_z = z; text_distance = distance; text_color = color; text_text = text
			text_id = id
		else
			SCM('Произошла ошибка при создании 3D текста.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид 3D текста].', cmd))
	end
end

function command_dtext(id)
	local cmd = string.match(ini.cmd.del_text, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if sampIs3dTextDefined(id) and text_id == nil then
			sampDestroy3dText(id)
			SCM('Вы успешно удалили 3D текст с ID {FFCD00}' .. id .. '{ffffff}.')
		else
			SCM('Произошла ошибка при удалении 3D текста.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид 3D текста].', cmd))
	end
end

function command_reconnect(parametrs)
	local cmd, ucmd = string.match(ini.cmd.rec, '(.+) | (.+)')

	if string.match(parametrs, '(%d+)') then
		local delay = tonumber(parametrs)
		if delay > 0 and delay <= 60 then
			reconnect(delay)
		else
			SCM('Задержка между переподключениями не должна быть менее 0 и более 60 секунд.')
		end
	else
		SCM(string.format('Используйте команду /%s [задержка].', cmd))
	end
end

function command_reconnectwithchange(parametrs)
	local cmd, ucmd = string.match(ini.cmd.recn, '(.+) | (.+)')

	if string.match(parametrs, '(%d+) (%S+)') then
		local delay, name = string.match(parametrs, '(%d+) (.+)')
		local delay = tonumber(delay)
		if delay > 0 and delay <= 60 then
			sampSetLocalPlayerName(name)
			reconnect(delay)
		else
			SCM('Задержка между переподключениями не должна быть менее 0 и более 60 секунд.')
		end
	else
		SCM(string.format('Используйте команду /%s [задержка] [никнейм].', cmd))
	end
end

function command_reconnectwithchangeip(parametrs)
	local cmd, ucmd = string.match(ini.cmd.recd, '(.+) | (.+)')

	if string.match(parametrs, '(%d+) (%S+)') then
		local id, name = string.match(parametrs, '(%d+) (.+)')
		local id = tonumber(id)
		if id >= 1 and id <= 9 then
			sampSetLocalPlayerName(name)
			reconnect(1, string.format('5.254.104.13%d:7777', id))
		else
			SCM('Номер сервера не должен быть менее 1 и более 9.')
		end
	elseif string.match(parametrs, '(%d+)') then
		local id = tonumber(parametrs)
		if id >= 1 and id <= 9 then
			reconnect(1, string.format('5.254.104.13%d:7777', id))
		else
			SCM('Номер сервера не должен быть менее 1 и более 9.')
		end
	else
		SCM(string.format('Используйте команду /%s [номер сервера] [никнейм (необязательно)]', cmd))
	end
end

function reconnect(delay, ip)
	if type(delay) == ('number') and ip == nil then
		lua_thread.create(function()
			local wdelay = delay * 1000
			printStyledString(string.format('~w~reconnect with ~p~ %d ~w~ seconds delay', delay), wdelay, 4)
			sampDisconnectWithReason(1)
			wait(wdelay)
			sampSetGamestate(1)
		end)
	elseif type(delay) == ('number') and type(ip) == ('string') then
		lua_thread.create(function()
			if string.match(ip, '(%S+):(%d+)') then
				local ipadress, port = string.match(ip, '(.+):(%d+)')
				local port = tonumber(port)
				local wdelay = delay * 1000
				printStyledString(string.format('~w~reconnect with ~p~ %d ~w~ seconds delay', delay), wdelay, 4)
				sampConnectToServer(ipadress, port)
			end
		end)
	end
end

function command_rkinfo()
	if dreason[1] ~= nil then
		local timed = getTimeByPeriod(tonumber(dreason[2]), tonumber(dreason[3]), tonumber(dreason[4]), ini.set.delay_rk)
		SCM(string.format('Вы можете вернутся в район %s в %d ч. %d мин. %d сек.', dreason[1], timed[1], timed[2], timed[3]))
		if sampGetPassedTimeByPeriod(tonumber(dreason[2]), tonumber(dreason[3]), tonumber(dreason[4]), ini.set.delay_rk) then
			SCM(string.format('Время вышло и вы уже {00cc99}можете{ffffff} вернутся в район %s.', dreason[1]))
		else
			SCM(string.format('В данный момент Вы {ff5c33}не можете{ffffff} вернутся в район %s.', dreason[1]))
			if tostring(calculateZone()) == tostring(dreason[1]) then
				SCM(string.format(' {ff5c33}[ПРЕДУПРЕЖДЕНИЕ] {ffffff}Вы находитесь в запрещённом для Вас районе %s.', dreason[1]))
			end
		end
	else
		SCM('Вы не умирали.')
	end
end

function command_apay(param)
	local cmd, ucmd = string.match(ini.cmd.pay, '(.+) | (.+)')

	if string.match(param, '(%d+) (%d+)') then
		local id, money = string.match(param, '(%d+) (%d+)')
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 3 then
				if tonumber(money) < 200000 then
					lua_thread.create(function()
						while sampGetDistance(PLAYER_PED, id) < 3 do
							if (tonumber(money) - 5000) <= 0 then
								sampSendChat(string.format('/pay %d %d', id, money))
								break
							else
								sampSendChat(string.format('/pay %d 5000', id, money))
								money = tonumber(money) - 5000
							end
							wait(3500)
						end
					end)
				else
					SCM('Невозможно передать более 200.000$.')
				end
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока] [сумма]', cmd))
	end
end

function command_easyevent(param)
	if string.match(param, '(%d+) (%d+)') then
		local id, money = string.match(param, '(%d+) (%d+)')
		if IPC(id) then
			SCM(string.format('%s слишком далеко, передача произойдёт сразу же, как будет возможность.', sampGetPlayerNickname(id)))
			lua_thread.create(function()
				while sampGetDistance(PLAYER_PED, id) > 2 do 
					wait(0)

					if not IPC(id) then
						break
					end
				end
				sampSendChat(string.format('/pay %d %d', id, money))
			end)
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM('Используйте команду /eevent [ид игрока] [сумма]')
	end
end

function table_to_text(tab)
	for i, val in pairs(tab) do
		imgui.TextColoredRGB(val)
	end
end

function command_report(text)
	local cmd, ucmd = string.match(ini.cmd.rep, '(.+) | (.+)')

	if not string.match(text, '(.+)') then
		SCM(string.format('Используйте команду /%s [текст].', cmd))
	else
		report = text
		act = true
		sampSendChat('/mn')
	end
end

function command_sms(value)
	local cmd, ucmd = string.match(ini.cmd.sms, '(.+) | (.+)')

	if string.match(value, '(%d+) (%S+)') then 
		local number, text = string.match(value, '(%d+) (.+)')
		local found = false
		
		if IPC(number) then
			local name = sampGetPlayerNickname(number)
			if ini.number[name] ~= nil then
				number = ini.number[name]
			else
				SCM('Номер не найден в базе данных.')
				found = true
			end
		end
		
		if not found then
			if string.len(text) > 60 then
				sampSendChat(string.format('/%s %d %s ..', ucmd, number, string.sub(text, 0, 60)))
				sampSendChat(string.format('/%s %d .. %s', ucmd, number, string.sub(text, 61, string.len(text))))
			else
				sampSendChat(string.format('/%s %d %s', ucmd, number, string.sub(text, 0, 60)))
			end
		end
	else
		SCM(string.format('Используйте команду /%s [номер телефона] [сообщение]', cmd))
	end
end

function command_addbl(name)
	local cmd, ucmd = string.match(ini.cmd.addbl, '(.+) | (.+)')

	if string.match(name, '(%S+)') then
		local path = 'moonloader//helper//black-list.txt'
		
		local filew = io.open(path, 'a')
		filew:write(name)
		filew:close()
		
		SCM(string.format('Игрок {FFCD00}%s{ffffff} был добавлен в чёрный список.', name))
	else
		SCM(string.format('Используйте команду /%s [имя игрока]', cmd))
	end
end

function command_delbl(name)
	local cmd, ucmd = string.match(ini.cmd.delbl, '(.+) | (.+)')

	if string.match(name, '(%S+)') then
		local path = 'moonloader//helper//black-list.txt'
		
		local filer = io.open(path, 'r')
		local bl = filer:read('*a')
		filer:close()
		
		if bl:find(name) then
			local text = string.gsub(bl, name, '')
			local filew = io.open(path, 'w')
			filew:write(text)
			filew:close()
			
			SCM(string.format('Игрок {FFCD00}%s{ffffff} был удалён из чёрного списка.', name))
		else
			SCM('Данного игрока нет в чёрном списке.')
		end
	else
		SCM(string.format('Используйте команду /%s [имя игрока]', cmd))
	end
end

function command_asms(text)
	local cmd, ucmd = string.match(ini.cmd.sms, '(.+) | (.+)')

	if string.match(text, '(%S+)') then
		if last_sms ~= 0 then
			command_sms(string.format('/%s %d %s', ucmd, last_sms, text))
		else
			SCM('Ранее вам никто не отправлял SMS-сообщения.')
		end
	else
		SCM(string.format('Используйте команду /%s [текст].', cmd))
	end
end

function command_gov(id) 
	local cmd, ucmd = string.match(ini.cmd.gov, '(.+) | (.+)')

	if player_status > 0 then
		if string.match(id, '(%d+)') then
			if gnews[1] ~= nil then
				local timed = getTimeByPeriod(tonumber(gnews[1]), tonumber(gnews[2]), tonumber(gnews[3]), 5)
				if sampGetPassedTimeByPeriod(tonumber(gnews[1]), tonumber(gnews[2]), tonumber(gnews[3]), 5) then
					send_gnews(id)
				else
					SCM(string.format('В данный момент Вы {ff5c33}не можете{ffffff} отправить гос. новость.', gnews[1]))
				end
			else
				send_gnews(id)
			end
		else
			if gnews[1] ~= nil then
				local timed = getTimeByPeriod(tonumber(gnews[1]), tonumber(gnews[2]), tonumber(gnews[3]), 5)
				if sampGetPassedTimeByPeriod(tonumber(gnews[1]), tonumber(gnews[2]), tonumber(gnews[3]), 5) then
					SCM(string.format('Используйте команду /%s [ид новости]. Вы {00cc99}можете{ffffff} отправить гос. новость.', cmd))
				else
					SCM(string.format('Используйте команду /%s [ид новости]. Вы {ff5c33}не можете{ffffff} отправить гос. новость.', cmd))
					SCM(string.format('Вы сможете отправить гос. новость в %d ч. %d мин. %d сек.', timed[1], timed[2], timed[3]))
				end
			else
				SCM(string.format('Используйте команду /%s [ид новости]. Вы {00cc99}можете{ffffff} отправить гос. новость.', cmd))
			end
		end
	else
		SCM('Вы не можете использовать данную функцию, вы не лидер.')
	end
end

function send_gnews(id)
	if doesFileExist(string.format('moonloader//helper//gnews//news-%d.txt', id)) then
		local gtype = '0'
		lua_thread.create(function()
			for val in io.lines(string.format('moonloader//helper//gnews//news-%d.txt', id)) do
				if string.match(val, 'type=(%d+)') then
					gtype = string.match(val, 'type=(%d+)')
				elseif string.match(val, 'line(%d+)=(.+)') then
					local line, text = string.match(val, 'line(%d+)=(.+)')
					if tonumber(gtype) == 3 then
						if tonumber(line) <= 3 then
							if tonumber(line) == 1 then sampSendChat(string.format('/gnews %s', text)) end
							if tonumber(line) == 2 then sampSendChat(string.format('/gnews %s', text)) end
							if tonumber(line) == 3 then sampSendChat(string.format('/gnews %s', text)) end
							gnews = {os.date('%H'), os.date('%M'), os.date('%S'), 3}
						end
					elseif tonumber(gtype) == 1 then
						if tonumber(line) == 4 then sampSendChat(string.format('/gnews %s', text)) end
						gnews = {os.date('%H'), os.date('%M'), os.date('%S'), 1}
					end
					
					wait(1000)
				end
			end
		end)
	else
		SCM('Не найдено новости с данным ID.')
	end
end

function decode()
	local f = io.open(thisScript().path, 'r')
	local text = f:read('*a')
	f:close()
		
	local fw = io.open(thisScript().path, 'w')
	fw:write(u8:decode(text))
	fw:close()
end

function command_rights()
	lua_thread.create(function()
		sampSendChat('Вы имеете право хранить молчание. ')
		wait(1500)
		sampSendChat('Всё, что вы скажете, может и будет использовано против вас в суде. ')
		wait(1500)
		sampSendChat('Ваш адвокат может присутствовать при допросе. ')
		wait(1500)
		sampSendChat('Если вы не можете оплатить услуги адвоката, он будет предоставлен вам государством.')
		wait(1500)
		sampSendChat('Вы понимаете свои права?')
	end)
end

function command_setskin(param)
	local cmd, ucmd = string.match(ini.cmd.skin, '(.+) | (.+)')

	if player_status > 1 then
		if string.match(param, '(%d+) (%d+) (%d+)') then
			local id, skin, state = string.match(param, '(%d+) (%d+) (%d+)')
			if IPC(id) then
				if sampGetDistance(PLAYER_PED, id) < 200 then
					local BS = raknetNewBitStream()
					raknetBitStreamWriteInt32(BS, id)
					raknetBitStreamWriteInt32(BS, skin)
					raknetEmulRpcReceiveBitStream(153, BS)
					raknetDeleteBitStream(BS)
					
					local name = string.gsub(sampGetPlayerNickname(id),'_',' ')
					if tonumber(state) ~= 1 then SCM('Вы установили визуальный скин ({FFCD00}' .. skin .. '{ffffff}) для игрока ' .. name .. '[' .. id .. ']') end
				else
					SCM('Данный игрок находится слишком далеко от Вас.')
				end
			else
				SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			SCM(string.format('Используйте команду /%s [ид игрока] [ид скина] [0 или 1].', cmd))
		end
	end
end

function command_history(id)
	local cmd, ucmd = string.match(ini.cmd.history, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			sampSendChat(string.format('/%s %s', ucmd, sampGetPlayerNickname(id)))
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_setweather(id)
	local cmd, ucmd = string.match(ini.cmd.sw, '(.+) | (.+)')

	if string.match(id, '(%d+)') then 
		if tonumber(id) > 0 and tonumber(id) <= 45 then
			forceWeatherNow(id)
			SCM('Вы установили ID погоды {FFCD00}' .. id)
		else
			SCM('ID погоды не должен быть больше 45 и меньше 1.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид погоды].', cmd))
	end
end

function command_settime(param)
	local cmd, ucmd = string.match(ini.cmd.st, '(.+) | (.+)')

	if string.match(param, '(%d+) (%d+)') then
		local hour, min = string.match(param, '(%d+) (%d+)')
		if tonumber(hour) >= 0 and tonumber(hour) <= 23 and tonumber(min) >= 0 and tonumber(min) < 60 then
			patch_samp_time_set(true)
			setTimeOfDay(hour, min)
			SCM('Вы установили время {FFCD00}' .. hour .. '{ffffff} часов, {FFCD00}' .. min .. '{ffffff} минут')
		else
			SCM('Часы не должны быть больше 23 и меньше 0. Минуты не должны быть больше 59 и меньше 0.')
		end
	else
		SCM(string.format('Используйте команду /%s [часы] [минуты].', cmd))
	end
end

function command_ud()
	lua_thread.create(function()
		if ini.info.male then
			sampSendChat('/me достал удостоверение, открыл его и показал человеку напротив')
			wait(1500); sampSendChat('/do В удостоверение: ' .. ini.info.frac .. ', ' .. ini.info.rang .. ', ' .. ini.info.name .. '.')
			wait(1000); sampSendChat('/me закрыл удостоверение и убрал его обратно')

		else
			sampSendChat('/me достала удостоверение, открыла его и показала человеку напротив')
			wait(1500); sampSendChat('/do В удостоверение: ' .. ini.info.frac .. ', ' .. ini.info.rang .. ', ' .. ini.info.name .. '.')
			wait(1000); sampSendChat('/me закрыла удостоверение и убрала его обратно')
		end
	end)
end

function command_pas(id)
	local cmd, ucmd = string.match(ini.cmd.pas, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 5 then
				lua_thread.create(function()
					sampSendChat(sampGetHelloByTime() .. ', я ' .. ini.info.rang .. ' ' .. ini.info.name .. '.')
					wait(1000); sampSendChat('/do На груди висит значок с личным номером №000' .. ini.info.number .. '.')
					wait(1500); sampSendChat('Будьте любезны, предъявите документы, удостоверяющие вашу личность.')
					if ini.set.autopass then autopass = true end
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_search(id)
	local cmd, ucmd = string.match(ini.cmd.search, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 5 then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me из внутреннего кармана достал белые, латекстные перчатки и одел их на руки')
					else
						sampSendChat('/me из внутреннего кармана достала белые, латекстные перчатки и одела их на руки')
					end
					wait(1500); sampSendChat('/me осмотривает все карманы, возможные места хранение запрещённых веществ и предметов')
					wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
					idsearch = id
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function search_file(file, text, bool)
	if type(file) == ('string') and type(text) == ('string') then
		if doesFileExist(string.format('moonloader\\helper\\%s.txt', file)) then
			for line in io.lines(string.format('moonloader\\helper\\%s.txt', file)) do
				if line:find(text) then 
					for i = 0, string.len(line) / 115 do
						SCM(string.sub(line, i * 115, i * 115 + 114))
					end
					
					if not bool then break end
				end
			end
		end
	end
end

function command_ustav(text)
	local cmd, ucmd = string.match(ini.cmd.ustav, '(.+) | (.+)')

	if not string.match(text, '(.+)') then SCM(string.format('Используйте команду /%s [часть или номер статьи]', cmd))
	else
		search_file('ustav', text)
	end
end

function command_uk(text)
	local cmd, ucmd = string.match(ini.cmd.uk, '(.+) | (.+)')

	if not string.match(text, '(.+)') then show_uk_list.v = not show_uk_list.v
	else
		search_file('uk', text)
	end
end

function command_ak(text)
	local cmd, ucmd = string.match(ini.cmd.ak, '(.+) | (.+)')

	if not string.match(text, '(.+)') then SCM(string.format('Используйте команду /%s [часть или номер статьи]', cmd))
	else
		search_file('ak', text)
	end
end

function command_code(text)
	local cmd, ucmd = string.match(ini.cmd.kod, '(.+) | (.+)')

	if not string.match(text, '(.+)') then SCM(string.format('Используйте команду /%s [часть или номер кода]', cmd))
	else
		search_file('code', text)
	end
end

function command_pdd(text)
	if not string.match(text, '(.+)') then SCM('Используйте команду /пдд [часть или номер статьи]')
	else
		search_file('pdd', text)
	end
end

function command_hack(id)
	local cmd, ucmd = string.match(ini.cmd.hack, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		lua_thread.create(function()
			if ini.info.male then
				sampSendChat('/do На плечах висит рюкзак в котором лежит балончик с заморозкой.')
				wait(1500); sampSendChat('/me скинув рюкзак с плеч, открыл его и достал балончик')
				wait(1500); sampSendChat('/me закрыл рюкзак и повесил его на плечи')
				wait(1500); sampSendChat('/me встряхнув балончик, распылил содержимое на дверной замок')
				wait(1500); sampSendChat('/do Под действием содержимого балончика замок промёрз и стал хрупок.')
				wait(1500); sampSendChat('/me снял дубинку с поясного держателя и, размахнувшись, ударил тыльной частью по замку')
			else
				sampSendChat('/do На плечах висит рюкзак в котором лежит балончик с заморозкой.')
				wait(1500); sampSendChat('/me скинув рюкзак с плеч, открыла его и достала балончик')
				wait(1500); sampSendChat('/me закрыла рюкзак и повесила его на плечи')
				wait(1500); sampSendChat('/me встряхнув балончик, распылила содержимое на дверной замок')
				wait(1500); sampSendChat('/do Под действием содержимого балончика замок промёрз и стал хрупок.')
				wait(1500); sampSendChat('/me сняла дубинку с поясного держателя и, размахнувшись, ударила тыльной частью по замку')
			end
			wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
		end)
	else
		SCM(string.format('Используйте команду /%s [ид дома]', cmd))
	end
end

function command_invite(param)
	local cmd, ucmd = string.match(ini.cmd.invite, '(.+) | (.+)')

	if player_status > 0 then
		if string.match(param, '(%d+) (%d+)') then
			inv_id, inv_rang = string.match(param, '(%d+) (%d+)')
			if IPC(id) then
				if sampGetDistance(PLAYER_PED, inv_id) < 3 then
					lua_thread.create(function()
						if ini.info.male then
							sampSendChat('/me из внутреннего кармана достал планшет и включил его')
							wait(1500); sampSendChat('/me зайдя в базу данных МВД, добавил новое личное дело ' .. string.gsub(sampGetPlayerNickname(inv_id),'_',' ') .. '')
							wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
							wait(1500); sampSendChat('/me достал ключ от шкафчика под номером ' .. inv_id .. ' и передал его ' .. string.gsub(sampGetPlayerNickname(inv_id),'_',' '))
						else
							sampSendChat('/me из внутреннего кармана достала планшет и включила его')
							wait(1500); sampSendChat('/me зайдя в базу данных МВД, добавила новое личное дело ' .. string.gsub(sampGetPlayerNickname(inv_id),'_',' ') .. '')
							wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
							wait(1500); sampSendChat('/me достала ключ от шкафчика под номером ' .. inv_id .. ' и передала его ' .. string.gsub(sampGetPlayerNickname(inv_id),'_',' '))
						end
						wait(1000); sampSendChat(string.format('/%s %d', ucmd, inv_id))
					end)
				else
					SCM('Данный игрок находится слишком далеко от Вас.')
				end
			else
				SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			SCM(string.format('Используйте команду /%s [ид игрока] [ранг].', cmd))
		end
	else
		SCM('Вы не можете использовать данную функцию, вы не лидер и не его заместитель.')
	end
end

function command_uninvite(param)
	local cmd, ucmd = string.match(ini.cmd.uninvite, '(.+) | (.+)')

	if player_status > 0 then
		if string.match(param, '(%d+) (%S+)') then
			local id, reason = string.match(param, '(%d+) (.+)')
			if IPC(id) then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me из внутреннего кармана достал планшет и включил его')
						wait(1500); sampSendChat('/me зайдя в базу данных МВД, удалил личное дело ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. '')
						wait(1000); sampSendChat(string.format('/%s %d %s', ucmd, id, reason))
						wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
					else
						sampSendChat('/me из внутреннего кармана достала планшет и включила его')
						wait(1500); sampSendChat('/me зайдя в базу данных МВД, удалила личное дело ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. '')
						wait(1000); sampSendChat(string.format('/%s %d %s', ucmd, id, reason))
						wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
					end
					wait(1000); sampSendChat('/r ' .. ini.info.rteg .. ' Сотрудник ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. ' уволен по причине: ' .. reason)
				end)
			else
				SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			SCM(string.format('Используйте команду /%s [ид игрока] [причина].', cmd))
		end
	else
		SCM('Вы не можете использовать данную функцию, вы не лидер и не его заместитель.')
	end
end

function command_follow()
	local cmd, ucmd = string.match(ini.cmd.follow, '(.+) | (.+)')

	lua_thread.create(function()
		if follow_state then
			if ini.info.male then
				sampSendChat('/me достал планшет, перешёл в базу данных и выбрал пункт с настройкой радио-канала')
				wait(1000); sampSendChat(string.format('/%s', cmd))
				wait(1500); sampSendChat('/me отключился от внутреннего радио-канала, снял наушники и убрал их')
				wait(1500); sampSendChat('/me потушил экран планшета, убрал его обратно')
			else
				sampSendChat('/me достала планшет, перешла в базу данных и выбрала пункт с настройкой радио-канала')
				wait(1000); sampSendChat(string.format('/%s', cmd))
				wait(1500); sampSendChat('/me отключилась от внутреннего радио-канала, сняла наушники и убрала их')
				wait(1500); sampSendChat('/me потушила экран планшета, убрала его обратно')
			end
		else
			if ini.info.male then
				sampSendChat('/me достал планшет, перешёл в базу данных МВД и выбрал пункт с настройкой радио-канала')
				wait(1500); sampSendChat('/me ввёл необходимые параметры для подключенния к внутреннему радио-каналу')
				wait(1500); sampSendChat('/me достал наушники, параллельно заполнив нужную форму получения радио-сигналов')
				wait(1000); sampSendChat(string.format('/%s', cmd))
				wait(1500); sampSendChat('/me одел наушники, проверил звук, потушил экран планшета и убрал его')
			else
				sampSendChat('/me достала планшет, перешла в базу данных МВД и выбрала пункт с настройкой радио-канала')
				wait(1500); sampSendChat('/me ввела необходимые параметры для подключенния к внутреннему радио-каналу')
				wait(1500); sampSendChat('/me достала наушники, параллельно заполнив нужную форму получения радио-сигналов')
				wait(1000); sampSendChat(string.format('/%s', cmd))
				wait(1500); sampSendChat('/me одела наушники, проверила звук, потушила экран планшета и убрала его')
			end
		end
	end)
end

function command_rang(param)
	local cmd, ucmd = string.match(ini.cmd.rang, '(.+) | (.+)')

	if player_status > 0 then
		if string.match(param, '(%d+) [+?-]') then
			local id, rang = string.match(param, '(%d+) (.+)')
			if IPC(id) then
				if sampGetDistance(PLAYER_PED, id) < 3 then
					lua_thread.create(function()
						if ini.info.male then
							sampSendChat('/me из внутреннего кармана достал планшет и включил его')
							wait(1500); sampSendChat('/me зайдя в базу данных МВД, изменил должность ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. '')
							wait(1000); sampSendChat(string.format('/%s %d %s', ucmd, id, rang))
							wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
						else
							sampSendChat('/me из внутреннего кармана достала планшет и включила его')
							wait(1500); sampSendChat('/me зайдя в базу данных МВД, изменила должность ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. '')
							wait(1000); sampSendChat(string.format('/%s %d %s', ucmd, id, rang))
							wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
						end
					end)
				else
					SCM('Данный игрок находится слишком далеко от Вас.')
				end
			else
				SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			SCM(string.format('Используйте команду /%s [ид игрока] [+ или -].', cmd))
		end
	else
		SCM('Вы не можете использовать данную функцию, вы не лидер и не его заместитель.')
	end
end

function command_changeskin(id)
	local cmd, ucmd = string.match(ini.cmd.changeskin, '(.+) | (.+)')

	if player_status > 0 then
		if string.match(id, '(%d+)') then
			if IPC(id) then
				if sampGetDistance(PLAYER_PED, id) < 3 then
					lua_thread.create(function()
						if ini.info.male then
							sampSendChat('/me достал ключ от шкафчика под номером ' .. id .. ' и передал его ' .. string.gsub(sampGetPlayerNickname(id),'_',' '))
						else
							sampSendChat('/me достала ключ от шкафчика под номером ' .. id .. ' и передала его ' .. string.gsub(sampGetPlayerNickname(id),'_',' '))
						end
						wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
					end)
				else
					SCM('Данный игрок находится слишком далеко от Вас.')
				end
			else
				SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
		end
	else
		SCM('Вы не можете использовать данную функцию, вы не лидер и не его заместитель.')
	end
end

function command_cuff(id)
	local cmd, ucmd = string.match(ini.cmd.cuff, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 3 then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me завёл руки нарушителя за спину, после чего растягнул чехол для наручников'); wait(1500)
						sampSendChat('/me достав наручники из чехла, застегнул их на запястьях преступника')
					else
						sampSendChat('/me завела руки нарушителя за спину, после чего растягнула чехол для наручников'); wait(1500)
						sampSendChat('/me достав наручники из чехла, застегнула их на запястьях преступника')
					end
					wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_uncuff(id)
	local cmd, ucmd = string.match(ini.cmd.uncuff, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 3 then
				lua_thread.create(function()
					sampSendChat('/do На запястьях ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. ' находятся наручники.'); wait(1500)
					if ini.info.male then
						sampSendChat('/me сняв с пояса связку ключей, провернул один из них в замке наручников'); wait(1000)
						sampSendChat(string.format('/%s %d', ucmd, id)); wait(1500)
						sampSendChat('/me убрав наручники в чехол, повесил связку ключей на пояс')
					else
						sampSendChat('/me сняв с пояса связку ключей, провернула один из них в замке наручников'); wait(1000)
						sampSendChat(string.format('/%s %d', ucmd, id)); wait(1500)
						sampSendChat('/me убрав наручники в чехол, повесила связку ключей на пояс')
					end
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_skip(id)
	local cmd, ucmd = string.match(ini.cmd.skip, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 5 then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me из внутреннего кармана достал планшет и включил его')
						wait(1500); sampSendChat('/me зайдя в базу данных МВД, оформил временный пропуск на имя ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. '')
						wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
						wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
						wait(1000); sampSendChat('/r ' .. ini.info.rteg .. ' Оформил временный пропуск на имя ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. '.')
					else
						sampSendChat('/me из внутреннего кармана достала планшет и включила его')
						wait(1500); sampSendChat('/me зайдя в базу данных МВД, оформила временный пропуск на имя ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. '')
						wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
						wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
						wait(1000); sampSendChat('/r ' .. ini.info.rteg .. ' Оформила временный пропуск на имя ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. '.')
					end
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_open()
	local cmd, ucmd = string.match(ini.cmd.open, '(.+) | (.+)')

	lua_thread.create(function()
		sampSendChat(string.format('/%s', ucmd))
		openbar = true
		wait(150)
		openbar = false
	end)
end

function command_clear(param)
	local cmd, ucmd = string.match(ini.cmd.clear, '(.+) | (.+)')

	if string.match(param, '(%d+) (%S+)') then
		local id, reason = string.match(param, '(%d+) (.+)')
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 10 then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me достав планшет, зашёл в базу данных МВД и нашёл нужное дело')
						wait(1500); sampSendChat('/me пролистав страницу в самый низ, выбрал пункт с закрытием дела')
						wait(1000); sampSendChat(string.format('/%s %d' , ucmd, id))
						wait(1500); sampSendChat('/f ' .. ini.info.fteg .. ' Дело №' .. id .. ' (' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. ') закрыто. Причина: ' .. reason .. '')
						wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
					else
						sampSendChat('/me достав планшет, зашла в базу данных МВД и нашла нужное дело')
						wait(1500); sampSendChat('/me пролистав страницу в самый низ, выбрала пункт с закрытием дела')
						wait(1000); sampSendChat(string.format('/%s %d' , ucmd, id))
						wait(1500); sampSendChat('/f ' .. ini.info.fteg .. ' Дело №' .. id .. ' (' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. ') закрыто. Причина: ' .. reason .. '')
						wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
					end
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока] [причина].', cmd))
	end
end

function command_putpl(id)
	local cmd, ucmd = string.match(ini.cmd.putpl, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 4 then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me подведя подозреваемого к автомобилю, открыл дверь и посадил его туда')
					else
						sampSendChat('/me подведя подозреваемого к автомобилю, открыла дверь и посадила его туда')
					end
					wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_hold(id)
	local cmd, ucmd = string.match(ini.cmd.hold, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 3 then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me заломав руку подозреваемого, повёл его за собой')
					else
						sampSendChat('/me заломав руку подозреваемого, повела его за собой')
					end
					wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
					wait(1000); sampSendChat('/n При багоюзе (нажатие G) тебя кикнет и ты попадёшь в КПЗ.')
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_ticket(param)
	local cmd, ucmd = string.match(ini.cmd.ticket, '(.+) | (.+)')

	if string.match(param, '(%d+) (%d+) (%S+)') then
		local id, money, reason = string.match(param, '(%d+) (%d+) (.+)')
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 5 then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me достал блокнот, ручку и начал записывать информацию о нарушении')
						wait(1500); sampSendChat('/me заполнив всю информацию о нарушении, передал бланк нарушителю')
						wait(1000); sampSendChat(string.format('/%s %d %d %s', ucmd, id, money, reason))
						wait(1500); sampSendChat('/me убрал блокнот и ручку обратно во внутренний карман')
					else
						sampSendChat('/me достала блокнот, ручку и начала записывать информацию о нарушении')
						wait(1500); sampSendChat('/me заполнив всю информацию о нарушении, передала бланк нарушителю')
						wait(1000); sampSendChat(string.format('/%s %d %d %s', ucmd, id, money, reason))
						wait(1500); sampSendChat('/me убрала блокнот и ручку обратно во внутренний карман')
					end
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Вы ввели неверный ид игрока (игрок не авторизован)')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока] [сумма] [причина]', cmd))
	end
end

function command_takelic(param)
	local cmd, ucmd = string.match(ini.cmd.takelic, '(.+) | (.+)')

	if string.match(param, '(%d+) (%S+)') then
		local id, reason = string.match(param, '(%d+) (.+)')
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 15 then
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me достал планшет, зашёл в базу данных МВД и ввёл номер Т/С')
						wait(1500); sampSendChat('/me получив информацию о водителе, изъял его лицензию на вождение')
					else
						sampSendChat('/me достала планшет, зашла в базу данных МВД и ввела номер Т/С')
						wait(1500); sampSendChat('/me получив информацию о водителе, изъяла его лицензию на вождение')
					end
					wait(1000); sampSendChat(string.format('/%s %d %s', ucmd, id, reason))
				end)
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Вы ввели неверный ид игрока (игрок не авторизован)')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока] [причина]', cmd))
	end
end

function command_pull(id)
	local cmd, ucmd = string.match(ini.cmd.pull, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 3 then
				local res, vid = sampIsPlayerCar(id)
				if res then
					lua_thread.create(function()
						if tCarsType[vid - 399] == 2 or tCarsType[vid - 399] == 9 then
							if ini.info.male then
								sampSendChat('/me подойдя к подозреваемому, толкнул его, тем самым скинул его с байка')
								wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
							else
								sampSendChat('/me подойдя к подозреваемому, толкнула его, тем самым скинула его с байка')
								wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
							end
						else
							if ini.info.male then
								sampSendChat('/me сняв дубинку с пояса, ударил её тыльную частью по стеклу')
								wait(1500); sampSendChat('/me повесив дубинку на пояс, просунул руку в стекло и открыл дверь')
								wait(1500); sampSendChat('/me взявшись за подозреваемого, вытащил его из машины')
								wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
							else
								sampSendChat('/me сняв дубинку с пояса, ударила её тыльную частью по стеклу')
								wait(1500); sampSendChat('/me повесив дубинку на пояс, просунула руку в стекло и открыла дверь')
								wait(1500); sampSendChat('/me взявшись за подозреваемого, вытащила его из машины')
								wait(1000); sampSendChat(string.format('/%s %d', ucmd, id))
							end
						end
					end)
				else
					SCM('Данный игрок не находится в автомобиле.')
				end
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_arrest(id)
	local cmd, ucmd = string.match(ini.cmd.arrest, '(.+) | (.+)')

	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistance(PLAYER_PED, id) < 5 then
				if sampIsPlayerCarHaveSuspect(id) then
					lua_thread.create(function()
						if ini.info.male then
							sampSendChat('/me включил бортовой компьютер и заполнил информацию о нарушителе'); wait(1500)
							sampSendChat('/me снял рацию с плеча, поднёс её ко рту и что-то произнёс'); wait(1000)
							sampSendChat('/r ' .. ini.info.rteg .. ' Подозреваемый по делу №' .. id .. ' (' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. ') передан в департамент.'); wait(1000)
							sampSendChat(string.format('/%s %d', ucmd, id)); wait(1500)
							sampSendChat('/do Из департамента вышли два офицера и увели подозреваемого с собой.')
						else
							sampSendChat('/me включила бортовой компьютер и заполнила информацию о нарушителе'); wait(1500)
							sampSendChat('/me сняла рацию с плеча, поднесла её ко рту и что-то произнесла'); wait(1000)
							sampSendChat('/r ' .. ini.info.rteg .. ' Подозреваемый по делу №' .. id .. ' (' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. ') передан в департамент.'); wait(1000)
							sampSendChat(string.format('/%s %d', ucmd, id)); wait(1500)
							sampSendChat('/do Из департамента вышли два офицера и увели подозреваемого с собой.')
						end
					end)
				else
					SCM('В вашей машине не находится данный игрок.')
				end
			else
				SCM('Данный игрок находится слишком далеко от Вас.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока].', cmd))
	end
end

function command_su(param)
	local cmd, ucmd = string.match(ini.cmd.su, '(.+) | (.+)')

	if string.match(param, '(%d+) (%d+) (%S+)') then
		local id, stars, reason = string.match(param, '(%d+) (%d+) (.+)')
		if IPC(id) then
			if sampGetPlayerColor(id) ~= 2236962 then
				lua_thread.create(function()
					if sampGetCharHandleBySampPlayerId(id) then
						if ini.info.male then
							sampSendChat('/me сняв тангету с плеча, передал диспетчеру информацию о подозреваемом')
						else
							sampSendChat('/me сняв тангету с плеча, передала диспетчеру информацию о подозреваемом')
						end
						
						wait(1000)
						
						if sampGetDistance(PLAYER_PED, id) <= 65 then
							sampSendChat(string.format('/%s %d %d %s', ucmd, id, stars, reason))
							wait(1500)
							sampSendChat('/do ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. ' был объявлен в розыск по причине: ' .. reason .. '.')
						else
							SCM('Подозреваемый слишком далеко, розыск выдастся сразу же, как будет возможность.')
							while sampGetDistance(PLAYER_PED, id) > 65 do
								wait(0)
							
								local result, ped = sampGetCharHandleBySampPlayerId(id)
								if not result then 
									SCM('Подозревамый пропал из зоны видимости.')
									break
								elseif sampGetPlayerColor(id) == 2236962  then
									SCM('Подозреваемый надел на лицо маску, невозможно выдать розыск.')
									break
								end
							end
							
							if sampGetDistance(PLAYER_PED, id) <= 65 then
								sampSendChat(string.format('/%s %d %d %s', ucmd, id, stars, reason))
								wait(1500)
								sampSendChat('/do ' .. string.gsub(sampGetPlayerNickname(id),'_',' ') .. ' был объявлен в розыск по причине: ' .. reason .. '.')
							end
						end
					else
						SCM('Данный игрок находится слишком далеко от Вас.')
					end
				end)
			else
				SCM('Данный игрок находится в маске.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	elseif string.match(param, '(%d+)') then
		local id = string.match(param, '(%d+)')
		if IPC(id) then
			if sampGetPlayerColor(id) ~= 2236962 then
				if sampGetDistance(PLAYER_PED, id) <= 65 then
					if smart_suspect.text ~= nil then
						smart_suspect.id = id
						show_suspect.v = not show_suspect.v
					else
						SCM('Данная возможность Вам недоступна.')
					end
				else
					SCM('Данный игрок находится слишком далеко от Вас.')
				end
			else
				SCM('Данный игрок находится в маске.')
			end
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		SCM(string.format('Используйте команду /%s [ид игрока] [кол-во звёзд] [причина].', cmd))
	end
end

function command_users()
	async_http_request('GET', 'https://raw.githubusercontent.com/skezz-perry/project/master/users', nil,
		function(response)
			users = response.text
	end)
	
	local dline = 'Имя\tСтатус\tДополнительно\n'
	local all = 0
	local online = 0

	for line in string.gmatch(users, "[^\n]+") do
		if string.match(line, '(.+) | (.+) | (.+) | (.+)') then
			local name, rang, nrang = string.match(line, '(.+) | (.+) | (.+) | (.+)')
			local rang = u8:decode(rang)
			local id = sampGetPlayerIdByNickname(name)
			all = all + 1
			
			local rang = string.format('%s %s', getColorRang(nrang), rang)
			
			if id == 'offline' then
				dline = string.format('%s{696969}%s\t{696969}%s ранг. %s\t{ff5c33}Оффлайн\n', dline, name, player_rang[name], rang)
			else
				local res, ped = sampGetCharHandleBySampPlayerId(id)
				online = online + 1
				
				if res then
					local dist = math.floor(sampGetDistance(PLAYER_PED, id))
					
					if sampIsPlayerPaused(id) then
						dline = string.format('%s{%s}%s[%d]\t%s ранг. %s\t{ff5c33}Дист: %d м\n', dline, sampGetColor(id), name, id, player_rang[name], rang, dist)
					else
						dline = string.format('%s{%s}%s[%d]\t%s ранг. %s\t{00cc99}Дист: %d м\n', dline, sampGetColor(id), name, id, player_rang[name], rang, dist)
					end
				else
					dline = string.format('%s{%s}%s[%d]\t%s ранг. %s\t{00cc99}Онлайн\n', dline, sampGetColor(id), name, id, player_rang[name], rang)
				end
			end
		end
	end
	
	local caption = string.format('{ffffff}Всего пользователей {FFCD00}%d чел. {00CC66}(онлайн %d)', all, online)
	sampShowDialog(1001, caption, dline, 'Закрыть', '', 5)
end

function command_admins()
	if player_status > 1 then
		local dline = 'Имя\tДолжность\tДополнительно\n'
		local all = 0
		local online = 0
		
		for line in io.lines('moonloader\\helper\\Admins.txt') do
			all = all + 1
			local name, rang, nrang = string.match(line, '(.+) | (.+) | (.+)')
			local id = sampGetPlayerIdByNickname(name)
			if id == 'offline' then
				dline = string.format('%s{696969}%s\t{696969}%s ранг. %s\t{ff5c33}Оффлайн\n', dline, name, nrang, rang)
			else
				local res, ped = sampGetCharHandleBySampPlayerId(id)
				online = online + 1
				if res then
					dist = math.floor(sampGetDistance(PLAYER_PED, id))
					if sampIsPlayerPaused(id) then
						dline = string.format('%s{%s}%s[%d]\t%s ранг. %s\t{ff5c33}Дист: %d м\n', dline, sampGetColor(id), name, id, nrang, rang, dist)
					else
						dline = string.format('%s{%s}%s[%d]\t%s ранг. %s\t{00cc99}Дист: %d м\n', dline, sampGetColor(id), name, id, nrang, rang, dist)
					end
				else
					dline = string.format('%s{%s}%s[%d]\t%s ранг. %s\t{00cc99}Онлайн\n', dline, sampGetColor(id), name, id, nrang, rang)
				end
			end
		end
		
		local caption = string.format('{ffffff}Всего администраторов {FFCD00}%d чел. {00CC66}(онлайн %d)', all, online)
		sampShowDialog(1000, caption, dline, 'Закрыть', '', 5)
	end
end

function command_bl(param)
	local cmd, ucmd = string.match(ini.cmd.bl_hist, '(.+) | (.+)')

	if string.match(param, '(%d+)') then
		if IPC(param) then
			local name = sampGetPlayerNickname(param)
			sampSendChat('/history ' .. name)
			pushMessage('Ожидайте...', 3, 4)
			check_bl = true
			black_list = nil
			black_list = {}
		end
	elseif string.match(param, '(%S+)') then
		sampSendChat('/history ' .. param)
		pushMessage('Ожидайте...', 3, 4)
		check_bl = true
		black_list = nil
		black_list = {}
	else
		SCM(string.format('Используйте команду /%s [ид или никнейм игрока].', cmd))
	end
end

function command_namebl(param)
	local cmd, ucmd = string.match(ini.cmd.bl_name, '(.+) | (.+)')

	if string.match(param, '(%d+)') then
		if IPC(param) then
			pushMessage('Ожидайте...', 3, 4)
		
			local name = sampGetPlayerNickname(param)
			async_http_request('GET', ini.set.blacklist, nil,
				function(response)
				
				if u8:decode(response.text):find(name) or u8:decode(response.text):find(string.gsub(name, '_', ' ')) then
					SCM(string.format('%s {ff5c33}находится{ffffff} в чёрном списке.', name))
				else
					SCM(string.format('%s {00cc99}не находится{ffffff} в чёрном списке.', name))
				end
			end)
		else
			SCM('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	elseif string.match(param, '(%S+)') then
		pushMessage('Ожидайте...', 3, 4)
		async_http_request('GET', ini.set.blacklist, nil,
			function(response)
			
			if u8:decode(response.text):find(param) or u8:decode(response.text):find(string.gsub(param, '_', ' ')) then
				SCM(string.format('%s {ff5c33}находится{ffffff} в чёрном списке.', param))
			else
				SCM(string.format('%s {00cc99}не находится{ffffff} в чёрном списке.', param))
			end
		end)
	else
		SCM(string.format('Используйте команду /%s [ид или никнейм игрока].', cmd))
	end
end

function command_rofl(param)
	local cmd, ucmd = string.match(ini.cmd.akick, '(.+) | (.+)')

	if player_status > 2 then
		if string.match(param, '(%d+)') then
			local number = string.match(param, '(%d+)')
			
			local name = sampGetPlayerNickname(number)
			if ini.number[name] ~= nil then
				sampSendChat(string.format('/sms %d %s', ini.number[name], u8'кикнуть_ето_чучело'))
			else
				sampSendChat(string.format('/sms %d %s', number, u8'кикнуть_ето_чучело'))
			end
		else
			SCM(string.format('Используйте команду /%s [ид или номер игрока].', cmd))
		end
	end
end

function CheckPlayersOfBlackList(name, tab)
	if type(tab) == ('table') then
		local blfound = false
	
		async_http_request('GET', ini.set.blacklist, nil,
			function(response) 
			
			for i, val in pairs(tab) do
				if u8:decode(response.text):find(val) or u8:decode(response.text):find(string.gsub(val, '_', ' ')) then
					SCM(string.format('%s {ff5c33}находится{ffffff} в чёрном списке под именем %s.', name, val))
					blfound = true
					break
				end
			end
			
			if not blfound then
				SCM(string.format('%s {00cc99}не находится{ffffff} в чёрном списке.', name))
			end
		end)
	end
end

function show_flymode()
	local font_t = renderCreateFont('Century Gothic', 14, font_flag.BOLD)
	local type_vision = 0
	
	while true do
		wait(0)
		
		if flymode and ini.set.kvadrocopter then
			local sx, sy = getScreenResolution()
			
			-- эффект затемнения
			if ini.set.skvadrocopter then
				--renderDrawBox(0.0, 0.0, sx, sy, 0x991C1C1C)
			end
			--
			
			-- прицел перекрестие
			renderDrawLine(sx / 2 - 3.0, sy / 2 - 25, sx / 2 - 3.0, sy / 2 - 235, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2, sy / 2 + 25, sx / 2, sy / 2 + 235, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - 25, sy / 2 - 3.0, sx / 2 - 235, sy / 2 - 3.0, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 + 25, sy / 2 - 3.0, sx / 2 + 235, sy / 2 - 3.0, 3.0, 0xFFFFFFFF)
			
			renderDrawLine(sx / 2 - 22.0, sy / 2 - 235, sx / 2 + 20.0, sy / 2 - 235, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - 23.0, sy / 2 + 235, sx / 2 + 20.0, sy / 2 + 235, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - 235, sy / 2 - 23.0, sx / 2 - 235, sy / 2 + 20.0, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 + 235, sy / 2 - 22.0, sx / 2 + 235, sy / 2 + 20.0, 3.0, 0xFFFFFFFF)
			
			renderDrawLine(sx / 2 - 22.0, sy / 2 - (235 / 2), sx / 2 + 20.0, sy / 2 - (235 / 2), 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - 23.0, sy / 2 + (235 / 2), sx / 2 + 20.0, sy / 2 + (235 / 2), 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - (235 / 2), sy / 2 - 23.0, sx / 2 - (235 / 2), sy / 2 + 20.0, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 + (235 / 2), sy / 2 - 22.0, sx / 2 + (235 / 2), sy / 2 + 20.0, 3.0, 0xFFFFFFFF)
			--
			
			-- изображение времени
			local t_time = string.format('%s', os.date('%X'))
			local t_date = string.format('%d of %s, %d', os.date('%d'), os.date('%B'), os.date('%Y'))
			
			renderFontDrawText(font_t, t_time, sx / 2 + 410, sy / 2 + 300, 0xFFFFFFFF)
			renderFontDrawText(font_t, t_date, sx / 2 + 410, sy / 2 + 280, 0xFFFFFFFF)
			--
			
			-- изображение текста
			local f_line = string.format('0    A-G    MAN    NARO')
			local s_line = string.format('RAY    FF 30')
			local t_line = string.format('A-LIR    B0RE')
			local p_line = string.format('UNMANNED AERIAL VEHICLE')
			local m_line = string.upper(string.format('%s [%s]', calculateZone(posX, posY, posZ), kvadrat(posX, posY, posZ)))
			
			renderFontDrawText(font_t, f_line, sx - 215, 300, 0xFFFFFFFF)
			renderFontDrawText(font_t, s_line, sx - 115, 330, 0xFFFFFFFF)
			renderFontDrawText(font_t, t_line, sx - 120, 360, 0xFFFFFFFF)
			renderFontDrawText(font_t, p_line, sx / 2 - ((string.len(p_line) / 2) * 10), sy - 30, 0xFFFFFFFF)
			renderFontDrawText(font_t, m_line, sx / 2 - ((string.len(m_line) / 2) * 10), sy - 48, 0xFFFFFFFF)
			--
			
			
			
			-- проверка на отдаление и изображение помех
			local x, y, z = getCharCoordinates(playerPed)
			local distance = getDistanceBetweenCoords3d(x, y, z, posX, posY, posZ)
			
			if distance >= 245 then
				destroy_camhack()
			elseif distance >= 235 then
				renderFontDrawText(font_t, 'LOSS OF CONNECTION. SHUTDOWN.', sx / 2 + 30, sy / 2 + 30, 0xFFFF0000)
			elseif distance >= 200 then
				renderFontDrawText(font_t, 'LOSS OF CONNECTION. RETURN BACK.', sx / 2 + 30, sy / 2 + 30, 0xFFFF0000)
			else
				local text = string.format('%d m from unit', distance)
				renderFontDrawText(font_t, text, sx / 2 + 30, sy / 2 + 30, 0xFFFFFFFF)
			end
			
			--[[for i = 1, distance * 4 do
				local err_col = {0xFF363636, 0xFF4F4F4F, 0xFF696969, 0xFF828282, 0xFF9C9C9C}
				local psx, psy, err = math.random(0, sx), math.random(0, sy), math.random(1, 5)
				renderDrawBox(psx, psy, 3, 3, 0xFFCECECE, err_col[err])
			end]]
			--
			
			if targetSet ~= nil then
				local result, pped = sampGetCharHandleBySampPlayerId(targetSet)
				
				if result then
					local px, py, pz = getCharCoordinates(pped)
					local pdistance = getDistanceBetweenCoords3d(x, y, z, px, py, pz)
					
					local text = string.format('%d m to the target', pdistance)
					renderFontDrawText(font_t, text, sx / 2 + 30, sy / 2 + 48, 0xFFFFFFFF)
				else
					targetSet = nil
				end
			end
			
			if wasKeyPressed(KEY.VK_LBUTTON) then
				targetSet = getnear()
			end
			
			if wasKeyPressed(KEY.VK_RBUTTON) then
				targetSet = nil
			end
			
			if wasKeyPressed(KEY.VK_O) then
				if isKeyCheckAvailable() then
					type_vision = type_vision + 1
					if type_vision > 2 then type_vision = 0 end
				
					if type_vision == 0 then
						setNightVision(false)
						setInfraredVision(false)
					elseif type_vision == 1 then
						setInfraredVision(true)
						setNightVision(false)
					elseif type_vision == 2 then
						setInfraredVision(false)
						setNightVision(true)
					end
				end
			end
			
			-- изображение типа отображения
			if type_vision == 0 then
				color_infra, color_night = 0x88FFFFFF, 0x88FFFFFF
			elseif type_vision == 1 then
				color_infra, color_night = 0xFFFFFFFF, 0x88FFFFFF
			elseif type_vision == 2 then
				color_infra, color_night = 0x88FFFFFF, 0xFFFFFFFF
			end
			
			renderFontDrawText(font_t, 'INFRARED VISION', 60, sy / 2, color_infra)
			renderFontDrawText(font_t, 'NIGHT VISION', 60, sy / 2 + 30, color_night)
			--
 		end
	end
end

function getnear()
    local all_players = getAllChars()
    local lastchar = {}
    local mx, my, mz = poiX, poiY, poiZ

    for k, v in pairs(all_players) do
        if v ~= nil and v ~= 1 then
            local x, y, z = getCharCoordinates(v)
            if lastchar[1] == nil and isCharOnScreen(v) then
                local distance = getDistanceBetweenCoords2d(mx, my, x, y)
                lastchar = {v, distance}
            else
				if isCharOnScreen(v) then
					local distance = getDistanceBetweenCoords2d(mx, my, x, y)
					if tonumber(lastchar[2]) > tonumber(distance) then
						lastchar = {v, distance}
					end
				end
            end
        end
    end

    if lastchar[1] ~= nil then
		local id = select(2, sampGetPlayerIdByCharHandle(lastchar[1]))
		--local nick = sampGetPlayerNickname(id)
		--SCM(string.format('Ближайший игрок: %s [%s]', nick, lastchar[2]))
		return id
    end
end

function getBodyPartCoordinates(id, handle)
  local pedptr = getCharPointer(handle)
  local vec = ffi.new("float[3]")
  getBonePosition(ffi.cast("void*", pedptr), vec, id, true)
  return vec[0], vec[1], vec[2]
end

function imgui.OnDrawFrame()
	if show_menu.v then
		local w, h = getScreenResolution()
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(800, 550))
		imgui.Begin(u8'##menu', show_menu, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)

			imgui.BeginChild('##button_block', imgui.ImVec2(250, 470), true, imgui.WindowFlags.VerticalScrollbar)
				imgui.CenterTextColoredRGB('HELPER FOR MIA')
				
				imgui.Text('')
				
				if imgui.Button(u8'Главная страница', imgui.ImVec2(235, 20)) then show_item.v = 8 end
				if imgui.Button(u8'Настройки', imgui.ImVec2(235, 20)) then show_item.v = 0 end
				if imgui.Button(u8'Расширенные настройки', imgui.ImVec2(235, 20)) then show_item.v = 1 end
				if player_status > 1 then
					if imgui.Button(u8'Администрация', imgui.ImVec2(235, 20)) then show_item.v = 2 end
				end
				if imgui.Button(u8'Информация', imgui.ImVec2(235, 20)) then show_item.v = 3 end
				if imgui.Button(u8'Дополнительные возможности', imgui.ImVec2(235, 20)) then show_item.v = 4 end
				if imgui.Button(u8'Кастомизация', imgui.ImVec2(235, 20)) then show_item.v = 5 end
				if imgui.Button(u8'Менеджер паролей', imgui.ImVec2(235, 20)) then show_item.v = 6 end
			    if player_status > 0 then 	
					if imgui.Button(u8'Панель лидера', imgui.ImVec2(235, 20)) then show_item.v = 7 end
				end
				if imgui.Button(u8'Перезагрузить', imgui.ImVec2(235, 20)) then
					show_menu.v = not show_menu.v
					lua_thread.create(function() wait(1000) thisScript():reload() end)
				end
				if imgui.Button(u8'Выключить', imgui.ImVec2(235, 20)) then
					thisScript():unload()
				end
				
				imgui.Text('')
				
				imgui.CenterTextColoredRGB('All rights reserved © 2019')
				
			imgui.EndChild()
			
			imgui.SameLine()
			
			if show_item.v == 8 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true)
					
					draw_head_page()
					
				imgui.EndChild()
			end
			
			if show_item.v == 0 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true)
					
					imgui.CenterTextColoredRGB('ОСНОВНЫЕ НАСТРОЙКИ')
					
					imgui.Text('')
					
					imgui.PushItemWidth(200)
					if imgui.InputText(u8'Имя и фамилия', pname) then
						ini.info.name = u8:decode(pname.v)
						inicfg.save(ini, 'Helper for MIA.ini')
					end
					ShowHelpMarker(string.format('Текущее значение: %s', ini.info.name))
					if imgui.InputText(u8'Должность', prang) then
						ini.info.rang = u8:decode(prang.v)
						inicfg.save(ini, 'Helper for MIA.ini')
					end
					ShowHelpMarker(string.format('Текущее значение: %s', ini.info.rang))
					if imgui.InputText(u8'Подразделение', pfrac) then
						ini.info.frac = u8:decode(pfrac.v)
						inicfg.save(ini, 'Helper for MIA.ini')
					end
					ShowHelpMarker(string.format('Текущее значение: %s', ini.info.frac))
					if imgui.InputText(u8'Личный номер', pnumber) then
						ini.info.number = u8:decode(pnumber.v)
						inicfg.save(ini, 'Helper for MIA.ini')
					end
					ShowHelpMarker(string.format('Текущее значение: %s', ini.info.number))
					if imgui.InputText(u8'Префикс в основную рацию', rteg) then
						ini.info.rteg = u8:decode(rteg.v)
						inicfg.save(ini, 'Helper for MIA.ini')
					end
					ShowHelpMarker(string.format('Текущее значение: %s', ini.info.rteg))
					if imgui.InputText(u8'Префикс в общую волну', fteg) then
						ini.info.fteg = u8:decode(fteg.v)
						inicfg.save(ini, 'Helper for MIA.ini')
					end
					ShowHelpMarker(string.format('Текущее значение: %s', ini.info.fteg))
					
					imgui.Text('')
					
					imgui.Separator()
					
					imgui.Text('')
					
					imgui.CenterTextColoredRGB('ДОПОЛНИТЕЛЬНЫЕ НАСТРОЙКИ')
					
					imgui.Text('')
					
					imgui.BeginChild('##first_block', imgui.ImVec2(250, 150), true)
						if imgui.Checkbox(u8'Режим женских отыгровок', male) then 
							ini.info.male = not male.v
							inicfg.save(ini, 'Helper for MIA.ini') 
						end
						if imgui.Checkbox(u8'Объявления от СМИ', pstopad) then 
							ini.set.stopad = pstopad.v
							inicfg.save(ini, 'Helper for MIA.ini') 
						end
						if imgui.Checkbox(u8'Стробоскопы', pstrobes) then 
							ini.set.strobes = pstrobes.v
							inicfg.save(ini, 'Helper for MIA.ini') 
						end
						if imgui.Checkbox(u8'Изменённая рация', pradio) then 
							ini.set.radio = pradio.v
							inicfg.save(ini, 'Helper for MIA.ini') 
						end
						if imgui.Checkbox(u8'Таймер маски', pmasktimer) then 
							ini.set.masktimer = pmasktimer.v
							inicfg.save(ini, 'Helper for MIA.ini') 
						end
					imgui.EndChild()
					
					imgui.SameLine()
					
					imgui.BeginChild('##second_block', imgui.ImVec2(250, 215), true)
						if imgui.Checkbox(u8'Отыгровка камеры', pcamera) then 
							ini.set.camera = pcamera.v
							inicfg.save(ini, 'Helper for MIA.ini') 
						end
						if imgui.Checkbox(u8'Мелкие отыгровки', plowrp) then 
							ini.set.lowrp = plowrp.v
							inicfg.save(ini, 'Helper for MIA.ini') 
							
							if plowrp.v then pushMessage('Вам доступно новое подменю «Мелкие отыгровки» в разделе расширенных настроек', 3, 2) end
						end
						if imgui.Checkbox(u8'Отыгровки оружия', prpweapon) then 
							ini.set.rpweapon = prpweapon.v
							inicfg.save(ini, 'Helper for MIA.ini')
							
							if prpweapon.v then pushMessage('Вам доступно новое подменю «Отыгровки оружия» в разделе расширенных настроек', 3, 2) end
						end
						if imgui.Checkbox(u8'Авто-взятие оружия', pautoweapon) then 
							ini.set.autoweapon = pautoweapon.v
							inicfg.save(ini, 'Helper for MIA.ini') 
							
							if pautoweapon.v then pushMessage('Вам доступно новое подменю «Умный склад оружия» в разделе расширенных настроек', 3, 2) end
						end
						if imgui.Checkbox(u8'Авто-проверка паспорта', pautopass) then 
							ini.set.autopass = pautopass.v
							inicfg.save(ini, 'Helper for MIA.ini') 
						end
					imgui.EndChild()
					
					if imgui.Button('RETURN TO THE NORMAL ENCODING', imgui.ImVec2(515, 20)) then
						decode()
					end
					ShowHelpMarker('Данная кнопка нужна для того, чтобы восстановить кодировку скрипта.\nЕсли же у вас нету иероглифов, то слетит весь текст в скрипте.')
				imgui.EndChild()
			end
				
			if show_item.v == 1 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true)
					imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ')
					
					imgui.Text('')
					
					if imgui.Button(u8'Авто-взятие оружия', imgui.ImVec2(170, 20)) then set_item.v = 0 end
					imgui.SameLine()
					if imgui.Button(u8'Отыгровки оружия', imgui.ImVec2(165, 20)) then set_item.v = 1 end
					imgui.SameLine()
					if imgui.Button(u8'Мелкие отыгровки', imgui.ImVec2(170, 20)) then set_item.v = 2 end

					if imgui.Button(u8'Улучшенные диалоги', imgui.ImVec2(255, 20)) then set_item.v = 3 end
					imgui.SameLine()
					if imgui.Button(u8'Дополнительно', imgui.ImVec2(255, 20)) then set_item.v = 4 end
					
					if imgui.Button(u8'Изменение команд', imgui.ImVec2(255, 20)) then set_item.v = 5 end
					imgui.SameLine()
					if imgui.Button(u8'Изменение горячих клавиш', imgui.ImVec2(255, 20)) then set_item.v = 6 end
					
					if imgui.Button(u8'Модификации', imgui.ImVec2(515, 20)) then set_item.v = 7 end
					
					
					if set_item.v == 0 then
						imgui.Text('')
						if ini.set.autoweapon then
							imgui.CenterTextColoredRGB('Добавление оружия                                Множитель боеприпасов')
							for i, val in pairs(InfoWeapon) do
								if ini.weapon[val[3]] then
									if imgui.Button(u8(val[1] .. ' • Убрать'), imgui.ImVec2(250, 20)) then
										ini.weapon[val[3]] = not ini.weapon[val[3]]
										inicfg.save(ini, 'Helper for MIA.ini')
									end
								else
									if imgui.Button(u8(val[1] .. ' • Добавить'), imgui.ImVec2(250, 20)) then
										ini.weapon[val[3]] = not ini.weapon[val[3]]
										inicfg.save(ini, 'Helper for MIA.ini') 
									end
								end
								
								imgui.SameLine()
								
								if val[2] then
									imgui.PushItemWidth(250)
									if imgui.SliderInt('##' .. val[3], imgui.ImInt(ini.weapon[val[4]]), 1, 2) then
										if ini.weapon[val[4]] == 1 then 
											ini.weapon[val[4]] = 2
										elseif ini.weapon[val[4]] == 2 then
											ini.weapon[val[4]] = 1
										end
										inicfg.save(ini, 'Helper for MIA.ini') 
									end
								else
									imgui.Button(u8'Не настривается', imgui.ImVec2(250, 20))
								end
							end
						else
							imgui.CenterTextColoredRGB('Вам недоступен данный подраздел.')
						end
					end
					
					if set_item.v == 1 then
						if ini.set.rpweapon then
							if ini.set.halfrpweapon then
								if imgui.Button(u8'Полуавтоматические отыгровки оружия', imgui.ImVec2(515, 25)) then
									ini.set.halfrpweapon = false
									ini.set.autorpweapon = true
									inicfg.save(ini, 'Helper for MIA.ini') 
								end
							else
								if imgui.Button(u8'Автоматические отыгровки оружия', imgui.ImVec2(515, 25)) then
									ini.set.halfrpweapon = true
									ini.set.autorpweapon = false
									inicfg.save(ini, 'Helper for MIA.ini')
								end
							end
							
							imgui.Text('')
							
							imgui.BeginChild('##first_block', imgui.ImVec2(120, 170), true)
								imgui.PushItemWidth(110)
								if imgui.ListBox('##weapons', weaponid, weapon, 7) then
									if weapons.get_name(weaponid.v + 1) ~= nil then
										rpweaponid = weaponid.v + 1
										local _, t = sampWeaponScene(rpweaponid)
										local _, to = sampWeaponSceneOff(rpweaponid)
										
										takeweap.v, takeweapoff.v = u8(t), u8(to)
									end
								end
							imgui.EndChild()
							
							imgui.SameLine()
							
							imgui.BeginChild('##second_block', imgui.ImVec2(400, 150), true)
								imgui.TextColoredRGB(string.format('{EEEEEE}Оружие, выбранное для редактирования: {B22222}%s', weapons.get_name(rpweaponid)))
								
								imgui.PushItemWidth(385)
								imgui.Text(u8'> Отыгровки при взятие оружия в руки')
								imgui.InputText('##takeweap', takeweap)
								imgui.Text(u8'< Отыгровки при скрытие оружия')
								imgui.InputText('##takeweapoff', takeweapoff)
								
								if imgui.Button(u8'Сохранить', imgui.ImVec2(385, 20)) then
									local wname = weapons.get_name(rpweaponid)
									if wname == '9mm' then wname = 'p9mm' end
									local wname = string.gsub(wname, '-', '_')
									local wname = string.gsub(wname, ' ', '_')
									
									ini.rpweapon[wname]     = u8:decode(takeweap.v)
									ini.rpweaponoff[wname]  = u8:decode(takeweapoff.v)
									inicfg.save(ini, 'Helper for MIA.ini')
									
									pushMessage('Отыгровка успешно сохранена.', 3, 4)
								end
							imgui.EndChild()
						else
							imgui.Text('')
							imgui.CenterTextColoredRGB('Вам недоступен данный подраздел.')
						end
					end
					
					if set_item.v == 2 then
						imgui.Text('')
						if ini.set.lowrp then
							if imgui.Checkbox(u8'Отыгровка при использовании аптечки', prphealme) then 
								ini.lowrp.rphealme = prphealme.v
								inicfg.save(ini, 'Helper for MIA.ini') 
							end
							if imgui.Checkbox(u8'Отыгровка при использовании маски', prpmask) then 
								ini.lowrp.rpmask = prpmask.v
								inicfg.save(ini, 'Helper for MIA.ini') 
							end
							if imgui.Checkbox(u8'Отыгровка при открытии спецблока в здание Федерального Бюро', prpfbi) then 
								ini.lowrp.rpfbi = prpfbi.v
								inicfg.save(ini, 'Helper for MIA.ini') 
							end
							if imgui.Checkbox(u8'Отыгровка при открытии шлагбаума', prpbar) then 
								ini.lowrp.rpbar = prpbar.v
								inicfg.save(ini, 'Helper for MIA.ini') 
							end
							if imgui.Checkbox(u8'Отыгровка при использовании рации', prpradio) then 
								ini.lowrp.rpradio = prpradio.v
								inicfg.save(ini, 'Helper for MIA.ini') 
							end
						else
							imgui.CenterTextColoredRGB('Вам недоступен данный подраздел.')
						end
					end
					
					if set_item.v == 3 then
						draw_new_dialog()
					end
					
					if set_item.v == 4 then
						draw_another_settings()
					end
					
					if set_item.v == 5 then
						draw_commands_settings()
					end
					
					if set_item.v == 6 then
						draw_hotkey_settings()
					end
					
					if set_item.v == 7 then
						draw_modification()
					end
				imgui.EndChild()
			end
				
			if show_item.v == 2 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true, imgui.WindowFlags.HorizontalScrollbar)
					imgui.CenterTextColoredRGB('СПИСОК АДМИНИСТРАЦИИ')
					
					imgui.Text('')
					
					if imgui.Button(u8'Подгрузить', imgui.ImVec2(170, 25)) then
						local line = ''
						for val in io.lines('moonloader//helper//Admins.txt') do line = string.format('%s%s\n', line, val) end
						admins.v = u8(line)
					end
					imgui.SameLine()
					if imgui.Button(u8'Редактировать', imgui.ImVec2(160, 25)) then
						editor.v = not editor.v
					end
					imgui.SameLine()
					if imgui.Button(u8'Сохранить', imgui.ImVec2(170, 25)) and editor.v then
						local filew = io.open('moonloader//helper//Admins.txt', 'w')
						filew:write(u8:decode(admins.v))
						filew:close()
					end
					
					imgui.Text('')
					
					if editor.v then
						imgui.PushItemWidth(420)
						imgui.InputTextMultiline('##admins', admins, imgui.ImVec2(-1, imgui.GetTextLineHeight() * 33))
					else
						imgui.Text(admins.v)
					end
				imgui.EndChild()
			end
				
			if show_item.v == 3 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true)
					imgui.Columns(3)
					imgui.SetColumnWidth(-1, 100)
					imgui.NextColumn()
					imgui.SetColumnWidth(-1, 70)
					imgui.NextColumn()
					imgui.SetColumnWidth(-1, 330)
					for i, val in pairs(commands) do
						local cmd, lvl, info = string.match(val, '(.+) | (.+) | (.+)')
						imgui.Separator()
						imgui.NextColumn()
						imgui.TextColoredRGB(string.format('%s', cmd))
						imgui.NextColumn()
						imgui.TextColoredRGB(string.format('%s', lvl))
						imgui.NextColumn()
						imgui.TextColoredRGB(string.format('%s', info))
					end
				imgui.EndChild()
			end
				
			if show_item.v == 4 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true, imgui.WindowFlags.HorizontalScrollbar)
					draw_another_custom_command()
				imgui.EndChild()
			end
			
			if show_item.v == 5 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true)
					imgui.CenterTextColoredRGB('КАСТОМИЗАЦИЯ')
					imgui.Text('')
					
					if imgui.Button(u8'Сохранить и применить новые значения', imgui.ImVec2(515, 25)) then
						inicfg.save(ini, 'Helper for MIA.ini')
						apply_custom_style()
					end
					imgui.Text('')
					
					draw_customization()
				imgui.EndChild()
			end
			
			if show_item.v == 6 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true)
					imgui.CenterTextColoredRGB('МЕНЕДЖЕР ПАРОЛЕЙ')
					local servers = {'RED', 'GREEN', 'BLUE'}
					
					imgui.Text('')
					
					if spypass.v then
						if imgui.Button(u8'Включить отображение паролей', imgui.ImVec2(515, 25)) then
							spypass.v = false
						end
					else
						if imgui.Button(u8'Скрыть отображение паролей', imgui.ImVec2(515, 25)) then
							spypass.v = true
						end
					end
					
					imgui.Text('')
					
					for i, val in pairs(servers) do
						local sname = string.lower(val)
						for name, apass in pairs(pass[sname]) do
							local test = pass[sname][name]
							if test:find('%S+') then
								if spypass.v then
									imgui.Button(string.format(u8'%s • Имя [%s] • Пароль [%s]', val, name, string.gsub(apass, '.', '*')), imgui.ImVec2(515, 20))
								else
									imgui.Button(string.format(u8'%s • Имя [%s] • Пароль [%s]', val, name, apass), imgui.ImVec2(515, 20))
								end
							end
						end
					end
				imgui.EndChild()
			end
				
			if show_item.v == 7 then
				imgui.BeginChild('##another_block', imgui.ImVec2(530, 520), true, imgui.WindowFlags.HorizontalScrollbar)
					imgui.CenterTextColoredRGB('ГОСУДАРСТВЕННЫЕ НОВОСТИ')
					
					imgui.Text('')
					
					imgui.Text(u8'ID-новости ')
					
					imgui.SameLine()
					
					imgui.PushItemWidth(80)
					imgui.InputText('##id_news', idnews)
					ItemPovered('Введите в это окно ID новости, которую хотите найти или создать.')
					
					imgui.SameLine()
					
					if imgui.Button(u8'Найти', imgui.ImVec2(115, 20)) then
						if string.match(idnews.v, '(%d+)') then
							if doesFileExist(string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)) then
								pushMessage('Новость найдена и открыта для настройки', 3, 4)
							
								for val in io.lines(string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)) do
									if string.match(val, 'type=(%d+)') then
										local ntype = string.match(val, 'type=(%d+)')
										if tonumber(ntype) == 3 then lines.v = true else lines.v = false end
									elseif string.match(val, 'line(%d+)=(.+)') then
										local line, text = string.match(val, 'line(%d+)=(.+)')
										if tonumber(line) <= 3 then
											if tonumber(line) == 1 then pgline1.v = u8(text) end
											if tonumber(line) == 2 then pgline2.v = u8(text) end
											if tonumber(line) == 3 then pgline3.v = u8(text) end
										elseif tonumber(line) == 4 then
											pgaline1.v = u8(text)
										end
									end
								end
							else
								pushMessage('Новости с данным ID не существует', 3, 3)
							end
						else
							pushMessage('Не указан ID-новости или он некорректен', 3, 3)
						end
					end
					ItemPovered('С помощь этой кнопки вы можете найти уже созданную гос. новость.')
					
					imgui.SameLine()
					
					if imgui.Button(u8'Создать', imgui.ImVec2(120, 20)) then
						if string.match(idnews.v, '(%d+)') then
							if not doesFileExist(string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)) then
								pushMessage('Новость создана и открыта для настройки', 3, 4)
								
								local file = string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)
								local filew = io.open(file, 'w')
								filew:write('type=1')
								filew:close()
								
								lines.v = false
							end
						else
							pushMessage('Не указан ID-новости или он некорректен', 3, 3)
						end
					end
					ItemPovered('С помощь этой кнопки вы можете создать новую гос. новость.')
					
					imgui.SameLine()
					
					if imgui.Button(u8'Сохранить', imgui.ImVec2(115, 20)) then
						if string.match(idnews.v, '(%d+)') then
							if doesFileExist(string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)) then
								local file = string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)
								local filew = io.open(file, 'w')
								if lines.v then
									filew:write(string.format('type=3\nline1=%s\nline2=%s\nline3=%s', u8:decode(pgline1.v), u8:decode(pgline2.v), u8:decode(pgline3.v)))
								else
									filew:write(string.format('type=1\nline4=%s', u8:decode(pgaline1.v)))
								end
								filew:close()
								
								pushMessage('Новость успешно сохранена', 3, 4)
							else
								pushMessage('Новости с данным ID не существует', 3, 3)
							end
						else
							pushMessage('Не указан ID-новости или он некорректен', 3, 3)
						end
					end
					ItemPovered('С помощь этой кнопки вы можете сохранить созданую гос. новость.')
					
					if lines.v then
						if imgui.Button(u8'Изменить на 1 строку', imgui.ImVec2(515, 20)) then lines.v = not lines.v end
					else
						if imgui.Button(u8'Изменить на 3 строки', imgui.ImVec2(515, 20)) then lines.v = not lines.v end
					end
					ItemPovered('С помощью этой кнопки вы сможете выбрать сколько строк будет в гос. новости.')
					
					imgui.Text('')
					
					imgui.Separator()
					
					imgui.Text('')
					
					imgui.CenterTextColoredRGB('НАСТРОЙКА СТРОК ГОС. НОВОСТИ')
					
					imgui.Text('')
					
					imgui.PushItemWidth(450)
					if lines.v then
						imgui.InputText(u8'1-я строка ##gnews1', pgline1)
						imgui.InputText(u8'2-я строка ##gnews2', pgline2)
						imgui.InputText(u8'3-я строка ##gnews3', pgline3)
					else
						imgui.InputText(u8'Строка ##gnews1', pgaline1)
					end
					
					imgui.Text('')
					
					imgui.Separator()
					
					imgui.Text('')
					
					imgui.CenterTextColoredRGB('РЕЗУЛЬТАТ')
					
					imgui.Text('')
					
					if lines.v then
						imgui.CenterTextColoredRGB(string.format('{4466CC}%s', u8:decode(pgline1.v)))
						imgui.CenterTextColoredRGB(string.format('{4466CC}%s', u8:decode(pgline2.v)))
						imgui.CenterTextColoredRGB(string.format('{4466CC}%s', u8:decode(pgline3.v)))
					else
						imgui.CenterTextColoredRGB(string.format('{4466CC}%s', u8:decode(pgaline1.v)))
					end
				imgui.EndChild()
			end
		imgui.End()
		
		if show_help.v then
			local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
			local info_function = {'ФУНКЦИИ | ОПИСАНИЕ / ПРИМЕР | РЕЗУЛЬТАТ',
				'{name} | Имя и фамилия | ' .. ini.info.name,
				'{rang} | Должность | ' .. ini.info.rang,
				'{frac} | Подразделение | ' .. ini.info.frac,
				'{number} | Личный номер | №000' .. ini.info.number,
				'{rteg} | Префикс в рацию | ' .. ini.info.rteg,
				'{fteg} | Префикс в общую волну | ' .. ini.info.fteg,
				'{mark} | Маркировка юнита | ' .. sampGetMarkCharByVehicle(PLAYER_PED),
				'{myid} | Ваш ID | ' .. id,
				'{hello} | Приветствие | ' .. sampGetHelloByTime(),
				'{area} | Район | '.. calculateZone(),
				'{kvadrat} | Квадрат на карте | ' .. kvadrat(),
				'{time} | Текущее время | ' .. os.date('%X'),
				'{date} | Текущая дата | ' .. os.date('%x'),

				'getPlayerName_{param} | getPlayerName_{param2} | <Имя игрока>',
				'getPlayerFraction_{param} | getPlayerFraction_{param2} | <Организация игрока>',
				'getPlayerColor_{param} | getPlayerColor_{param2} | <Цвет клиста игрока>',
				'getPlayerPing_{param} | getPlayerPing_{param2} | <Пинг игрока>',
				'getPlayerScore_{param} | getPlayerScore_{param2} | <Уровень игрока>',
				
				'sendChat(text) | Сообщение в обычный чат | <Сообщение>',
				'setChatInput(text) | Сообщение в чат без отправки | <Сообщение>',
				'addChat(text) | Серв. сообщение | <Сообщение>',
				'wait(delay) | Задержка | <Задержка>',
				'setKeyDown(key[, bool]) | Нажатие клавиши KEY | <Нажатие клавиши>'
			}
			
			imgui.SetNextWindowSize(imgui.ImVec2(550, 430))
			imgui.Begin(u8'ФУНКЦИИ | HELPER FOR MIA', show_help, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
				for i, val in pairs(info_function) do
					local f, i, r = string.match(val, '(.+) | (.+) | (.+)')
					if f ~= nil and i ~= nil and r ~= nil then
						imgui.Separator()
						if f ~= 'ФУНКЦИИ' then 
							if imgui.Button(u8(f), imgui.ImVec2(170, 20)) then
								setClipboardText(f)
							end
							ItemPovered('Copy value')
						else
							imgui.Text(string.format('%s', u8(f)))
						end
						imgui.SameLine(200)
						imgui.Text(string.format('%s', u8(i)))
						imgui.SameLine(390)
						imgui.Text(string.format('%s', u8(r)))
					end
				end
			imgui.End()
		end
	end
	
	if show_suspect.v then
		local w, h = getScreenResolution()
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(600, 550))
		
		draw_show_suspect()
	end
	
	if show_uk_list.v then
		local w, h = getScreenResolution()
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(600, 550))
		
		draw_uk_list()
	end
	
	if show_info.v then
		imgui.SetNextWindowSize(imgui.ImVec2(900, 460))
		imgui.Begin(u8'All info', show_info, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
			imgui.BeginChild('##enter_info', imgui.ImVec2(150, 420), true, imgui.WindowFlags.VerticalScrollbar)
				if imgui.Button('Players', imgui.ImVec2(130, 20)) then show_item.v = 0 end
				if imgui.Button('Vehicles', imgui.ImVec2(130, 20)) then show_item.v = 1 end
				if imgui.Button('Fraction', imgui.ImVec2(130, 20)) then show_item.v = 2 end
				if imgui.Button('Chat', imgui.ImVec2(130, 20)) then show_item.v = 3 end
			imgui.EndChild()
			imgui.SameLine()

			if show_item.v == 0 then
				imgui.BeginChild('##info_stream', imgui.ImVec2(730, 420), true, imgui.WindowFlags.VerticalScrollbar)
				imgui.CenterTextColoredRGB(sampGetPlayerCount(true) .. ' of ' .. sampGetPlayerCount(false) .. ' players on a stream')
				for i, val in pairs(getAllChars()) do
					if doesCharExist(val) then
						res , id = sampGetPlayerIdByCharHandle(val)
						if res then
							imgui.BeginChild('##info_player' .. i, imgui.ImVec2(710, 30), true, imgui.WindowFlags.VerticalScrollbar)
								if sampIsPlayerPaused(id) then afk = '{ff0000}* ' else afk = '{00ff00}* ' end
								imgui.TextColoredRGB(afk .. '{' .. string.gsub(sampGetColor(id), 'FFFFFF', '828282') .. '}' .. sampGetPlayerNickname(id) .. '{828282}[' .. id .. ']' .. ' HP[{FA8072}' .. sampGetPlayerHealth(id) .. '{828282}] ARM[{8B7E66}' .. sampGetPlayerArmor(id) .. '{828282}] WEAP[{6495ED}' .. getCurrentCharWeapon(val) .. '{828282}] DIST[{4876FF}' .. math.floor(sampGetDistance(PLAYER_PED, id)) .. '{828282}] SPEED[{6495ED}' .. math.floor(getCharSpeed(val) * 2.02) .. '{828282}] CAR[{6495ED}' .. isPlayerCar(val) .. '{828282}] PING[{9ACD32}' .. sampGetPlayerPing(id) ..'{828282}] SCORE[{FFD700}' .. sampGetPlayerScore(id) .. '{828282}] ANIM[' .. sampGetPlayerAnimationId(id) .. ']')
							imgui.EndChild()
						end
					end
				end
				imgui.EndChild()
			end

			if show_item.v == 1 then
				imgui.BeginChild('##info_stream', imgui.ImVec2(730, 420), true, imgui.WindowFlags.VerticalScrollbar)
					imgui.Checkbox('Filter out the empty car', vfilt)
					for i, val in pairs(getAllVehicles()) do
						if doesVehicleExist(val) then
							id = getCarModel(val)
							if id ~= nil then
									ped = getDriverOfCar(val)
									local res, pid = sampGetPlayerIdByCharHandle(ped)
									local _, sid = sampGetVehicleIdByCarHandle(val)
									if sampIsPlayerPaused(pid) then afk = '{ff0000}* ' else afk = '{00ff00}* ' end
									if vfilt.v then
										if ped ~= nil and res then
											imgui.BeginChild('##info_cars' .. i, imgui.ImVec2(710, 30), true, imgui.WindowFlags.VerticalScrollbar)
												imgui.TextColoredRGB('{828282}' .. getNameOfVehicleModel(id) .. '[' .. id .. '][' .. sid .. '] HP[{FA8072}' .. getCarHealth(val) .. '{828282}] SPEED[{6495ED}' .. math.floor(getCarSpeed(val) * 2.02) .. '{828282}] • {' .. sampGetColor(pid) .. '}' .. sampGetPlayerNickname(pid) .. '[' .. pid .. ']{828282} ' .. afk)
											imgui.EndChild()
										end
									else
										if ped ~= nil and res then drv = '{' .. sampGetColor(pid) .. '}' .. sampGetPlayerNickname(pid) .. '[' .. pid .. ']{828282}' else drv = 'No driver' end
										imgui.BeginChild('##info_cars' .. i, imgui.ImVec2(710, 30), true, imgui.WindowFlags.VerticalScrollbar)
											imgui.TextColoredRGB('{828282}' .. getNameOfVehicleModel(id) .. '[' .. id .. '][' .. sid .. '] HP[{FA8072}' .. getCarHealth(val) .. '{828282}] SPEED[{6495ED}' .. math.floor(getCarSpeed(val) * 2.02) .. '{828282}] • ' .. drv)
										imgui.EndChild()
									end
							end
						end
					end
				imgui.EndChild()
			end

			if show_item.v == 2 then
				imgui.BeginChild('##info_stream', imgui.ImVec2(250, 420), true, imgui.WindowFlags.VerticalScrollbar)
					local online = sampGetOnlineInFraction()
					for i, val in pairs(frac.name) do
						if imgui.Button(u8(frac.fullname[i] .. ' [' .. online[val].all .. ']'), imgui.ImVec2(230, 20)) then
							show_player = 'Список игроков: '
							for i, val in pairs(online[val].player) do
								show_player = string.format('%s\n%d. %s[%d]', show_player, i, sampGetPlayerNickname(val), val)
							end
						end
					end
				imgui.EndChild()
				
				imgui.SameLine()
				
				imgui.BeginChild('##info_player', imgui.ImVec2(475, 420), true, imgui.WindowFlags.VerticalScrollbar)
					imgui.TextColoredRGB(show_player)
				imgui.EndChild()
			end
			
			if show_item.v == 3 then
				imgui.BeginChild('##info_logs', imgui.ImVec2(730, 420), true, imgui.WindowFlags.HorizontalScrollbar)
					
					local maxpage = math.floor(table.maxn(logchat) / 21)
					
					if imgui.Button(u8'Очистить') then 
						logchat = nil
						logchat = {} 
						page_num.v = 0
					end
					
					imgui.SameLine()
					
					if imgui.Button('<<') then
						page_num.v = 0
					end
					
					imgui.SameLine()
					
					if imgui.Button('<') then
						if page_num.v > 0 then
							page_num.v = page_num.v - 1
						end
					end
					
					imgui.SameLine()
					
					imgui.Button(string.format(u8'[стр. %d из %d]', page_num.v, maxpage))
						
					imgui.SameLine()
					
					if imgui.Button('>') then
						if page_num.v < maxpage then
							page_num.v = page_num.v + 1
						end
					end
					
					imgui.SameLine()
					
					if imgui.Button('>>') then
						page_num.v = maxpage
					end
					
					for i, val in pairs(logchat) do
						if (i <= page_num.v * 21 + 21) and (i >= page_num.v * 21) then
							imgui.TextColoredRGB(string.gsub(val, '{.+}', ''))
						end
					end
				imgui.EndChild()
			end
		imgui.End()
	end

	if piemenu.v then
		local w, h = getScreenResolution()
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
	
        imgui.OpenPopup('PieMenu')
        if pie.BeginPiePopup('PieMenu', 0) then
		
			if targetid ~= nil then
				if IPC(targetid) then
					if pie.BeginPieMenu(u8'player') then
						if pie.PieMenuItem(u8'pass') then
							sampSendChat('/pass ' .. targetid)
							piemenu.v = not piemenu.v
						end
						
						if pie.PieMenuItem(u8'licenses') then
							sampSendChat('/lic ' .. targetid)
							piemenu.v = not piemenu.v
						end
						
						if pie.PieMenuItem(u8'wbook') then
							sampSendChat('/wbook ' .. targetid)
							piemenu.v = not piemenu.v
						end
						
						if pie.PieMenuItem(u8'history') then
							command_history(targetid)
							piemenu.v = not piemenu.v
						end
						
						if pie.PieMenuItem(u8'allow') then
							sampSendChat('/allow ' .. targetid)
							piemenu.v = not piemenu.v
						end
						pie.EndPieMenu()
					end

					if pie.BeginPieMenu(u8'leader') then
						if pie.BeginPieMenu(u8'invite') then
							for i = 1, 9 do
								if pie.PieMenuItem(i .. ' rang') then
									command_invite(targetid .. ' ' .. i)
									piemenu.v = not piemenu.v
								end
							end
							pie.EndPieMenu()
						end
						
						if pie.BeginPieMenu(u8'rang') then
							if pie.PieMenuItem(u8'plus') then
								command_rang(targetid .. ' +')
								piemenu.v = not piemenu.v
							end
							
							if pie.PieMenuItem(u8'minus') then
								command_rang(targetid .. ' -')
								piemenu.v = not piemenu.v
							end
							pie.EndPieMenu()
						end
						
						if pie.PieMenuItem(u8'changeskin') then
							command_changeskin(targetid)
							piemenu.v = not piemenu.v
						end
						
						if pie.PieMenuItem(u8'black list') then
							command_bl(sampGetPlayerNickname(targetid))
							piemenu.v = not piemenu.v
						end
						pie.EndPieMenu()
					end
					
					if pie.BeginPieMenu(u8'suspect') then
						if pie.PieMenuItem(u8'cuff') then
							command_cuff(targetid)
							piemenu.v = not piemenu.v
						end
						
						if pie.PieMenuItem(u8'uncuff') then
							command_uncuff(targetid)
							piemenu.v = not piemenu.v
						end
						
						if pie.PieMenuItem(u8'hold') then
							command_hold(targetid)
							piemenu.v = not piemenu.v
						end
						
						if pie.PieMenuItem(u8'putpl') then
							command_putpl(targetid)
							piemenu.v = not piemenu.v
						end
						
						pie.EndPieMenu()
					end
				else
					SCM('Игрок, с которым вы хотели взаимодействовать, покинул игру.')
					piemenu.v = not piemenu.v
				end
			else
				if pie.PieMenuItem(u8'mn') then
					sampSendChat('/mn')
					piemenu.v = not piemenu.v
				end
				
				if pie.PieMenuItem(u8'rights') then
					command_rights()
					piemenu.v = not piemenu.v
				end
				
				if pie.PieMenuItem(u8'follow') then
					command_follow()
					piemenu.v = not piemenu.v
				end
				
				if pie.PieMenuItem(u8'find') then
					sampSendChat('/find')
					piemenu.v = not piemenu.v
				end
			end
			pie.EndPiePopup()
        end
    end
end

function draw_new_dialog()
	imgui.Text('')

	if imgui.Checkbox(u8'Улучшенный диалог списка лидеров (/leaders)', pnew_leaders) then 
		ini.set.new_leaders = pnew_leaders.v
		inicfg.save(ini, 'Helper for MIA.ini') 
	end
	if imgui.Checkbox(u8'Улучшенный диалог списка участников группы (/group)', pnew_group) then 
		ini.set.new_group = pnew_group.v
		inicfg.save(ini, 'Helper for MIA.ini') 
	end
	if imgui.Checkbox(u8'Улучшенный диалог списка сотрудников (/find)', pnew_find) then 
		ini.set.new_find = pnew_find.v
		inicfg.save(ini, 'Helper for MIA.ini') 
	end
	if imgui.Checkbox(u8'Улучшенный диалог списка преступников (/wanted)', pnew_wanted) then 
		ini.set.new_wanted = pnew_wanted.v
		inicfg.save(ini, 'Helper for MIA.ini') 
	end
	if imgui.Checkbox(u8'Улучшенный диалог отображения точного времени (/c 60)', pnew_clock) then 
		ini.set.new_clock = pnew_clock.v
		inicfg.save(ini, 'Helper for MIA.ini') 
	end
end

function draw_another_settings()
	imgui.Text('')
						
	imgui.PushItemWidth(200)
	if imgui.SliderInt('##ITEM', pdelay_rk, 0, 30) then
		ini.set.delay_rk = pdelay_rk.v
		inicfg.save(ini, 'Helper for MIA.ini')
	end
	
	imgui.SameLine(220)
	imgui.Text(u8'Задержка, установленная для RK')
	
	imgui.PushItemWidth(200)
	if imgui.SliderInt('##ITEM2', strob_lr, 300, 600) then
		ini.set.strob_lr = strob_lr.v
		inicfg.save(ini, 'Helper for MIA.ini')
	end

	imgui.SameLine(220)
	imgui.Text(u8'Задержка между работой поворотников')
	
	if imgui.InputText(u8'Ссылка на чёрный список', url_bl) then
		ini.set.blacklist = url_bl.v
		inicfg.save(ini, 'Helper for MIA.ini') 
	end
						
	if imgui.Checkbox(u8'Сообщение в рацию при использовании мегафона (погоня / пешая погоня)', pmessage_megafon) then 
		ini.set.message_megafon = pmessage_megafon.v
		inicfg.save(ini, 'Helper for MIA.ini') 
	end
						
	if ini.lowrp.rpmask then
		if imgui.Checkbox(u8'Сообщение в /do о наличие маски при снятие её системой', punmask) then 
			ini.lowrp.unmask = punmask.v
			inicfg.save(ini, 'Helper for MIA.ini') 
		end
	end
end

function draw_uk_list()
	imgui.Begin(u8'Уголовный кодекс • Helper for MIA', show_uk_list, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
		for name, val in pairs(smart_suspect.text) do
			if imgui.TreeNode(string.format(u8'СТАТЬЯ %d | %s', name, u8(val.name))) then
				for i, item in ipairs(val.st) do
					if string.match(item, '(.+) | (.+) | (.+)') then
						local stars, reason, text = string.match(item, '(.+) | (.+) | (.+)')
							
						imgui.Button(string.format('%s | %d | %s..', u8(reason), stars, string.sub(u8(text), 0, 120)), imgui.ImVec2(540, 20))
						if (imgui.IsItemHovered()) then
							imgui.SetTooltip(u8(text))
						end
					else 
						imgui.Text('Unexpected line.')
					end
				end
				imgui.TreePop()
			end
		end
	imgui.End()
end

function draw_show_suspect()
	local id = smart_suspect.id
	if IPC(id) then
		imgui.Begin(string.format(u8'Объявление в розыск %s [%d]', sampGetPlayerNickname(id), id), show_suspect, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
			for name, val in pairs(smart_suspect.text) do
				if imgui.TreeNode(string.format(u8'СТАТЬЯ %d | %s', name, u8(val.name))) then
					for i, item in ipairs(val.st) do
						if string.match(item, '(.+) | (.+) | (.+)') then
							local stars, reason, text = string.match(item, '(.+) | (.+) | (.+)')
							
							if imgui.Button(string.format('%s | %d | %s..', u8(reason), stars, string.sub(u8(text), 0, 120)), imgui.ImVec2(540, 20)) then
								command_su(string.format('%d %d %s', id, stars, reason))
							end
							ItemPovered(text)
						else 
							imgui.Text('Unexpected line.')
						end
					end
					imgui.TreePop()
				end
			end
		imgui.End()
	else
		SCM('Подозревамый пропал из зоны видимости.')
		show_suspect.v = not show_suspect.v
	end
end

function draw_modification()
	imgui.Text('')

	if imgui.TreeNode(u8'Уличные фонари') then
		if imgui.Checkbox(u8'Включить отображение уличных фонарей в указанное время', pstreetlight) then 
			ini.set.streetlight = pstreetlight.v
			inicfg.save(ini, 'Helper for MIA.ini') 
		end
		
		imgui.PushItemWidth(200)
		if imgui.SliderInt('##ITEM1', pslhour, 0, 23) then
			ini.set.slhour = pslhour.v
			inicfg.save(ini, 'Helper for MIA.ini') 
		end
		imgui.SameLine() imgui.Text(u8'Время включения уличных фонарей')
		
		if imgui.SliderInt('##ITEM2', pmslhour, 0, 23) then
			ini.set.mslhour = pmslhour.v
			inicfg.save(ini, 'Helper for MIA.ini') 
		end
		imgui.SameLine() imgui.Text(u8'Время отключения уличных фонарей')
		
		imgui.TreePop()
	end
	
	if imgui.TreeNode(u8'Модицированный CamHack') then
		if imgui.Checkbox(u8'Включить отображение эффектов при использовании CamHack`a', pkvadrocopter) then 
			ini.set.kvadrocopter = pkvadrocopter.v
			inicfg.save(ini, 'Helper for MIA.ini') 
		end
		
		imgui.TreePop()
	end
end

function draw_hotkey_settings()
	imgui.Text('')
	imgui.CenterTextColoredRGB('ИЗМЕНЕНИЕ ГОРЯЧИХ КЛАВИШ')
	
	imgui.Text('')
	
	for name in pairs(ini.hkey) do
		if imgui.HotKey('##' .. name, hotkey_butt[name].key, hotkey_butt[name].last, 100) then
			if not rkeys.isHotKeyDefined(hotkey_butt[name].key.v) then
				rkeys.changeHotKey(hotkey_butt[name].bind, hotkey_butt[name].key.v)
				
				local key = ' '
				for _, val in pairs(hotkey_butt[name].key.v) do
					key = string.format('%s, %s', key, val)
				end
				
				ini.hkey[name] = string.gsub(key, '%s,%s', '')
				inicfg.save(ini, 'Helper for MIA.ini')
				pushMessage('Для этой команды установленно новое сочетание клавиш.', 3, 4)
			else
				hotkey_butt[name].key = hotkey_butt[name].last
				pushMessage('Данное сочетание клавиш уже используется.', 3, 3)
			end
		end
		imgui.SameLine()
		imgui.Text(u8(hotkey_butt[name].name))
	end
end

function draw_commands_settings()
	imgui.Text('')
	imgui.CenterTextColoredRGB('ИЗМЕНЕНИЕ КОМАНД')
	
	imgui.Text('')
	
	imgui.BeginChild('##first_block', imgui.ImVec2(120, 170), true)
		imgui.PushItemWidth(110)
		if imgui.ListBox('##cmdid', commandid, command_t, 7) then end
	imgui.EndChild()
	
	imgui.SameLine()
	
	imgui.BeginChild('##second_block', imgui.ImVec2(400, 170), true)
		imgui.TextColoredRGB(string.format('{EEEEEE}Команда, выбранная для редактирования: {B22222}%s', command_t[commandid.v + 1]))
		
		local c, cu = string.match(ini.cmd[command_t[commandid.v + 1]], '(.+) | (.+)')
		
		imgui.PushItemWidth(385)
		imgui.Text(u8'Команда активации (команда скрипта)')
		ShowHelpMarker('Например, при вводе /cuff происходит выполнение отыгровки.')
		imgui.InputText('##cmdinp', cmdinp)
		imgui.Text(u8'Команда, использующиеся сервером (команда сервера)')
		ShowHelpMarker('Например, при вводе /cuff происходит выполнение отыгровки и после этого вводится серверная команда /cuff, которую и нужно тут указать.')
		if cu == '-1' then
			imgui.Button(u8'Не изменяется', imgui.ImVec2(400, 20))
		else
			imgui.InputText('##cmduse', cmduse)
		end
		
		if imgui.Button(u8'Сохранить', imgui.ImVec2(400, 20)) then
			if cmdinp.v ~= '' and (cmduse.v ~= '' or cu == '-1') then
				if cu ~= '-1' then
					ini.cmd[command_t[commandid.v + 1]] = string.format('%s | %s', u8:decode(cmdinp.v), u8:decode(cmduse.v))
				else
					ini.cmd[command_t[commandid.v + 1]] = string.format('%s | -1', u8:decode(cmdinp.v))
				end
				inicfg.save(ini, 'Helper for MIA.ini')
				
				pushMessage('Команда успешно сохранена. Изменения вступят в силу после перезагрузки.', 5, 4)
			else
				pushMessage('Поля должны быть заполнены.', 3, 3)
			end
		end
	imgui.EndChild()
end 

function draw_head_page()
	imgui.CenterTextColoredRGB('ГЛАВНАЯ СТРАНИЦА')
	
	imgui.Text('')
	
	if not communication_page then head_page_text = 'СВЯЗЬ С РАЗРАБОТЧИКОМ' else head_page_text = 'ВЕРНУТЬСЯ НА ГЛАВНУЮ СТРАНИЦУ' end
	if imgui.Button(u8(head_page_text), imgui.ImVec2(510, 20)) then
		communication_page = not communication_page
	end
	
	
	if not communication_page then
		imgui.Text('')
		
		imgui.BeginChild('##Update_Info', imgui.ImVec2(510, 150), true)
			
			imgui.CenterTextColoredRGB('{FFA54F}ИНФОРМАЦИЯ О ОБНОВЛЕНИИ')
			
			imgui.Text(u8'Добавлена смена режимов CamHack`a на клавишу O.')
			imgui.Text(u8'Добавлены поворотники для автомобилей, активация B и M.')
			imgui.Text(u8'Добавлен раздел модификаций в расширенных настройках.')
			imgui.Text(u8'Добавлена возможность использовать уличные фонари и эффекты для CamHack`a.')
			imgui.Text(u8'Добавлена возможность использовать умный розыск с помощь /su id.')
			imgui.Text(u8'Изменена система параметров для допополнительных команд.')
			imgui.Text(u8'Была добавлена возможность активировать доп. команды с помощью клавиш.')
			
		imgui.EndChild()
		
		
		
		imgui.BeginChild('##Another_Info', imgui.ImVec2(510, 270), true)
			
			imgui.CenterTextColoredRGB('{FFA54F}ПОЛЕЗНАЯ ИНФОРМАЦИЯ')
			
			imgui.Text(u8'Полезная информация будет доступна чуть позже.')
			
		imgui.EndChild()
	else
		imgui.Text('')
		imgui.TextColoredRGB('Вы можете сообщить о недаработке (баге) или предложить какое-либо улучешние.')
		imgui.TextColoredRGB('Если в скрипте происходит какая-то ошибка и он вылетает, то укажите ошибку..')
		imgui.TextColoredRGB('.. которая появляется в консоли (~ или Ё) и напишите, что использовали перед этим.')
		imgui.TextColoredRGB('Ошибка имеет префикс (error), который подсвечен красным цветом.')
		imgui.TextColoredRGB('Не стоит оффтопить и писать просто так.')
		imgui.Text('')
		imgui.TextColoredRGB('• Discord') imgui.SameLine(80) if imgui.Button('Skezz Perry#2705') then setClipboardText('Skezz Perry#2705') end
		ShowHelpMarker('Copy discord')
		imgui.TextColoredRGB('• VK') imgui.SameLine(80) if imgui.Button('vk.com/skezzhkg') then setClipboardText('vk.com/skezzhkg') end
		ShowHelpMarker('Copy VK')
		imgui.Text('')

		if imgui.Button(u8'Отправить', imgui.ImVec2(510, 20)) then
			local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
			local name = sampGetPlayerNickname(id)

			tovk(string.format(u8'-m\n%s\n(id %d ~ rang %d) %s ~ %s\n-m', u8(sampGetCurrentServerName()), id, player_status, name, inpcomment.v), true)
			inpcomment.v = ''
		end

		imgui.InputTextMultiline('##com_com', inpcomment, imgui.ImVec2(-1, imgui.GetTextLineHeight() * 6))
	end
end

function getStateCommand(name)
	if name_cmd.v ~= nil and name_cmd.v ~= '' then
		local path = string.format('moonloader//helper//commands//%s.txt', name)
		
		if doesFileExist(path) then
			if command_open ~= nil and command_open == path then
				return '{32CD32} (доступна для редактирования)'
			else 
				return '{FFD700} (доступна для редактирования)'
			end
		else
			return '{CD5C5C} (недоступна для редактирования)'
		end
	else
		return '{FFD700} (ожидание ввода)'
	end
end

function draw_another_custom_command()
	imgui.CenterTextColoredRGB('ДОПОЛНИТЕЛЬНЫЕ ВОЗМОЖНОСТИ')
	
	imgui.Text('')
	
	imgui.Text(u8'Название команды: ') imgui.SameLine() imgui.PushItemWidth(170)
	if imgui.InputText('', name_cmd) then
		local path = string.format('moonloader//helper//commands//%s.txt', u8:decode(name_cmd.v))
		if command_open ~= path then command_open = '' end
	end imgui.SameLine()
	imgui.TextColoredRGB(getStateCommand(name_cmd.v))
	if command_hotkey then
		draw_new_custom_hotkey()
	end
	
	if imgui.Button(u8'Найти или создать', imgui.ImVec2(170, 20)) then
		if name_cmd.v ~= nil and name_cmd.v ~= '' then
			if not sampIsChatCommandDefined(u8:decode(name_cmd.v)) then
				local path = string.format('moonloader//helper//commands//%s.txt', u8:decode(name_cmd.v))
				
				if doesFileExist(path) then
					local cmd_text = ''
					for line in io.lines(path) do
						if string.match(line, '{param = (%d+)}') then
							param_cmd = tonumber(string.match(line, '{param = (%d+)}'))
						else 
							cmd_text = string.format('%s%s\n', cmd_text, u8(line))
						end
					end
					text_cmd.v = cmd_text
					command_open = path
					
					pushMessage('Команда найдена и открыта для настройки', 3, 4)
				elseif not doesFileExist(path) then
					local filew = io.open(path, 'w')
					filew:write('')
					filew:close()
					
					param_cmd = 0
					text_cmd.v = u8'Новая команда'
					command_open = path
					
					pushMessage('Была создана новая команда.', 3, 4)
				end
			else
				pushMessage('Данная команда уже используется скриптом.', 3, 3)
			end
		else
			pushMessage('Не введено название команды.', 3, 3)
		end
	end
	imgui.SameLine()
	if imgui.Button(u8'Сохранить', imgui.ImVec2(160, 20)) then
		if name_cmd.v ~= nil and name_cmd.v ~= '' then
			if not sampIsChatCommandDefined(u8:decode(name_cmd.v)) then
				local path = string.format('moonloader//helper//commands//%s.txt', u8:decode(name_cmd.v))
				
				if doesFileExist(path) and command_open == path then
					local filew = io.open(path, 'w')
					local save_text = string.format('{param = %d}\n%s', param_cmd, text_cmd.v)
					filew:write(u8:decode(save_text))
					filew:close()
					
					pushMessage('Команда успешно сохранена.', 3, 4)
				else
					pushMessage('Для начала нужно найти или создать команду.', 3, 3)
				end
			else
				pushMessage('Данная команда уже используется скриптом.', 3, 3)
			end	
		else
			pushMessage('Не введено название команды.', 3, 3)
		end
	end
	imgui.SameLine()
	if imgui.Button(u8'Очистить', imgui.ImVec2(170, 20)) then
		param_cmd, text_cmd.v, name_cmd.v, command_open = 0, '', '', ''
	end

	if imgui.Button(u8'Добавить', imgui.ImVec2(82, 20)) then if param_cmd < 3 then param_cmd = param_cmd + 1 end end
	ItemPovered('Количество параметров в команде: ' .. param_cmd)
	imgui.SameLine()
	if imgui.Button(u8'Убрать', imgui.ImVec2(83, 20)) then if param_cmd > 0 then param_cmd = param_cmd - 1 end end
	ItemPovered('Количество параметров в команде: ' .. param_cmd)
	
	imgui.SameLine()
	if imgui.Button(u8'Функции', imgui.ImVec2(160, 20)) then
		show_help.v = not show_help.v
	end
	imgui.SameLine()
	if imgui.Button(u8'Активация клавишами', imgui.ImVec2(170, 20)) then
		command_hotkey = not command_hotkey
	end

	imgui.Text('')
	if not edit_command_text then command_name_text = 'РЕДАКТИРОВАНИЕ' else command_name_text = 'РЕЗУЛЬТАТ' end
	if imgui.Button(u8(command_name_text), imgui.ImVec2(510, 20)) then
		edit_command_text = not edit_command_text
	end
	
	if not edit_command_text then
		imgui.PushItemWidth(515)
		if command_hotkey then command_number = 24 else command_number = 25 end
		imgui.InputTextMultiline('##TextForCmd', text_cmd, imgui.ImVec2(-1, imgui.GetTextLineHeight() * command_number))
	else
		imgui.Text(text_cmd.v)
	end
end

function draw_new_custom_hotkey()
	imgui.Text(u8'Клавиша(-и) активации: ') imgui.SameLine()

	if name_cmd.v ~= nil and name_cmd.v ~= '' then
		if ini.custom_hkey[u8:decode(name_cmd.v)] ~= nil then
			for id, val in pairs(hotkey_cust_butt) do
				if u8:decode(name_cmd.v) == val.name then
					if val.key.v ~= nil then
						if imgui.HotKey('##' .. val.name, hotkey_cust_butt[id].key, hotkey_cust_butt[id].last, 100) then
							if not rkeys.isHotKeyDefined(hotkey_cust_butt[id].key.v) then
								rkeys.changeHotKey(hotkey_cust_butt[id].bind, hotkey_cust_butt[id].key.v)
			
								local key = ' '
								for _, val in pairs(hotkey_cust_butt[id].key.v) do
									key = string.format('%s, %s', key, val)
								end
								
								ini.custom_hkey[val.name] = string.gsub(key, '%s,%s', '')
								inicfg.save(ini, 'Helper for MIA.ini')
								pushMessage('Для этой команды установленно новое сочетание клавиш.', 3, 4)
							else
								hotkey_cust_butt[id].key = hotkey_cust_butt[id].last
								pushMessage('Данное сочетание клавиш уже используется.', 3, 3)
							end
						end
					else
						imgui.TextColoredRGB('{CD5C5C}команда не имеет клавиш активации')
					end
				end
			end
		else
			if imgui.Button(u8'добавить активацию клавишами') then
				if not name_cmd.v:find('йцукенгшщзхъфывапролджэячсмитьбюЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ') then
					ini.custom_hkey[name_cmd.v] = -1
					table.insert(hotkey_cust_butt, {key = {v = {-1}}, last = {}, bind = -1, name = name_cmd.v})
					
					hotkey_cust_butt[#hotkey_cust_butt].bind = rkeys.registerHotKey(hotkey_cust_butt[#hotkey_cust_butt].key.v, true, function()
						if isKeyCheckAvailable() then
							process_command(hotkey_cust_butt[#hotkey_cust_butt].name)
						end
					end)
					
					inicfg.save(ini, 'Helper for MIA.ini')
				else
					pushMessage('Команда не должна быть на русском языке.', 3, 3)
				end
			end
		end
	else
		imgui.TextColoredRGB('{CD5C5C}недоступно для настройки')
	end
end

function draw_customization()
	for obj in pairs(ini.custom) do
		local color = imgui.ImFloat4(imgui.ImColor(ini.custom[obj]):GetFloat4())
		
		if imgui.ColorEdit4(obj, color) then
			local colors = imgui.ImColor.FromFloat4(color.v[1], color.v[2], color.v[3], color.v[4]):GetU32()
			ini.custom[obj] = colors
		end
		if descript_f[obj] ~= nil then
			ShowHelpMarker(descript_f[obj])
		else
			ShowHelpMarker('Пояснение не было добавлено.')
		end
	end
end

function register_custom_hotkey() 
	for name, val in pairs(ini.hkey) do
		for key in string.gmatch(val, '[^,%s]+') do
			table.insert(hotkey_butt[name].key.v, tonumber(key))
		end
	end
	
	local i_n = 0
	for name, val in pairs(ini.custom_hkey) do
		table.insert(hotkey_cust_butt, i_n, {key = {v = {}}, last = {}, bind = -1, name = name})
		for key in string.gmatch(val, '[^,%s]+') do
			table.insert(hotkey_cust_butt[i_n].key.v, tonumber(key))
		end
		
		i_n = i_n + 1
	end
end

function add_new_hotkey()
	for name, val in pairs(hotkey_cust_butt) do
		hotkey_cust_butt[name].bind = rkeys.registerHotKey(hotkey_cust_butt[name].key.v, true, function()
			if isKeyCheckAvailable() then
				process_command(hotkey_cust_butt[name].name)
			end
		end)
	end

	hotkey_butt['eat'].bind = rkeys.registerHotKey(hotkey_butt['eat'].key.v, true, function()
		if isKeyCheckAvailable() then
			sampSendChat('/eat')
		end
	end)
	
	hotkey_butt['menu'].bind = rkeys.registerHotKey(hotkey_butt['menu'].key.v, true, function()
		show_menu.v = not show_menu.v 
	end)
	
	hotkey_butt['open'].bind = rkeys.registerHotKey(hotkey_butt['open'].key.v, true, function()
		if isKeyCheckAvailable() then
			command_open()
		end
	end)
	
	hotkey_butt['smart_su'].bind = rkeys.registerHotKey(hotkey_butt['smart_su'].key.v, true, function()
		if suspect_id[1] ~= nil then
			if IPC(suspect_id[1]) then 
				command_su(string.format('%d %d %s', suspect_id[1], suspect_id[2], suspect_id[3])) 
			end
		end
	end)
		
	hotkey_butt['lock'].bind = rkeys.registerHotKey(hotkey_butt['lock'].key.v, true, function()
		if isKeyCheckAvailable() then
			sampSendChat('/lock 1')
		end
	end)
	
	hotkey_butt['camera'].bind = rkeys.registerHotKey(hotkey_butt['camera'].key.v, true, function()
		if ini.set.camera then
			if cActive then
				sampSendChat('/do На плечевой стропе установлена камера видеофиксации, камера не активна.')
			else
				sampSendChat('/do На плечевой стропе установлена камера видеофиксации, камера активна.')
			end
			cActive = not cActive
		end
	end)
	
	hotkey_butt['fast_menu'].bind = rkeys.registerHotKey(hotkey_butt['fast_menu'].key.v, true, function()
		if isKeyCheckAvailable() then
			local res, ped = getCharPlayerIsTargeting(PLAYER_HANDLE)
			if res then
				_, targetid = sampGetPlayerIdByCharHandle(ped)
				piemenu.v = not piemenu.v
			elseif piemenu.v then
				piemenu.v = false
			else
				targetid = nil
				piemenu.v = not piemenu.v
			end
		end
	end)
	
	hotkey_butt['strob_left'].bind = rkeys.registerHotKey(hotkey_butt['strob_left'].key.v, true, function()
		if isKeyCheckAvailable() then
			if isCharInAnyCar(playerPed) and ini.set.strobes then
				local car = storeCarCharIsInNoSave(playerPed)
				strobes_left = not strobes_left
				strobes_right = false
				local state = not isCarSirenOn(car)
				switchCarSiren(car, state)
			end
		end
	end)
	
	hotkey_butt['strob_right'].bind = rkeys.registerHotKey(hotkey_butt['strob_right'].key.v, true, function()
		if isKeyCheckAvailable() then
			if isCharInAnyCar(playerPed) and ini.set.strobes then
				local car = storeCarCharIsInNoSave(playerPed)
				strobes_right = not strobes_right
				strobes_left = false
				local state = not isCarSirenOn(car)
				switchCarSiren(car, state)
			end
		end
	end)
	
	hotkey_butt['onfoot_m'].bind = rkeys.registerHotKey(hotkey_butt['onfoot_m'].key.v, true, function()
		if ini.set.message_megafon then
			command_r(string.format('$m to DISP 10-57 F, 10-20 %s (%s), CODE: 3, nRFR, over **', calculateZone(), kvadrat()))
		else
			SCM('Для работы данной функции включите её в расширенных настройках.')
		end
	end)
	
	hotkey_butt['onvec_m'].bind = rkeys.registerHotKey(hotkey_butt['onvec_m'].key.v, true, function()
		lua_thread.create(function()
			local pid, id = sampGetNearestDriver()
			if id ~= -1 then
				local z, k = calculateZone(), kvadrat()
					
				sampSendChat('/m Внимание! Водитель ' .. tCarsName[id - 399] .. ' с номером ' .. pid .. '!')
				wait(1500)
				sampSendChat('/m Немедленно остановите транспортное средство и прижмитесь к обочине!')
				if ini.set.message_megafon then
					wait(1000)
					command_r(string.format('$m to DISP, 10-57 V за %s с номером %d, 10-20 %s (%s), CODE: 3, nRFR, over **', tCarsName[id - 399], pid, z, k))
				end
					
				if last_message.name == sampGetPlayerNickname(pid) then
					wait(1000)
					sampSendChat('/m В случае неподчинения будет открыт огонь на поражение!')
					wait(100)
					SCM(string.format('Чтобы объявить %s[%d] в розыск по статье 8.1 УК нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerNickname(pid), pid))
					suspect_id = {pid, 1, '8.1 УК', sampGetPlayerNickname(pid)}
				end
					
				last_message = {id = pid, name = sampGetPlayerNickname(pid)}
			else
				sampSendChat('/m Немедленно остановите транспортное средство и прижмитесь к обочине!')
			end
		end)
	end)
	
	hotkey_butt['camhack_off'].bind = rkeys.registerHotKey(hotkey_butt['camhack_off'].key.v, true, function()
		if isKeyCheckAvailable() then
			destroy_camhack()
		end
	end)
	
	hotkey_butt['camhack_on'].bind = rkeys.registerHotKey(hotkey_butt['camhack_on'].key.v, true, function()
		if isKeyCheckAvailable() then
			on_camhack()
		end
	end)
end

function on_camhack()
	if not flymode and isKeyCheckAvailable() then     
		posX, posY, posZ = getCharCoordinates(playerPed)
		angZ = getCharHeading(playerPed)
		angZ = angZ * -1.0
		setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
		angY = 0.0 
		lockPlayerControl(true)
		flymode = not flymode
		type_vision = 0
		color_infra, color_night = 0x88FFFFFF, 0x88FFFFFF
	end
end

function destroy_camhack()
	if flymode then
		radarHud = 0    
		angPlZ = angZ * -1.0
		lockPlayerControl(false)
		restoreCameraJumpcut()
		setCameraBehindPlayer()
		flymode = false
		setInfraredVision(false)
		setNightVision(false)
		type_vision = 0
		color_infra, color_night = 0x88FFFFFF, 0x88FFFFFF
	end
end

function patch_samp_time_set(enable) 
	if enable and default == nil then
		default = readMemory(sampGetBase() + 0x9C0A0, 4, true)
		writeMemory(sampGetBase() + 0x9C0A0, 4, 0x000008C2, true)
	elseif enable == false and default ~= nil then
		writeMemory(sampGetBase() + 0x9C0A0, 4, default, true)
		default = nil
	end
end

function isPlayerCar(ped)
	if isCharInAnyCar(ped) then
		local carid = getCarModel(storeCarCharIsInNoSave(ped))
		return carid
	else
		return 0
	end
end

function sampGetMarkCharByVehicle(ped)
	local _, id = sampGetPlayerIdByCharHandle(ped)
	local uid = 1
	if id < 50 then 
		uid = id 
	else
		uid = string.sub(tostring(id), 0, 2)
		if tonumber(uid) > 50 then
			uid = tonumber(uid) - 50
		end
	end

	if isCharSittingInAnyCar(ped) then
		if isCharInAnyCar(ped) or isCharOnAnyBike(ped) then
			local vehicle = storeCarCharIsInNoSave(ped)
			local model = getCarModel(vehicle)
			
			if model >= 596 and model <= 599 then
				local maxp = getMaximumNumberOfPassengers(vehicle)
				local res, int = getNumberOfPassengers(vehicle)
			
				if res and int > 0 then
					for i = 0, maxp do
						if not isCarPassengerSeatFree(vehicle, i) then
							local ped = getCharInCarPassengerSeat(vehicle, i)
							if doesCharExist(ped) then
								if sampIsPoliceOfficerById(ped) then
									return string.format('A-%s', uid) 
								end
							end
						end
					end
				end
				
				return string.format('L-%d', uid) 
			elseif model == 601 or model == 427 or model == 528 then
				return string.format('C-%d', uid) 
			elseif model == 415 then
				return string.format('H-%d', uid) 
			elseif model == 523 then
				return string.format('M-%d', uid) 
			end
		end
	end
	
	return string.format('Unit-%d', id)
end

function sampIsPoliceOfficerById(ped)
	local res, id = sampGetPlayerIdByCharHandle(ped)
	if res then
		if IPC(id) then
			if sampGetPlayerColor(id) == 4278190335 then
				return true
			elseif sampGetPlayerColor(id) == 2236962 then
				local model = getCharModel(ped)
				
				if model >= 280 and model <= 286 then 
					return true 
				elseif model == 288 then 
					return true
				elseif model >= 265 and model <= 267  then 
					return true
				elseif model >= 300 and model <= 311 and model ~= 308 then 
					return true
				end
			end
		end
	end
	
	return false
end

function sampGetNearestDriver()
	local drv = {id = -1, vid = -1, dist = 100}

	for i, val in pairs(getAllVehicles()) do
		wait(0)
		
		if doesVehicleExist(val) then
			local vid = getCarModel(val)
			local ped = getDriverOfCar(val)
			
			if doesCharExist(ped) and isCharSittingInAnyCar(PLAYER_PED) then
				if val ~= storeCarCharIsInNoSave(PLAYER_PED) then
					if not isCharInAnyPoliceVehicle(ped) then
						local _, id = sampGetPlayerIdByCharHandle(ped)
						local dist = sampGetDistance(PLAYER_PED, id)
						
						if dist < 55 then
							if dist < drv.dist then 
								drv.dist = dist
								drv.id = id
								drv.vid = vid
							end
						end
					end
				end
			end
		end
	end
	
	return drv.id, drv.vid 
end

function sampIsPlayerCarHaveSuspect(id)
	if IPC(id) then
		local res, ped = sampGetCharHandleBySampPlayerId(id)
		if res then
			if isCharInAnyCar(ped) and isCharInAnyCar(PLAYER_PED) then
				local vehicle = getCarCharIsUsing(ped)
				local myvehicle = getCarCharIsUsing(PLAYER_PED)
				if vehicle == myvehicle then
					return true
				else
					return false
				end
			else
				return false
			end
		else
			return false
		end
	else
		return false
	end
end

function sampIsPlayerCar(id)
	if IPC(id) then
		local res, ped = sampGetCharHandleBySampPlayerId(id)
		if res then
			if isCharInAnyCar(ped) then
				local vehicle = getCarCharIsUsing(ped)
				local vid = getCarModel(vehicle)
				return true, vid
			else
				return false, -1
			end
		else
			return false, -1
		end
	else
		return false, -1
	end
end

function sampGetHelloByTime()
	local hour = tonumber(os.date('%H'))

	if hour > 3 and hour <= 12 then return 'Доброе утро'
	elseif hour > 12 and hour <= 18 then return 'Добрый день'
	elseif hour > 18 and hour <= 22 then return 'Добрый вечер'
	elseif hour > 22 and hour <= 3 then return 'Доброй ночи'
	else
		return 'Здравствуйте'
	end
end

function sampGetDistance(ped1, id)
	local res, pid = sampGetPlayerIdByCharHandle(PLAYER_PED)
	if tonumber(id) == tonumber(pid) then
		return 0
	elseif not IPC(id) then
		return 5000
	else
		local res, ped2 = sampGetCharHandleBySampPlayerId(id)
		if res then
			local x1, y1, z1 = getCharCoordinates(ped1)
			local x2, y2, z2 = getCharCoordinates(ped2)

			return getDistanceBetweenCoords3d(x1, y1, z1, x2, y2, z2)
		else
			return 5000
		end
	end
end

function getTimeLast(time)
	local lget = {}

	lget[2] = 60 + (time[3] - os.date('%S'))
	lget[1] = time[2] - os.date('%M') - 1

	return lget
end

function sampGetPassedTimeByPeriod(hour, minute, secund, period)
	local time = getTimeByPeriod(hour, minute, secund, period)
	
	if tonumber(os.date('%H')) > (time[1] + 1) then
		return true
	elseif tonumber(os.date('%H')) == (time[1] + 1) then
		if tonumber(os.date('%M')) == (60 - time[2]) and tonumber(os.date('%S')) >= time[3] then
			return true
		elseif tonumber(os.date('%M')) > (60 - time[2]) then
			return true
		else
			return false
		end
	elseif tonumber(os.date('%M')) == time[2] and tonumber(os.date('%S')) >= time[3] then
		return true
	elseif tonumber(os.date('%M')) > time[2] then
		return true
	else
		return false
	end
end

function getTimeByPeriod(hour, minute, secund, period)
	if period < 60 then
		local get = {}
		if minute + period >= 60 then
			hour = hour + 1
			if hour > 23 then hour = 00 end
			minute = period - (60 - minute)
		else
			minute = minute + period
		end
		get[1] = hour
		get[2] = minute
		get[3] = secund
		return get
	end
end

function IPC(id)
	local getptest, getpid = sampGetPlayerIdByCharHandle(PLAYER_PED)
	if getptest then
		if sampIsPlayerConnected(id) or tonumber(id) == tonumber(getpid) then
			return true
		else
			return false
		end
	else 
		return false
	end
end

function sampGetPlayerFractionByid(id)
	if id ~= nil then
		if IPC(id) then
			if sampGetPlayerColor(id) == 4278190335 		then PlayerColor = 'МВД'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4291624704 	then PlayerColor = 'Правительство'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4294927872		then PlayerColor = 'ТВ-Радио'; return PlayerColor
			elseif sampGetPlayerColor(id) == 301989887 		then PlayerColor = 'Гражданские'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4278220149 	then PlayerColor = 'Russian Mafia'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4288230246 	then PlayerColor = 'La Cosa Nostra'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4278229248 	then PlayerColor = 'Grove Street'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4291559679 	then PlayerColor = 'The Ballas'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4284901119 	then PlayerColor = 'The Rifa'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4294927974 	then PlayerColor = 'Мин. здравоохранения'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4288243251 	then PlayerColor = 'Мин. обороны'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4290445312 	then PlayerColor = 'Yakuza'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4278242559 	then PlayerColor = 'Varios Los Aztecas'; return PlayerColor
			elseif sampGetPlayerColor(id) == 4294954240 	then PlayerColor = 'Los Santos Vagos'; return PlayerColor
			else PlayerColor = 'Неизвестно'; return PlayerColor
			end
		end
	end
end

function sampGetOnlineInFraction()
	local online = {mvd = {all = 0, player = {}},
		prav = {all = 0, player = {}},
		mm = {all = 0, player = {}},
		mz = {all = 0, player = {}},
		mo = {all = 0, player = {}},
		civ = {all = 0, player = {}},
		rm = {all = 0, player = {}},
		lcn = {all = 0, player = {}},
		yak = {all = 0, player = {}},
		grv = {all = 0, player = {}},
		bal = {all = 0, player = {}},
		rif = {all = 0, player = {}},
		vag = {all = 0, player = {}},
		azt = {all = 0, player = {}},
		mask = {all = 0, player = {}},
		all = {all = 0, player = {}}
	}
	for id = 0, 1000 do 
		if IPC(id) then
			if sampGetPlayerColor(id) == 4278190335 		then online.mvd.all = online.mvd.all + 1; online.mvd.player[online.mvd.all] = id
			elseif sampGetPlayerColor(id) == 4291624704 	then online.prav.all = online.prav.all + 1; online.prav.player[online.prav.all] = id
			elseif sampGetPlayerColor(id) == 4294927872		then online.mm.all = online.mm.all + 1; online.mm.player[online.mm.all] = id
			elseif sampGetPlayerColor(id) == 301989887 		then online.civ.all = online.civ.all + 1; online.civ.player[online.civ.all] = id
			elseif sampGetPlayerColor(id) == 4278220149 	then online.rm.all = online.rm.all + 1; online.rm.player[online.rm.all] = id
			elseif sampGetPlayerColor(id) == 4288230246 	then online.lcn.all = online.lcn.all + 1; online.lcn.player[online.lcn.all] = id
			elseif sampGetPlayerColor(id) == 4278229248 	then online.grv.all = online.grv.all + 1; online.grv.player[online.grv.all] = id
			elseif sampGetPlayerColor(id) == 4291559679 	then online.bal.all = online.bal.all + 1; online.bal.player[online.bal.all] = id
			elseif sampGetPlayerColor(id) == 4284901119 	then online.rif.all = online.rif.all + 1; online.rif.player[online.rif.all] = id
			elseif sampGetPlayerColor(id) == 4294927974 	then online.mz.all = online.mz.all + 1; online.mz.player[online.mz.all] = id
			elseif sampGetPlayerColor(id) == 4288243251 	then online.mo.all = online.mo.all + 1; online.mo.player[online.mo.all] = id
			elseif sampGetPlayerColor(id) == 4290445312 	then online.yak.all = online.yak.all + 1; online.yak.player[online.yak.all] = id
			elseif sampGetPlayerColor(id) == 4278242559 	then online.azt.all = online.azt.all + 1; online.azt.player[online.azt.all] = id
			elseif sampGetPlayerColor(id) == 4294954240 	then online.vag.all = online.vag.all + 1; online.vag.player[online.vag.all] = id
			elseif sampGetPlayerColor(id) == 2236962        then online.mask.all = online.mask.all + 1; online.mask.player[online.mask.all] = id
			else online.all.all = online.all.all + 1; online.all.player[online.all.all] = id
			end
		end
	end
	return online
end

function kvadrat(X, Y, Z)
    local KV = {
        [1] = "А",
        [2] = "Б",
        [3] = "В",
        [4] = "Г",
        [5] = "Д",
        [6] = "Ж",
        [7] = "З",
        [8] = "И",
        [9] = "К",
        [10] = "Л",
        [11] = "М",
        [12] = "Н",
        [13] = "О",
        [14] = "П",
        [15] = "Р",
        [16] = "С",
        [17] = "Т",
        [18] = "У",
        [19] = "Ф", 
        [20] = "Х",
        [21] = "Ц",
        [22] = "Ч",
        [23] = "Ш",
        [24] = "Я",
    }
	if X == nil then
		X, Y, Z = getCharCoordinates(playerPed)
	end
	
    X = math.ceil((X + 3000) / 250)
    Y = math.ceil((Y * - 1 + 3000) / 250)
    Y = KV[Y]
    local KVX = (Y.."-"..X)
	
	if KVX ~= nil then
		return KVX
	else
		return 0
	end
end

function sampGetVehicleInfo(vehicle)
	if doesVehicleExist(vehicle) then
		local model = getCarModel(vehicle)
		local engine = isCarEngineOn(vehicle) -- двигатель
		local speed = math.floor(getCarSpeed(vehicle) * 2.02) - 1 -- cкорость
		local gear = getCarCurrentGear(vehicle) -- передача (т)
		local allgear = getCarNumberOfGears(vehicle) -- всего передач
		local mass = getCarMass(vehicle) -- масса
		local health = getCarHealth(vehicle)
		local lockd = isCarDoorFullyOpen(vehicle)
		local tire = {} -- массив состояния колёс
		for i = 0, 3 do
			tire[i] = isCarTireBurst(vehicle, i) -- заполнение массива состояния
		end
		
		return {model = model, engine = engine, speed = speed, gear = gear, allgear = allgear, mass = mass, health = health, lockd = lockd, tire = tire}
	else
		return -1
	end
end

function sampGetBodyPart(id)
	if id == 0 then body = 'Неизвестно'
	elseif id == 1 then body = 'Спина'
	elseif id == 2 then body = 'Голова'
	elseif id == 3 then body = 'Плечо левой руки'
	elseif id == 4 then body = 'Плечо правой руки'
	elseif id == 5 then body = 'Левая рука'
	elseif id == 6 then body = 'Правая рука'
	elseif id == 7 then body = 'Левое бедро'
	elseif id == 8 then body = 'Правое бедро'
	elseif id == 9 then body = 'Левая нога'
	elseif id == 10 then body = 'Правая нога'
	elseif id == 11 then body = 'Правая голень'
	elseif id == 12 then body = 'Левая голень'
	elseif id == 13 then body = 'Левое предплечие'
	elseif id == 14 then body = 'Правое предплечие'
	elseif id == 15 then body = 'Левая ключица'
	elseif id == 16 then body = 'Правая ключица'
	elseif id == 17 then body = 'Шея'
	elseif id == 18 then body = 'Челюсть'
	else body = 'Неизвестно'
	end

	return body
end

function sampGetWeaponName(id)
	if id == 0 then weap = 'Fist'
	elseif id == 1 then weap = 'Knuckle'
	elseif id == 2 then weap = 'Golf club'
	elseif id == 3 then weap = 'Police baton'
	elseif id == 4 then weap = 'Knife'
	elseif id == 5 then weap = 'Baseball bat'
	elseif id == 6 then weap = 'Shovel'
	elseif id == 7 then weap = 'Cue'
	elseif id == 8 then weap = 'Katana'
	elseif id == 9 then weap = 'Chainsaw'
	elseif id == 10 then weap = 'Double sided Dildo'
	elseif id == 11 then weap = 'Dildo'
	elseif id == 12 then weap = 'Vibrator'
	elseif id == 13 then weap = 'Silver vibrator'
	elseif id == 14 then weap = 'Flower'
	elseif id == 15 then weap = 'Stick'
	elseif id == 16 then weap = 'Grenade'
	elseif id == 17 then weap = 'Tear Gas'
	elseif id == 18 then weap = 'Cocktail of Molotov'
	elseif id == 22 then weap = 'Gun of 9mm'
	elseif id == 23 then weap = 'SD pistol 9mm'
	elseif id == 24 then weap = 'Desert Eagle'
	elseif id == 25 then weap = 'ShotGun'
	elseif id == 26 then weap = 'Edge ShotGun'
	elseif id == 27 then weap = 'Combat ShotGun'
	elseif id == 28 then weap = 'Usi'
	elseif id == 29 then weap = 'MP-5'
	elseif id == 30 then weap = 'AK-47'
	elseif id == 31 then weap = 'M4'
	elseif id == 32 then weap = 'Tec-9'
	elseif id == 33 then weap = 'Rifle'
	elseif id == 34 then weap = 'Sniper Rifle'
	elseif id == 35 then weap = 'RPG-7'
	elseif id == 36 then weap = 'Rocket Launcher'
	elseif id == 37 then weap = 'Flamer'
	elseif id == 38 then weap = 'Minigun'
	elseif id == 39 then weap = 'Bag of C4'
	elseif id == 40 then weap = 'Detonator for C4'
	elseif id == 41 then weap = 'Spray'
	elseif id == 42 then weap = 'Огнетушитель'
	elseif id == 43 then weap = 'Photo Camera'
	elseif id == 44 then weap = 'Night Vision'
	elseif id == 45 then weap = 'Hot Vision'
	elseif id == 46 then weap = 'Parachute'
	elseif id == 49 then weap = 'Vehicle'
	else weap = 'Неизвестно'
	end

	return weap
end

function sampWeaponScene(id)
	local wname = weapons.get_name(id)
	if wname == '9mm' then wname = 'p9mm' end
	wname = string.gsub(wname, '-', '_')
	wname = string.gsub(wname, ' ', '_')
	
	if ini.rpweapon[wname] ~= nil then
		if ini.rpweapon[wname] ~= '' then
			return true, ini.rpweapon[wname]
		end
	end
	
	return false, ''
end

function sampWeaponSceneOff(id)
	local wname = weapons.get_name(id)
	if wname == '9mm' then wname = 'p9mm' end
	wname = string.gsub(wname, '-', '_')
	wname = string.gsub(wname, ' ', '_')
	
	if ini.rpweaponoff[wname] ~= nil then
		if ini.rpweaponoff[wname] ~= '' then
			return true, ini.rpweaponoff[wname]
		end
	end
	
	return false, ''
end

function calculateZone(x, y, z)
	if x == nil then
		x, y, z = getCharCoordinates(playerPed)
	end
	
    local streets = {{"Avispa Country Club", -2667.810, -302.135, -28.831, -2646.400, -262.320, 71.169},
    {"Easter Bay Airport", -1315.420, -405.388, 15.406, -1264.400, -209.543, 25.406},
    {"Avispa Country Club", -2550.040, -355.493, 0.000, -2470.040, -318.493, 39.700},
    {"Easter Bay Airport", -1490.330, -209.543, 15.406, -1264.400, -148.388, 25.406},
    {"Garcia", -2395.140, -222.589, -5.3, -2354.090, -204.792, 200.000},
    {"Shady Cabin", -1632.830, -2263.440, -3.0, -1601.330, -2231.790, 200.000},
    {"East Los Santos", 2381.680, -1494.030, -89.084, 2421.030, -1454.350, 110.916},
    {"LVA Freight Depot", 1236.630, 1163.410, -89.084, 1277.050, 1203.280, 110.916},
    {"Blackfield Intersection", 1277.050, 1044.690, -89.084, 1315.350, 1087.630, 110.916},
    {"Avispa Country Club", -2470.040, -355.493, 0.000, -2270.040, -318.493, 46.100},
    {"Temple", 1252.330, -926.999, -89.084, 1357.000, -910.170, 110.916},
    {"Unity Station", 1692.620, -1971.800, -20.492, 1812.620, -1932.800, 79.508},
    {"LVA Freight Depot", 1315.350, 1044.690, -89.084, 1375.600, 1087.630, 110.916},
    {"Los Flores", 2581.730, -1454.350, -89.084, 2632.830, -1393.420, 110.916},
    {"Starfish Casino", 2437.390, 1858.100, -39.084, 2495.090, 1970.850, 60.916},
    {"Easter Bay Chemicals", -1132.820, -787.391, 0.000, -956.476, -768.027, 200.000},
    {"Downtown Los Santos", 1370.850, -1170.870, -89.084, 1463.900, -1130.850, 110.916},
    {"Esplanade East", -1620.300, 1176.520, -4.5, -1580.010, 1274.260, 200.000},
    {"Market Station", 787.461, -1410.930, -34.126, 866.009, -1310.210, 65.874},
    {"Linden Station", 2811.250, 1229.590, -39.594, 2861.250, 1407.590, 60.406},
    {"Montgomery Intersection", 1582.440, 347.457, 0.000, 1664.620, 401.750, 200.000},
    {"Frederick Bridge", 2759.250, 296.501, 0.000, 2774.250, 594.757, 200.000},
    {"Yellow Bell Station", 1377.480, 2600.430, -21.926, 1492.450, 2687.360, 78.074},
    {"Downtown Los Santos", 1507.510, -1385.210, 110.916, 1582.550, -1325.310, 335.916},
    {"Jefferson", 2185.330, -1210.740, -89.084, 2281.450, -1154.590, 110.916},
    {"Mulholland", 1318.130, -910.170, -89.084, 1357.000, -768.027, 110.916},
    {"Avispa Country Club", -2361.510, -417.199, 0.000, -2270.040, -355.493, 200.000},
    {"Jefferson", 1996.910, -1449.670, -89.084, 2056.860, -1350.720, 110.916},
    {"Julius Thruway West", 1236.630, 2142.860, -89.084, 1297.470, 2243.230, 110.916},
    {"Jefferson", 2124.660, -1494.030, -89.084, 2266.210, -1449.670, 110.916},
    {"Julius Thruway North", 1848.400, 2478.490, -89.084, 1938.800, 2553.490, 110.916},
    {"Rodeo", 422.680, -1570.200, -89.084, 466.223, -1406.050, 110.916},
    {"Cranberry Station", -2007.830, 56.306, 0.000, -1922.000, 224.782, 100.000},
    {"Downtown Los Santos", 1391.050, -1026.330, -89.084, 1463.900, -926.999, 110.916},
    {"Redsands West", 1704.590, 2243.230, -89.084, 1777.390, 2342.830, 110.916},
    {"Little Mexico", 1758.900, -1722.260, -89.084, 1812.620, -1577.590, 110.916},
    {"Blackfield Intersection", 1375.600, 823.228, -89.084, 1457.390, 919.447, 110.916},
    {"Los Santos International", 1974.630, -2394.330, -39.084, 2089.000, -2256.590, 60.916},
    {"Beacon Hill", -399.633, -1075.520, -1.489, -319.033, -977.516, 198.511},
    {"Rodeo", 334.503, -1501.950, -89.084, 422.680, -1406.050, 110.916},
    {"Richman", 225.165, -1369.620, -89.084, 334.503, -1292.070, 110.916},
    {"Downtown Los Santos", 1724.760, -1250.900, -89.084, 1812.620, -1150.870, 110.916},
    {"The Strip", 2027.400, 1703.230, -89.084, 2137.400, 1783.230, 110.916},
    {"Downtown Los Santos", 1378.330, -1130.850, -89.084, 1463.900, -1026.330, 110.916},
    {"Blackfield Intersection", 1197.390, 1044.690, -89.084, 1277.050, 1163.390, 110.916},
    {"Conference Center", 1073.220, -1842.270, -89.084, 1323.900, -1804.210, 110.916},
    {"Montgomery", 1451.400, 347.457, -6.1, 1582.440, 420.802, 200.000},
    {"Foster Valley", -2270.040, -430.276, -1.2, -2178.690, -324.114, 200.000},
    {"Blackfield Chapel", 1325.600, 596.349, -89.084, 1375.600, 795.010, 110.916},
    {"Los Santos International", 2051.630, -2597.260, -39.084, 2152.450, -2394.330, 60.916},
    {"Mulholland", 1096.470, -910.170, -89.084, 1169.130, -768.027, 110.916},
    {"Yellow Bell Gol Course", 1457.460, 2723.230, -89.084, 1534.560, 2863.230, 110.916},
    {"The Strip", 2027.400, 1783.230, -89.084, 2162.390, 1863.230, 110.916},
    {"Jefferson", 2056.860, -1210.740, -89.084, 2185.330, -1126.320, 110.916},
    {"Mulholland", 952.604, -937.184, -89.084, 1096.470, -860.619, 110.916},
    {"Aldea Malvada", -1372.140, 2498.520, 0.000, -1277.590, 2615.350, 200.000},
    {"Las Colinas", 2126.860, -1126.320, -89.084, 2185.330, -934.489, 110.916},
    {"Las Colinas", 1994.330, -1100.820, -89.084, 2056.860, -920.815, 110.916},
    {"Richman", 647.557, -954.662, -89.084, 768.694, -860.619, 110.916},
    {"LVA Freight Depot", 1277.050, 1087.630, -89.084, 1375.600, 1203.280, 110.916},
    {"Julius Thruway North", 1377.390, 2433.230, -89.084, 1534.560, 2507.230, 110.916},
    {"Willowfield", 2201.820, -2095.000, -89.084, 2324.000, -1989.900, 110.916},
    {"Julius Thruway North", 1704.590, 2342.830, -89.084, 1848.400, 2433.230, 110.916},
    {"Temple", 1252.330, -1130.850, -89.084, 1378.330, -1026.330, 110.916},
    {"Little Mexico", 1701.900, -1842.270, -89.084, 1812.620, -1722.260, 110.916},
    {"Queens", -2411.220, 373.539, 0.000, -2253.540, 458.411, 200.000},
    {"Las Venturas Airport", 1515.810, 1586.400, -12.500, 1729.950, 1714.560, 87.500},
    {"Richman", 225.165, -1292.070, -89.084, 466.223, -1235.070, 110.916},
    {"Temple", 1252.330, -1026.330, -89.084, 1391.050, -926.999, 110.916},
    {"East Los Santos", 2266.260, -1494.030, -89.084, 2381.680, -1372.040, 110.916},
    {"Julius Thruway East", 2623.180, 943.235, -89.084, 2749.900, 1055.960, 110.916},
    {"Willowfield", 2541.700, -1941.400, -89.084, 2703.580, -1852.870, 110.916},
    {"Las Colinas", 2056.860, -1126.320, -89.084, 2126.860, -920.815, 110.916},
    {"Julius Thruway East", 2625.160, 2202.760, -89.084, 2685.160, 2442.550, 110.916},
    {"Rodeo", 225.165, -1501.950, -89.084, 334.503, -1369.620, 110.916},
    {"Las Brujas", -365.167, 2123.010, -3.0, -208.570, 2217.680, 200.000},
    {"Julius Thruway East", 2536.430, 2442.550, -89.084, 2685.160, 2542.550, 110.916},
    {"Rodeo", 334.503, -1406.050, -89.084, 466.223, -1292.070, 110.916},
    {"Vinewood", 647.557, -1227.280, -89.084, 787.461, -1118.280, 110.916},
    {"Rodeo", 422.680, -1684.650, -89.084, 558.099, -1570.200, 110.916},
    {"Julius Thruway North", 2498.210, 2542.550, -89.084, 2685.160, 2626.550, 110.916},
    {"Downtown Los Santos", 1724.760, -1430.870, -89.084, 1812.620, -1250.900, 110.916},
    {"Rodeo", 225.165, -1684.650, -89.084, 312.803, -1501.950, 110.916},
    {"Jefferson", 2056.860, -1449.670, -89.084, 2266.210, -1372.040, 110.916},
    {"Hampton Barns", 603.035, 264.312, 0.000, 761.994, 366.572, 200.000},
    {"Temple", 1096.470, -1130.840, -89.084, 1252.330, -1026.330, 110.916},
    {"Kincaid Bridge", -1087.930, 855.370, -89.084, -961.950, 986.281, 110.916},
    {"Verona Beach", 1046.150, -1722.260, -89.084, 1161.520, -1577.590, 110.916},
    {"Commerce", 1323.900, -1722.260, -89.084, 1440.900, -1577.590, 110.916},
    {"Mulholland", 1357.000, -926.999, -89.084, 1463.900, -768.027, 110.916},
    {"Rodeo", 466.223, -1570.200, -89.084, 558.099, -1385.070, 110.916},
    {"Mulholland", 911.802, -860.619, -89.084, 1096.470, -768.027, 110.916},
    {"Mulholland", 768.694, -954.662, -89.084, 952.604, -860.619, 110.916},
    {"Julius Thruway South", 2377.390, 788.894, -89.084, 2537.390, 897.901, 110.916},
    {"Idlewood", 1812.620, -1852.870, -89.084, 1971.660, -1742.310, 110.916},
    {"Ocean Docks", 2089.000, -2394.330, -89.084, 2201.820, -2235.840, 110.916},
    {"Commerce", 1370.850, -1577.590, -89.084, 1463.900, -1384.950, 110.916},
    {"Julius Thruway North", 2121.400, 2508.230, -89.084, 2237.400, 2663.170, 110.916},
    {"Temple", 1096.470, -1026.330, -89.084, 1252.330, -910.170, 110.916},
    {"Glen Park", 1812.620, -1449.670, -89.084, 1996.910, -1350.720, 110.916},
    {"Easter Bay Airport", -1242.980, -50.096, 0.000, -1213.910, 578.396, 200.000},
    {"Martin Bridge", -222.179, 293.324, 0.000, -122.126, 476.465, 200.000},
    {"The Strip", 2106.700, 1863.230, -89.084, 2162.390, 2202.760, 110.916},
    {"Willowfield", 2541.700, -2059.230, -89.084, 2703.580, -1941.400, 110.916},
    {"Marina", 807.922, -1577.590, -89.084, 926.922, -1416.250, 110.916},
    {"Las Venturas Airport", 1457.370, 1143.210, -89.084, 1777.400, 1203.280, 110.916},
    {"Idlewood", 1812.620, -1742.310, -89.084, 1951.660, -1602.310, 110.916},
    {"Esplanade East", -1580.010, 1025.980, -6.1, -1499.890, 1274.260, 200.000},
    {"Downtown Los Santos", 1370.850, -1384.950, -89.084, 1463.900, -1170.870, 110.916},
    {"The Mako Span", 1664.620, 401.750, 0.000, 1785.140, 567.203, 200.000},
    {"Rodeo", 312.803, -1684.650, -89.084, 422.680, -1501.950, 110.916},
    {"Pershing Square", 1440.900, -1722.260, -89.084, 1583.500, -1577.590, 110.916},
    {"Mulholland", 687.802, -860.619, -89.084, 911.802, -768.027, 110.916},
    {"Gant Bridge", -2741.070, 1490.470, -6.1, -2616.400, 1659.680, 200.000},
    {"Las Colinas", 2185.330, -1154.590, -89.084, 2281.450, -934.489, 110.916},
    {"Mulholland", 1169.130, -910.170, -89.084, 1318.130, -768.027, 110.916},
    {"Julius Thruway North", 1938.800, 2508.230, -89.084, 2121.400, 2624.230, 110.916},
    {"Commerce", 1667.960, -1577.590, -89.084, 1812.620, -1430.870, 110.916},
    {"Rodeo", 72.648, -1544.170, -89.084, 225.165, -1404.970, 110.916},
    {"Roca Escalante", 2536.430, 2202.760, -89.084, 2625.160, 2442.550, 110.916},
    {"Rodeo", 72.648, -1684.650, -89.084, 225.165, -1544.170, 110.916},
    {"Market", 952.663, -1310.210, -89.084, 1072.660, -1130.850, 110.916},
    {"Las Colinas", 2632.740, -1135.040, -89.084, 2747.740, -945.035, 110.916},
    {"Mulholland", 861.085, -674.885, -89.084, 1156.550, -600.896, 110.916},
    {"King's", -2253.540, 373.539, -9.1, -1993.280, 458.411, 200.000},
    {"Redsands East", 1848.400, 2342.830, -89.084, 2011.940, 2478.490, 110.916},
    {"Downtown", -1580.010, 744.267, -6.1, -1499.890, 1025.980, 200.000},
    {"Conference Center", 1046.150, -1804.210, -89.084, 1323.900, -1722.260, 110.916},
    {"Richman", 647.557, -1118.280, -89.084, 787.461, -954.662, 110.916},
    {"Ocean Flats", -2994.490, 277.411, -9.1, -2867.850, 458.411, 200.000},
    {"Greenglass College", 964.391, 930.890, -89.084, 1166.530, 1044.690, 110.916},
    {"Glen Park", 1812.620, -1100.820, -89.084, 1994.330, -973.380, 110.916},
    {"LVA Freight Depot", 1375.600, 919.447, -89.084, 1457.370, 1203.280, 110.916},
    {"Regular Tom", -405.770, 1712.860, -3.0, -276.719, 1892.750, 200.000},
    {"Verona Beach", 1161.520, -1722.260, -89.084, 1323.900, -1577.590, 110.916},
    {"East Los Santos", 2281.450, -1372.040, -89.084, 2381.680, -1135.040, 110.916},
    {"Caligula's Palace", 2137.400, 1703.230, -89.084, 2437.390, 1783.230, 110.916},
    {"Idlewood", 1951.660, -1742.310, -89.084, 2124.660, -1602.310, 110.916},
    {"Pilgrim", 2624.400, 1383.230, -89.084, 2685.160, 1783.230, 110.916},
    {"Idlewood", 2124.660, -1742.310, -89.084, 2222.560, -1494.030, 110.916},
    {"Queens", -2533.040, 458.411, 0.000, -2329.310, 578.396, 200.000},
    {"Downtown", -1871.720, 1176.420, -4.5, -1620.300, 1274.260, 200.000},
    {"Commerce", 1583.500, -1722.260, -89.084, 1758.900, -1577.590, 110.916},
    {"East Los Santos", 2381.680, -1454.350, -89.084, 2462.130, -1135.040, 110.916},
    {"Marina", 647.712, -1577.590, -89.084, 807.922, -1416.250, 110.916},
    {"Richman", 72.648, -1404.970, -89.084, 225.165, -1235.070, 110.916},
    {"Vinewood", 647.712, -1416.250, -89.084, 787.461, -1227.280, 110.916},
    {"East Los Santos", 2222.560, -1628.530, -89.084, 2421.030, -1494.030, 110.916},
    {"Rodeo", 558.099, -1684.650, -89.084, 647.522, -1384.930, 110.916},
    {"Easter Tunnel", -1709.710, -833.034, -1.5, -1446.010, -730.118, 200.000},
    {"Rodeo", 466.223, -1385.070, -89.084, 647.522, -1235.070, 110.916},
    {"Redsands East", 1817.390, 2202.760, -89.084, 2011.940, 2342.830, 110.916},
    {"The Clown's Pocket", 2162.390, 1783.230, -89.084, 2437.390, 1883.230, 110.916},
    {"Idlewood", 1971.660, -1852.870, -89.084, 2222.560, -1742.310, 110.916},
    {"Montgomery Intersection", 1546.650, 208.164, 0.000, 1745.830, 347.457, 200.000},
    {"Willowfield", 2089.000, -2235.840, -89.084, 2201.820, -1989.900, 110.916},
    {"Temple", 952.663, -1130.840, -89.084, 1096.470, -937.184, 110.916},
    {"Prickle Pine", 1848.400, 2553.490, -89.084, 1938.800, 2863.230, 110.916},
    {"Los Santos International", 1400.970, -2669.260, -39.084, 2189.820, -2597.260, 60.916},
    {"Garver Bridge", -1213.910, 950.022, -89.084, -1087.930, 1178.930, 110.916},
    {"Garver Bridge", -1339.890, 828.129, -89.084, -1213.910, 1057.040, 110.916},
    {"Kincaid Bridge", -1339.890, 599.218, -89.084, -1213.910, 828.129, 110.916},
    {"Kincaid Bridge", -1213.910, 721.111, -89.084, -1087.930, 950.022, 110.916},
    {"Verona Beach", 930.221, -2006.780, -89.084, 1073.220, -1804.210, 110.916},
    {"Verdant Bluffs", 1073.220, -2006.780, -89.084, 1249.620, -1842.270, 110.916},
    {"Vinewood", 787.461, -1130.840, -89.084, 952.604, -954.662, 110.916},
    {"Vinewood", 787.461, -1310.210, -89.084, 952.663, -1130.840, 110.916},
    {"Commerce", 1463.900, -1577.590, -89.084, 1667.960, -1430.870, 110.916},
    {"Market", 787.461, -1416.250, -89.084, 1072.660, -1310.210, 110.916},
    {"Rockshore West", 2377.390, 596.349, -89.084, 2537.390, 788.894, 110.916},
    {"Julius Thruway North", 2237.400, 2542.550, -89.084, 2498.210, 2663.170, 110.916},
    {"East Beach", 2632.830, -1668.130, -89.084, 2747.740, -1393.420, 110.916},
    {"Fallow Bridge", 434.341, 366.572, 0.000, 603.035, 555.680, 200.000},
    {"Willowfield", 2089.000, -1989.900, -89.084, 2324.000, -1852.870, 110.916},
    {"Chinatown", -2274.170, 578.396, -7.6, -2078.670, 744.170, 200.000},
    {"El Castillo del Diablo", -208.570, 2337.180, 0.000, 8.430, 2487.180, 200.000},
    {"Ocean Docks", 2324.000, -2145.100, -89.084, 2703.580, -2059.230, 110.916},
    {"Easter Bay Chemicals", -1132.820, -768.027, 0.000, -956.476, -578.118, 200.000},
    {"The Visage", 1817.390, 1703.230, -89.084, 2027.400, 1863.230, 110.916},
    {"Ocean Flats", -2994.490, -430.276, -1.2, -2831.890, -222.589, 200.000},
    {"Richman", 321.356, -860.619, -89.084, 687.802, -768.027, 110.916},
    {"Green Palms", 176.581, 1305.450, -3.0, 338.658, 1520.720, 200.000},
    {"Richman", 321.356, -768.027, -89.084, 700.794, -674.885, 110.916},
    {"Starfish Casino", 2162.390, 1883.230, -89.084, 2437.390, 2012.180, 110.916},
    {"East Beach", 2747.740, -1668.130, -89.084, 2959.350, -1498.620, 110.916},
    {"Jefferson", 2056.860, -1372.040, -89.084, 2281.450, -1210.740, 110.916},
    {"Downtown Los Santos", 1463.900, -1290.870, -89.084, 1724.760, -1150.870, 110.916},
    {"Downtown Los Santos", 1463.900, -1430.870, -89.084, 1724.760, -1290.870, 110.916},
    {"Garver Bridge", -1499.890, 696.442, -179.615, -1339.890, 925.353, 20.385},
    {"Julius Thruway South", 1457.390, 823.228, -89.084, 2377.390, 863.229, 110.916},
    {"East Los Santos", 2421.030, -1628.530, -89.084, 2632.830, -1454.350, 110.916},
    {"Greenglass College", 964.391, 1044.690, -89.084, 1197.390, 1203.220, 110.916},
    {"Las Colinas", 2747.740, -1120.040, -89.084, 2959.350, -945.035, 110.916},
    {"Mulholland", 737.573, -768.027, -89.084, 1142.290, -674.885, 110.916},
    {"Ocean Docks", 2201.820, -2730.880, -89.084, 2324.000, -2418.330, 110.916},
    {"East Los Santos", 2462.130, -1454.350, -89.084, 2581.730, -1135.040, 110.916},
    {"Ganton", 2222.560, -1722.330, -89.084, 2632.830, -1628.530, 110.916},
    {"Avispa Country Club", -2831.890, -430.276, -6.1, -2646.400, -222.589, 200.000},
    {"Willowfield", 1970.620, -2179.250, -89.084, 2089.000, -1852.870, 110.916},
    {"Esplanade North", -1982.320, 1274.260, -4.5, -1524.240, 1358.900, 200.000},
    {"The High Roller", 1817.390, 1283.230, -89.084, 2027.390, 1469.230, 110.916},
    {"Ocean Docks", 2201.820, -2418.330, -89.084, 2324.000, -2095.000, 110.916},
    {"Last Dime Motel", 1823.080, 596.349, -89.084, 1997.220, 823.228, 110.916},
    {"Bayside Marina", -2353.170, 2275.790, 0.000, -2153.170, 2475.790, 200.000},
    {"King's", -2329.310, 458.411, -7.6, -1993.280, 578.396, 200.000},
    {"El Corona", 1692.620, -2179.250, -89.084, 1812.620, -1842.270, 110.916},
    {"Blackfield Chapel", 1375.600, 596.349, -89.084, 1558.090, 823.228, 110.916},
    {"The Pink Swan", 1817.390, 1083.230, -89.084, 2027.390, 1283.230, 110.916},
    {"Julius Thruway West", 1197.390, 1163.390, -89.084, 1236.630, 2243.230, 110.916},
    {"Los Flores", 2581.730, -1393.420, -89.084, 2747.740, -1135.040, 110.916},
    {"The Visage", 1817.390, 1863.230, -89.084, 2106.700, 2011.830, 110.916},
    {"Prickle Pine", 1938.800, 2624.230, -89.084, 2121.400, 2861.550, 110.916},
    {"Verona Beach", 851.449, -1804.210, -89.084, 1046.150, -1577.590, 110.916},
    {"Robada Intersection", -1119.010, 1178.930, -89.084, -862.025, 1351.450, 110.916},
    {"Linden Side", 2749.900, 943.235, -89.084, 2923.390, 1198.990, 110.916},
    {"Ocean Docks", 2703.580, -2302.330, -89.084, 2959.350, -2126.900, 110.916},
    {"Willowfield", 2324.000, -2059.230, -89.084, 2541.700, -1852.870, 110.916},
    {"King's", -2411.220, 265.243, -9.1, -1993.280, 373.539, 200.000},
    {"Commerce", 1323.900, -1842.270, -89.084, 1701.900, -1722.260, 110.916},
    {"Mulholland", 1269.130, -768.027, -89.084, 1414.070, -452.425, 110.916},
    {"Marina", 647.712, -1804.210, -89.084, 851.449, -1577.590, 110.916},
    {"Battery Point", -2741.070, 1268.410, -4.5, -2533.040, 1490.470, 200.000},
    {"The Four Dragons Casino", 1817.390, 863.232, -89.084, 2027.390, 1083.230, 110.916},
    {"Blackfield", 964.391, 1203.220, -89.084, 1197.390, 1403.220, 110.916},
    {"Julius Thruway North", 1534.560, 2433.230, -89.084, 1848.400, 2583.230, 110.916},
    {"Yellow Bell Gol Course", 1117.400, 2723.230, -89.084, 1457.460, 2863.230, 110.916},
    {"Idlewood", 1812.620, -1602.310, -89.084, 2124.660, -1449.670, 110.916},
    {"Redsands West", 1297.470, 2142.860, -89.084, 1777.390, 2243.230, 110.916},
    {"Doherty", -2270.040, -324.114, -1.2, -1794.920, -222.589, 200.000},
    {"Hilltop Farm", 967.383, -450.390, -3.0, 1176.780, -217.900, 200.000},
    {"Las Barrancas", -926.130, 1398.730, -3.0, -719.234, 1634.690, 200.000},
    {"Pirates in Men's Pants", 1817.390, 1469.230, -89.084, 2027.400, 1703.230, 110.916},
    {"City Hall", -2867.850, 277.411, -9.1, -2593.440, 458.411, 200.000},
    {"Avispa Country Club", -2646.400, -355.493, 0.000, -2270.040, -222.589, 200.000},
    {"The Strip", 2027.400, 863.229, -89.084, 2087.390, 1703.230, 110.916},
    {"Hashbury", -2593.440, -222.589, -1.0, -2411.220, 54.722, 200.000},
    {"Los Santos International", 1852.000, -2394.330, -89.084, 2089.000, -2179.250, 110.916},
    {"Whitewood Estates", 1098.310, 1726.220, -89.084, 1197.390, 2243.230, 110.916},
    {"Sherman Reservoir", -789.737, 1659.680, -89.084, -599.505, 1929.410, 110.916},
    {"El Corona", 1812.620, -2179.250, -89.084, 1970.620, -1852.870, 110.916},
    {"Downtown", -1700.010, 744.267, -6.1, -1580.010, 1176.520, 200.000},
    {"Foster Valley", -2178.690, -1250.970, 0.000, -1794.920, -1115.580, 200.000},
    {"Las Payasadas", -354.332, 2580.360, 2.0, -133.625, 2816.820, 200.000},
    {"Valle Ocultado", -936.668, 2611.440, 2.0, -715.961, 2847.900, 200.000},
    {"Blackfield Intersection", 1166.530, 795.010, -89.084, 1375.600, 1044.690, 110.916},
    {"Ganton", 2222.560, -1852.870, -89.084, 2632.830, -1722.330, 110.916},
    {"Easter Bay Airport", -1213.910, -730.118, 0.000, -1132.820, -50.096, 200.000},
    {"Redsands East", 1817.390, 2011.830, -89.084, 2106.700, 2202.760, 110.916},
    {"Esplanade East", -1499.890, 578.396, -79.615, -1339.890, 1274.260, 20.385},
    {"Caligula's Palace", 2087.390, 1543.230, -89.084, 2437.390, 1703.230, 110.916},
    {"Royal Casino", 2087.390, 1383.230, -89.084, 2437.390, 1543.230, 110.916},
    {"Richman", 72.648, -1235.070, -89.084, 321.356, -1008.150, 110.916},
    {"Starfish Casino", 2437.390, 1783.230, -89.084, 2685.160, 2012.180, 110.916},
    {"Mulholland", 1281.130, -452.425, -89.084, 1641.130, -290.913, 110.916},
    {"Downtown", -1982.320, 744.170, -6.1, -1871.720, 1274.260, 200.000},
    {"Hankypanky Point", 2576.920, 62.158, 0.000, 2759.250, 385.503, 200.000},
    {"K.A.C.C. Military Fuels", 2498.210, 2626.550, -89.084, 2749.900, 2861.550, 110.916},
    {"Harry Gold Parkway", 1777.390, 863.232, -89.084, 1817.390, 2342.830, 110.916},
    {"Bayside Tunnel", -2290.190, 2548.290, -89.084, -1950.190, 2723.290, 110.916},
    {"Ocean Docks", 2324.000, -2302.330, -89.084, 2703.580, -2145.100, 110.916},
    {"Richman", 321.356, -1044.070, -89.084, 647.557, -860.619, 110.916},
    {"Randolph Industrial Estate", 1558.090, 596.349, -89.084, 1823.080, 823.235, 110.916},
    {"East Beach", 2632.830, -1852.870, -89.084, 2959.350, -1668.130, 110.916},
    {"Flint Water", -314.426, -753.874, -89.084, -106.339, -463.073, 110.916},
    {"Blueberry", 19.607, -404.136, 3.8, 349.607, -220.137, 200.000},
    {"Linden Station", 2749.900, 1198.990, -89.084, 2923.390, 1548.990, 110.916},
    {"Glen Park", 1812.620, -1350.720, -89.084, 2056.860, -1100.820, 110.916},
    {"Downtown", -1993.280, 265.243, -9.1, -1794.920, 578.396, 200.000},
    {"Redsands West", 1377.390, 2243.230, -89.084, 1704.590, 2433.230, 110.916},
    {"Richman", 321.356, -1235.070, -89.084, 647.522, -1044.070, 110.916},
    {"Gant Bridge", -2741.450, 1659.680, -6.1, -2616.400, 2175.150, 200.000},
    {"Lil' Probe Inn", -90.218, 1286.850, -3.0, 153.859, 1554.120, 200.000},
    {"Flint Intersection", -187.700, -1596.760, -89.084, 17.063, -1276.600, 110.916},
    {"Las Colinas", 2281.450, -1135.040, -89.084, 2632.740, -945.035, 110.916},
    {"Sobell Rail Yards", 2749.900, 1548.990, -89.084, 2923.390, 1937.250, 110.916},
    {"The Emerald Isle", 2011.940, 2202.760, -89.084, 2237.400, 2508.230, 110.916},
    {"El Castillo del Diablo", -208.570, 2123.010, -7.6, 114.033, 2337.180, 200.000},
    {"Santa Flora", -2741.070, 458.411, -7.6, -2533.040, 793.411, 200.000},
    {"Playa del Seville", 2703.580, -2126.900, -89.084, 2959.350, -1852.870, 110.916},
    {"Market", 926.922, -1577.590, -89.084, 1370.850, -1416.250, 110.916},
    {"Queens", -2593.440, 54.722, 0.000, -2411.220, 458.411, 200.000},
    {"Pilson Intersection", 1098.390, 2243.230, -89.084, 1377.390, 2507.230, 110.916},
    {"Spinybed", 2121.400, 2663.170, -89.084, 2498.210, 2861.550, 110.916},
    {"Pilgrim", 2437.390, 1383.230, -89.084, 2624.400, 1783.230, 110.916},
    {"Blackfield", 964.391, 1403.220, -89.084, 1197.390, 1726.220, 110.916},
    {"'The Big Ear'", -410.020, 1403.340, -3.0, -137.969, 1681.230, 200.000},
    {"Dillimore", 580.794, -674.885, -9.5, 861.085, -404.790, 200.000},
    {"El Quebrados", -1645.230, 2498.520, 0.000, -1372.140, 2777.850, 200.000},
    {"Esplanade North", -2533.040, 1358.900, -4.5, -1996.660, 1501.210, 200.000},
    {"Easter Bay Airport", -1499.890, -50.096, -1.0, -1242.980, 249.904, 200.000},
    {"Fisher's Lagoon", 1916.990, -233.323, -100.000, 2131.720, 13.800, 200.000},
    {"Mulholland", 1414.070, -768.027, -89.084, 1667.610, -452.425, 110.916},
    {"East Beach", 2747.740, -1498.620, -89.084, 2959.350, -1120.040, 110.916},
    {"San Andreas Sound", 2450.390, 385.503, -100.000, 2759.250, 562.349, 200.000},
    {"Shady Creeks", -2030.120, -2174.890, -6.1, -1820.640, -1771.660, 200.000},
    {"Market", 1072.660, -1416.250, -89.084, 1370.850, -1130.850, 110.916},
    {"Rockshore West", 1997.220, 596.349, -89.084, 2377.390, 823.228, 110.916},
    {"Prickle Pine", 1534.560, 2583.230, -89.084, 1848.400, 2863.230, 110.916},
    {"Easter Basin", -1794.920, -50.096, -1.04, -1499.890, 249.904, 200.000},
    {"Leafy Hollow", -1166.970, -1856.030, 0.000, -815.624, -1602.070, 200.000},
    {"LVA Freight Depot", 1457.390, 863.229, -89.084, 1777.400, 1143.210, 110.916},
    {"Prickle Pine", 1117.400, 2507.230, -89.084, 1534.560, 2723.230, 110.916},
    {"Blueberry", 104.534, -220.137, 2.3, 349.607, 152.236, 200.000},
    {"El Castillo del Diablo", -464.515, 2217.680, 0.000, -208.570, 2580.360, 200.000},
    {"Downtown", -2078.670, 578.396, -7.6, -1499.890, 744.267, 200.000},
    {"Rockshore East", 2537.390, 676.549, -89.084, 2902.350, 943.235, 110.916},
    {"San Fierro Bay", -2616.400, 1501.210, -3.0, -1996.660, 1659.680, 200.000},
    {"Paradiso", -2741.070, 793.411, -6.1, -2533.040, 1268.410, 200.000},
    {"The Camel's Toe", 2087.390, 1203.230, -89.084, 2640.400, 1383.230, 110.916},
    {"Old Venturas Strip", 2162.390, 2012.180, -89.084, 2685.160, 2202.760, 110.916},
    {"Juniper Hill", -2533.040, 578.396, -7.6, -2274.170, 968.369, 200.000},
    {"Juniper Hollow", -2533.040, 968.369, -6.1, -2274.170, 1358.900, 200.000},
    {"Roca Escalante", 2237.400, 2202.760, -89.084, 2536.430, 2542.550, 110.916},
    {"Julius Thruway East", 2685.160, 1055.960, -89.084, 2749.900, 2626.550, 110.916},
    {"Verona Beach", 647.712, -2173.290, -89.084, 930.221, -1804.210, 110.916},
    {"Foster Valley", -2178.690, -599.884, -1.2, -1794.920, -324.114, 200.000},
    {"Arco del Oeste", -901.129, 2221.860, 0.000, -592.090, 2571.970, 200.000},
    {"Fallen Tree", -792.254, -698.555, -5.3, -452.404, -380.043, 200.000},
    {"The Farm", -1209.670, -1317.100, 114.981, -908.161, -787.391, 251.981},
    {"The Sherman Dam", -968.772, 1929.410, -3.0, -481.126, 2155.260, 200.000},
    {"Esplanade North", -1996.660, 1358.900, -4.5, -1524.240, 1592.510, 200.000},
    {"Financial", -1871.720, 744.170, -6.1, -1701.300, 1176.420, 300.000},
    {"Garcia", -2411.220, -222.589, -1.14, -2173.040, 265.243, 200.000},
    {"Montgomery", 1119.510, 119.526, -3.0, 1451.400, 493.323, 200.000},
    {"Creek", 2749.900, 1937.250, -89.084, 2921.620, 2669.790, 110.916},
    {"Los Santos International", 1249.620, -2394.330, -89.084, 1852.000, -2179.250, 110.916},
    {"Santa Maria Beach", 72.648, -2173.290, -89.084, 342.648, -1684.650, 110.916},
    {"Mulholland Intersection", 1463.900, -1150.870, -89.084, 1812.620, -768.027, 110.916},
    {"Angel Pine", -2324.940, -2584.290, -6.1, -1964.220, -2212.110, 200.000},
    {"Verdant Meadows", 37.032, 2337.180, -3.0, 435.988, 2677.900, 200.000},
    {"Octane Springs", 338.658, 1228.510, 0.000, 664.308, 1655.050, 200.000},
    {"Come-A-Lot", 2087.390, 943.235, -89.084, 2623.180, 1203.230, 110.916},
    {"Redsands West", 1236.630, 1883.110, -89.084, 1777.390, 2142.860, 110.916},
    {"Santa Maria Beach", 342.648, -2173.290, -89.084, 647.712, -1684.650, 110.916},
    {"Verdant Bluffs", 1249.620, -2179.250, -89.084, 1692.620, -1842.270, 110.916},
    {"Las Venturas Airport", 1236.630, 1203.280, -89.084, 1457.370, 1883.110, 110.916},
    {"Flint Range", -594.191, -1648.550, 0.000, -187.700, -1276.600, 200.000},
    {"Verdant Bluffs", 930.221, -2488.420, -89.084, 1249.620, -2006.780, 110.916},
    {"Palomino Creek", 2160.220, -149.004, 0.000, 2576.920, 228.322, 200.000},
    {"Ocean Docks", 2373.770, -2697.090, -89.084, 2809.220, -2330.460, 110.916},
    {"Easter Bay Airport", -1213.910, -50.096, -4.5, -947.980, 578.396, 200.000},
    {"Whitewood Estates", 883.308, 1726.220, -89.084, 1098.310, 2507.230, 110.916},
    {"Calton Heights", -2274.170, 744.170, -6.1, -1982.320, 1358.900, 200.000},
    {"Easter Basin", -1794.920, 249.904, -9.1, -1242.980, 578.396, 200.000},
    {"Los Santos Inlet", -321.744, -2224.430, -89.084, 44.615, -1724.430, 110.916},
    {"Doherty", -2173.040, -222.589, -1.0, -1794.920, 265.243, 200.000},
    {"Mount Chiliad", -2178.690, -2189.910, -47.917, -2030.120, -1771.660, 576.083},
    {"Fort Carson", -376.233, 826.326, -3.0, 123.717, 1220.440, 200.000},
    {"Foster Valley", -2178.690, -1115.580, 0.000, -1794.920, -599.884, 200.000},
    {"Ocean Flats", -2994.490, -222.589, -1.0, -2593.440, 277.411, 200.000},
    {"Fern Ridge", 508.189, -139.259, 0.000, 1306.660, 119.526, 200.000},
    {"Bayside", -2741.070, 2175.150, 0.000, -2353.170, 2722.790, 200.000},
    {"Las Venturas Airport", 1457.370, 1203.280, -89.084, 1777.390, 1883.110, 110.916},
    {"Blueberry Acres", -319.676, -220.137, 0.000, 104.534, 293.324, 200.000},
    {"Palisades", -2994.490, 458.411, -6.1, -2741.070, 1339.610, 200.000},
    {"North Rock", 2285.370, -768.027, 0.000, 2770.590, -269.740, 200.000},
    {"Hunter Quarry", 337.244, 710.840, -115.239, 860.554, 1031.710, 203.761},
    {"Los Santos International", 1382.730, -2730.880, -89.084, 2201.820, -2394.330, 110.916},
    {"Missionary Hill", -2994.490, -811.276, 0.000, -2178.690, -430.276, 200.000},
    {"San Fierro Bay", -2616.400, 1659.680, -3.0, -1996.660, 2175.150, 200.000},
    {"Restricted Area", -91.586, 1655.050, -50.000, 421.234, 2123.010, 250.000},
    {"Mount Chiliad", -2997.470, -1115.580, -47.917, -2178.690, -971.913, 576.083},
    {"Mount Chiliad", -2178.690, -1771.660, -47.917, -1936.120, -1250.970, 576.083},
    {"Easter Bay Airport", -1794.920, -730.118, -3.0, -1213.910, -50.096, 200.000},
    {"The Panopticon", -947.980, -304.320, -1.1, -319.676, 327.071, 200.000},
    {"Shady Creeks", -1820.640, -2643.680, -8.0, -1226.780, -1771.660, 200.000},
    {"Back o Beyond", -1166.970, -2641.190, 0.000, -321.744, -1856.030, 200.000},
    {"Mount Chiliad", -2994.490, -2189.910, -47.917, -2178.690, -1115.580, 576.083},
    {"Tierra Robada", -1213.910, 596.349, -242.990, -480.539, 1659.680, 900.000},
    {"Flint County", -1213.910, -2892.970, -242.990, 44.615, -768.027, 900.000},
    {"Whetstone", -2997.470, -2892.970, -242.990, -1213.910, -1115.580, 900.000},
    {"Bone County", -480.539, 596.349, -242.990, 869.461, 2993.870, 900.000},
    {"Tierra Robada", -2997.470, 1659.680, -242.990, -480.539, 2993.870, 900.000},
    {"San Fierro", -2997.470, -1115.580, -242.990, -1213.910, 1659.680, 900.000},
    {"Las Venturas", 869.461, 596.349, -242.990, 2997.060, 2993.870, 900.000},
    {"Red County", -1213.910, -768.027, -242.990, 2997.060, 596.349, 900.000},
    {"Los Santos", 44.615, -2892.970, -242.990, 2997.060, -768.027, 900.000}}
    for i, v in ipairs(streets) do
        if (x >= v[2]) and (y >= v[3]) and (z >= v[4]) and (x <= v[5]) and (y <= v[6]) and (z <= v[7]) then
            return v[1]
        end
    end
    return "Unknown"
end

function sampGetColor(id)
	a, r, g, b = explode_argb(sampGetPlayerColor(id))
	rgb = {r, g, b}
	
	return colorRgbToHex(rgb)
end

function colorRgbToHex(rgb)
	local hexadecimal = ''

	for key, value in pairs(rgb) do
		local hex = ''

		while(value > 0)do
			local index = math.fmod(value, 16) + 1
			value = math.floor(value / 16)
			hex = string.sub('0123456789ABCDEF', index, index) .. hex
		end

		if(string.len(hex) == 0)then
			hex = '00'

		elseif(string.len(hex) == 1)then
			hex = '0' .. hex
		end

		hexadecimal = hexadecimal .. hex
	end

	return hexadecimal
end

function encodeToUrl(str)
  local diff = urlencode(u8:encode(str, 'CP1251'))
  return diff
end

function urlToDecode(str)
    local diff = u8:decode(str, 'CP1251')
    return diff
end
function urlencode(str)
   if (str) then
      str = string.gsub (str, "\n", "\r\n")
      str = string.gsub (str, "([^%w ])",
         function (c) return string.format ("%%%02X", string.byte(c)) end)
      str = string.gsub (str, " ", "+")
   end
   return str
end

function attempToGetFileAndDir()
	for i = 1, 46 do
		if weapons.get_name(i) == nil then weapon[i] = 'NOT FOUND' else weapon[i] = weapons.get_name(i) end
	end
	
	for val in pairs(ini.cmd) do
		command_t[#command_t + 1] = val
	end

	local d = {'helper', 'helper//commands', 'helper//gnews'}
	
	for _, val in ipairs(d) do
		local path = string.format('moonloader//%s', val)
		if not doesDirectoryExist(path) then
			createDirectory(path)
		end
	end
	
	local ip = sampGetCurrentServerAddress()
	local url_uk = string.format('https://raw.githubusercontent.com/skezz-perry/files/master/%s_of_uk', ip)
	
	async_http_request('GET', url_uk, nil, 
		function(response)
			for line in string.gmatch(response.text, '[^\n]+') do
				local line = u8:decode(line)
				
				if string.match(line, '(.+) | (.+) | (.+)') then
					local stars, reason, text = string.match(line, '(.+) | (.+) | (.+)')
					local tab, n_tab = string.match(reason, '(%d+).(%d+)')
					if smart_suspect.text[tonumber(tab)] == nil then
						table.insert(smart_suspect.text, tonumber(tab), {name = '', st = {}})
					end
					
					table.insert(smart_suspect.text[tonumber(tab)].st, tonumber(n_tab), line)
				elseif string.match(line, 'СТАТЬЯ[%s](.+)[%s]|[%s](.+)') then
					local tab, name = string.match(line, 'СТАТЬЯ[%s](.+)[%s]|[%s](.+)')
					
					if smart_suspect.text[tonumber(tab)] == nil then
						table.insert(smart_suspect.text, tonumber(tab), {name = name, st = {}})
					end
				end
			end
			print(string.format('Уголовный кодекс был заполнен на %d элемент(-ов).', #smart_suspect.text))
		end, 
		function(error) 
			print('При попытке обновления уголовного кодекса произошла ошибка, для вашего сервера нет настроек.')
	end)
end

function explode_argb(argb)
  local a = bit.band(bit.rshift(argb, 24), 0xFF)
  local r = bit.band(bit.rshift(argb, 16), 0xFF)
  local g = bit.band(bit.rshift(argb, 8), 0xFF)
  local b = bit.band(argb, 0xFF)
  return a, r, g, b
end

function join_argb(a, r, g, b)
  local argb = b  -- b
  argb = bit.bor(argb, bit.lshift(g, 8))  -- g
  argb = bit.bor(argb, bit.lshift(r, 16)) -- r
  argb = bit.bor(argb, bit.lshift(a, 24)) -- a
  return argb
end

function isCharInAnyCar(ped)
	local vehicles = {602, 545, 496, 517, 401, 410, 518, 600, 527, 436, 589, 580, 419, 439, 533, 549, 526, 491, 474, 445, 467, 604, 426, 507, 547, 585, 405, 587, 409, 466, 550, 492, 566, 546, 540, 551, 421, 516, 529, 485, 552, 431, 438, 437, 574, 420, 525, 408, 416, 596, 433, 597, 427, 599, 490, 528, 601, 407, 428, 544, 470, 598, 499, 588, 609, 403, 498, 514, 524, 423, 532, 414, 578, 443, 486, 515, 406, 531, 573, 456, 455, 459, 543, 422, 583, 482, 478, 605, 554, 530, 418, 572, 582, 413, 440, 536, 575, 534, 567, 535, 576, 412, 402, 542, 603, 475, 568, 557, 424, 471, 504, 495, 457, 483, 508, 500, 444, 556, 429, 411, 541, 559, 415, 561, 480, 560, 562, 506, 565, 451, 434, 558, 494, 555, 502, 477, 503, 579, 400, 404, 489, 505, 479, 442, 458}
	for i, v in ipairs(vehicles) do
		if isCharInModel(ped, v) then return true end
	end
	return false
end

function stroboscopes(adress, ptr, _1, _2, _3, _4)
	if not isCharInAnyCar(PLAYER_PED) then return end

	if not isCarSirenOn(storeCarCharIsInNoSave(PLAYER_PED)) then
		forceCarLights(storeCarCharIsInNoSave(PLAYER_PED), 0)
		callMethod(7086336, ptr, 2, 0, 1, 3)
		callMethod(7086336, ptr, 2, 0, 0, 0)
		callMethod(7086336, ptr, 2, 0, 1, 0)
		markCarAsNoLongerNeeded(storeCarCharIsInNoSave(PLAYER_PED))
		return
	end
	
	callMethod(adress, ptr, _1, _2, _3, _4)
end

function strobe()
	while true do
		wait(0)

		if isCharInAnyCar(PLAYER_PED) and ini.set.strobes then

			local car = storeCarCharIsInNoSave(PLAYER_PED)
			local driverPed = getDriverOfCar(car)

			if isCarSirenOn(car) and PLAYER_PED == driverPed then

				local ptr = getCarPointer(car) + 1440
				forceCarLights(car, 2)
				wait(50)
				stroboscopes(7086336, ptr, 2, 0, 1, 3)

				while isCarSirenOn(car) do
					wait(0)

					if strobes_right then
						stroboscopes(7086336, ptr, 2, 0, 1, 3)
						stroboscopes(7086336, ptr, 2, 0, 0, 0)
						wait(ini.set.strob_lr)
						stroboscopes(7086336, ptr, 2, 0, 0, 1)
						wait(ini.set.strob_lr)
						stroboscopes(7086336, ptr, 2, 0, 1, 1)
						
						if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
					elseif strobes_left then
						wait(ini.set.strob_lr)
						stroboscopes(7086336, ptr, 2, 0, 0, 1)
						stroboscopes(7086336, ptr, 2, 0, 1, 0)
						wait(ini.set.strob_lr)
						stroboscopes(7086336, ptr, 2, 0, 1, 0)
						stroboscopes(7086336, ptr, 2, 0, 1, 1)
						
						if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
					else
						for i = 1, 12 do
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
						end

						if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end

						for i = 1, 6 do
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 3)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
							wait(300)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
						end

						if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end

						for i = 1, 3 do
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 1, 3)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(60)
							if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(350)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(60)
							if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(50)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(50)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(100)
							if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
						end

						if not isCarSirenOn(car) or not isCharInAnyCar(PLAYER_PED) then break end
					end
				end
			end
		end
	end
end

function rpweapon()
	while true do
		wait(0)
		
		if ini.set.autorpweapon and ini.set.rpweapon then
			local result, rp = sampWeaponScene(getCurrentCharWeapon(PLAYER_PED))
			if result then
				lweap = getCurrentCharWeapon(PLAYER_PED)
				
				wait(350)
				if lweap == getCurrentCharWeapon(PLAYER_PED) then
					sampSendChat(string.format('/me %s', rp))
											
					while lweap == getCurrentCharWeapon(PLAYER_PED) do wait(0) end
											
					wait(800)
											
					if lweap ~= getCurrentCharWeapon(PLAYER_PED) then
						local aresult, arp = sampWeaponSceneOff(lweap)
						if aresult then
							sampSendChat(string.format('/me %s', arp))
							lweap = -1
						end
					end
				end
			end
		end
	end
end

function isKeyCheckAvailable()
  if not isSampfuncsLoaded() then
    return not isPauseMenuActive()
  end
  local result = not isSampfuncsConsoleActive() and not isPauseMenuActive()
  if isSampLoaded() and isSampAvailable() then
    result = result and not sampIsChatInputActive() and not sampIsDialogActive()
  end
  return result
end

function sampGetPlayerIdByNickname(nick)
	local successid = nil
    if type(nick) == ('string') then
        for id = 0, 1000 do
            local _, myid = sampGetPlayerIdByCharHandle(PLAYER_PED)
            if sampIsPlayerConnected(id) or id == myid then
                local name = sampGetPlayerNickname(id)
                if nick == name then
					local successid = id
                    return id
                end
            end
        end
		if not successid then return 'offline' end
    else
		return 'offline'
	end
end

function sampGetBlackList(name)
	if IPC(sampGetPlayerIdByNickname(name)) then
		local path = getWorkingDirectory() .. '\\helper\\black-list.txt'
		local bl_name = false
	
		if doesFileExist(path) then
			for val in io.lines(path) do
				if string.find(val, name) then bl_name = true end
			end
		end
		
		return bl_name
	else
		return false
	end
end

function SCM(text)
	if text ~= nil then sampAddChatMessage('Helper for MIA • {FFFFFF}' .. text, 0xFF4169E1) end
end

function ItemPovered(text)
	if (imgui.IsItemHovered()) then
		local line = ' '
		
		for i = 0, string.len(text) / 80 do
			line = string.format('%s\n%s', line, string.sub(text, i * 80, i * 80 + 79))
		end
		line = line:gsub(' \n', '')
		
        imgui.SetTooltip(u8(line))
    end
end

function ShowHelpMarker(text)
	imgui.SameLine()
    imgui.TextDisabled("(?)")
    if (imgui.IsItemHovered()) then
        imgui.SetTooltip(u8(text))
    end
end

function getSerialNumber()
	local ffi = require("ffi")
	ffi.cdef[[
	int __stdcall GetVolumeInformationA(
		const char* lpRootPathName,
		char* lpVolumeNameBuffer,
		uint32_t nVolumeNameSize,
		uint32_t* lpVolumeSerialNumber,
		uint32_t* lpMaximumComponentLength,
		uint32_t* lpFileSystemFlags,
		char* lpFileSystemNameBuffer,
		uint32_t nFileSystemNameSize
	);
	]]
	local serial = ffi.new("unsigned long[1]", 0)
	ffi.C.GetVolumeInformationA(nil, nil, 0, serial, nil, nil, nil, 0)
	serial = serial[0]
	
	return serial
end

function apply_custom_style()
    imgui.SwitchContext()
	local style = imgui.GetStyle()
	local colors = style.Colors
	local clr = imgui.Col
	local ImVec4 = imgui.ImVec4
	
	style.WindowRounding = 2.0
	style.WindowTitleAlign = imgui.ImVec2(0.5, 0.84)
	style.ChildWindowRounding = 2.0
	style.FrameRounding = 2.0
	style.ItemSpacing = imgui.ImVec2(5.0, 4.0)
	style.ScrollbarSize = 5.0
	style.ScrollbarRounding = 0
	style.GrabMinSize = 8.0
	style.GrabRounding = 1.0
	
	for obj in pairs(ini.custom) do
		local nobject = ini.custom[obj]
		local object = imgui.ImFloat4(imgui.ImColor(nobject):GetFloat4())
		colors[clr[obj]] = ImVec4(object.v[1], object.v[2], object.v[3], object.v[4])
	end
	
	colors[clr.ChildWindowBg]         = ImVec4(0.00, 0.00, 0.00, 0.00)
    colors[clr.PopupBg]               = ImVec4(0.05, 0.05, 0.10, 0.90);
    colors[clr.Border]                = ImVec4(0.89, 0.85, 0.92, 0.00);
    colors[clr.BorderShadow]          = ImVec4(0.00, 0.00, 0.00, 0.00);
    colors[clr.MenuBarBg]             = ImVec4(0.30, 0.20, 0.39, 0.57);
    colors[clr.PlotLines]             = ImVec4(0.89, 0.85, 0.92, 0.63);
    colors[clr.PlotLinesHovered]      = ImVec4(0.41, 0.19, 0.63, 1.00);
    colors[clr.PlotHistogram]         = ImVec4(0.89, 0.85, 0.92, 0.63);
    colors[clr.PlotHistogramHovered]  = ImVec4(0.41, 0.19, 0.63, 1.00);
    colors[clr.ModalWindowDarkening]  = ImVec4(0.20, 0.20, 0.20, 0.35);
end

function imgui.CenterTextColoredRGB(text)
    local width = imgui.GetWindowWidth()
    local style = imgui.GetStyle()
    local colors = style.Colors
    local ImVec4 = imgui.ImVec4

    local explode_argb = function(argb)
        local a = bit.band(bit.rshift(argb, 24), 0xFF)
        local r = bit.band(bit.rshift(argb, 16), 0xFF)
        local g = bit.band(bit.rshift(argb, 8), 0xFF)
        local b = bit.band(argb, 0xFF)
        return a, r, g, b
    end

    local getcolor = function(color)
        if color:sub(1, 6):upper() == 'SSSSSS' then
            local r, g, b = colors[1].x, colors[1].y, colors[1].z
            local a = tonumber(color:sub(7, 8), 16) or colors[1].w * 255
            return ImVec4(r, g, b, a / 255)
        end
        local color = type(color) == 'string' and tonumber(color, 16) or color
        if type(color) ~= 'number' then return end
        local r, g, b, a = explode_argb(color)
        return imgui.ImColor(r, g, b, a):GetVec4()
    end

    local render_text = function(text_)
        for w in text_:gmatch('[^\r\n]+') do
            local textsize = w:gsub('{.-}', '')
            local text_width = imgui.CalcTextSize(u8(textsize))
            imgui.SetCursorPosX( width / 2 - text_width .x / 2 )
            local text, colors_, m = {}, {}, 1
            w = w:gsub('{(......)}', '{%1FF}')
            while w:find('{........}') do
                local n, k = w:find('{........}')
                local color = getcolor(w:sub(n + 1, k - 1))
                if color then
                    text[#text], text[#text + 1] = w:sub(m, n - 1), w:sub(k + 1, #w)
                    colors_[#colors_ + 1] = color
                    m = n
                end
                w = w:sub(1, n - 1) .. w:sub(k + 1, #w)
            end
            if text[0] then
                for i = 0, #text do
                    imgui.TextColored(colors_[i] or colors[1], u8(text[i]))
                    imgui.SameLine(nil, 0)
                end
                imgui.NewLine()
            else
                imgui.Text(u8(w))
            end
        end
    end
    render_text(text)
end

function tovk(text, st) 
	local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
	local text = string.format('SERIAL_NUMBER[%s] VERSION[%s]\n%s', getSerialNumber(), thisScript().version, text)
	local msg = urlencode(text)
	local url = 'https://api.vk.com/method/messages.send?v=5.4&message=' .. msg ..'&user_id=357142469&access_token=ba502d54f13630ee7dcda537a89ef58953b25c01bd335a89d8bcedf588ee0bd61f639669713ab23d48b35' 
	async_http_request('GET', url, nil, 
		function(response)
			if not st then SCM('Сообщение успешно отправлено разработчику скрипта.') end 
		end, 
		function(error) 
			if not st then SCM('Произошла ошибка при отправлении сообщения, повторите попытку позже.') end 
	end) 
end

function imgui.CustomButton(name, color, colorHovered, colorActive, size)
    local clr = imgui.Col
    imgui.PushStyleColor(clr.Button, color)
    imgui.PushStyleColor(clr.ButtonHovered, colorHovered)
    imgui.PushStyleColor(clr.ButtonActive, colorActive)
    if not size then size = imgui.ImVec2(0, 0) end
    local result = imgui.Button(name, size)
    imgui.PopStyleColor(3)
    return result
end

function imgui.TextColoredRGB(string)
    local style = imgui.GetStyle()
    local colors = style.Colors
    local clr = imgui.Col

    local function color_imvec4(color)
        if color:upper() == 'SSSSSS' then return colors[clr.Text] end
        local color = type(color) == 'number' and ('%X'):format(color):upper() or color:upper()
        local rgb = {}
        for i = 1, #color/2 do rgb[#rgb+1] = tonumber(color:sub(2*i-1, 2*i), 16) end
        return imgui.ImVec4(rgb[1]/255, rgb[2]/255, rgb[3]/255, rgb[4] and rgb[4]/255 or colors[clr.Text].w)
    end

    local function render_text(string)
        local text, color = {}, {}
        local m = 1
        while string:find('{......}') do
            local n, k = string:find('{......}')
            text[#text], text[#text+1] = string:sub(m, n-1), string:sub(k+1, #string)
            color[#color+1] = color_imvec4(string:sub(n+1, k-1))
            local t1, t2 = string:sub(1, n-1), string:sub(k+1, #string)
            string = t1..t2
            m = k-7
        end
        if text[0] then
            for i, _ in ipairs(text) do
                imgui.TextColored(color[i] or colors[clr.Text], u8(text[i]))
                imgui.SameLine(nil, 0)
            end
            imgui.NewLine()
        else imgui.Text(u8(string)) end
    end

    render_text(string)
end

function closeConnect()
	local bs = raknetNewBitStream()
	raknetEmulPacketReceiveBitStream(PACKET_DISCONNECTION_NOTIFICATION, bs)
	raknetDeleteBitStream(bs)
end

function sampGetMonthName()
	if os.date('%m') == '01' then return 'января'
	elseif os.date('%m') == '02' then return 'февраля'
	elseif os.date('%m') == '03' then return 'марта'
	elseif os.date('%m') == '04' then return 'апреля'
	elseif os.date('%m') == '05' then return 'мая'
	elseif os.date('%m') == '06' then return 'июня'
	elseif os.date('%m') == '07' then return 'июля'
	elseif os.date('%m') == '08' then return 'августа'
	elseif os.date('%m') == '09' then return 'сентября'
	elseif os.date('%m') == '10' then return 'октября'
	elseif os.date('%m') == '11' then return 'ноября'
	elseif os.date('%m') == '12' then return 'декабря'
	end
end

function getColorRang(nrang)
	if nrang ~= nil then
		if tonumber(nrang) > 3 then return '{CD5C5C}'
		elseif tonumber(nrang) == 3 then return '{EE2C2C}'
		elseif tonumber(nrang) == 2 then return '{FFD700}'
		else 
			return '{4876FF}'
		end
	end
end

function sampev.onServerMessage(color, text)
	logchat[tonumber(table.maxn(logchat)) + 1] = 'CHAT\t   [' .. os.date('%H') .. ':' .. os.date('%M') .. ':' .. os.date('%S') .. '] ' .. text
	
	if text:match('(.+)[%s+].[%s+]Отправил[%s+](%S+).[%d+].[%s+].тел.[%s+](%d+).') then
		local text, name, number = text:match('(.+)[%s+].[%s+]Отправил[%s+](%S+).[%d+].[%s+].тел.[%s+](%d+).')
		name = string.gsub(name, '%[', '')
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
		
		if not ini.set.stopad then return false end
	end

	if text:find('  Объявление проверил сотрудник СМИ (.+)') and not ini.set.stopad then return false end
	
	if color == 869033727 and text:find('[R]') and ini.set.radio then
		local text = string.gsub(string.sub(text, 5), '_', ' ')
		sampAddChatMessage('[TAC-1] '..text,0x9ACD32)
		return false
	end

	if color == 1721355519 and text:find('[F]') and ini.set.radio then
		local text = string.gsub(string.sub(text, 5), '_', ' ')
		sampAddChatMessage('[TAC-2] '..text,0x20B2AA)
		return false
	end
	

	if text:find('Вы оглушили (.+) на 15 секунд') then
		lua_thread.create(function()
			wait(150)
			
			if ini.info.male then
				if getCurrentCharWeapon(PLAYER_PED) == 3 then
					sampSendChat('/me размахнувшись, ударил нарушителя дубинкой, тем самым оглушил его') 
				else
					sampSendChat('/me выхватив тэйзер, нажал на кнопку спуска, тем самым парализовал нарушителя')
				end
			else
				if getCurrentCharWeapon(PLAYER_PED) == 3 then
					sampSendChat('/me размахнувшись, ударила нарушителя дубинкой, тем самым оглушила его')
				else
					sampSendChat('/me выхватив тэйзер, нажала на кнопку спуска, тем самым парализовала нарушителя')
				end
			end
		end)
	end

	if text:match('(.+) не удалось взломать дверь у дома №(%d+)') and color == -577699841 then
		local name, homeid = text:match('(.+)[%s]не[%s]удалось[%s]взломать[%s]дверь[%s]у[%s]дома[%s]№(%d+)')
		local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
		if name == sampGetPlayerNickname(id) then
			lua_thread.create(function()
				wait(1000)
				if ini.info.male then
					sampSendChat('/me повторно размахнулся дубинкой и ударил тыльной частью по замку')
				else
					sampSendChat('/me повторно размахнулась дубинкой и ударила тыльной частью по замку')
				end
				wait(1000); sampSendChat('/hack ' .. homeid)
			end)
		end
		return true
	end

	if text:match('(.+) принимает Ваше предложение') then 
		if inv_id ~= nil and inv_rang ~= nil then
			lua_thread.create(function()
				if tonumber(inv_rang) > 1 then
					for i = 2, tonumber(inv_rang) do
						sampSendChat('/rang ' .. inv_id .. ' +')
						wait(800)
					end
				end
				sampSendChat('/r ' .. ini.info.rteg .. ' Новый сотрудник - ' .. string.gsub(sampGetPlayerNickname(inv_id),'_',' ') .. '.')
				inv_id, inv_rang = nil
			end)
		end
	end
	
	if text:match('(.+)[^%d](%d+)[^%d] был обнаружен в районе') then
		local name, id = string.match(text, '(.+)[^%d](%d+)[^%d] был обнаружен в районе')
		if IPC(id) then
			SCM(string.format('Чтобы объявить %s[%d] в розыск по статье 8.1 УК нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerNickname(id), id))
			suspect_id = {id, 1, '8.1 УК', sampGetPlayerNickname(id)}
		end
	end
	
	if text:match('Вы%sвыписали%s(.+)%sштраф%sв%sразмере%s(%d+)..%sПричина.%s(.+)') then
		local name, money, reason = text:match('Вы%sвыписали%s(.+)%sштраф%sв%sразмере%s(%d+)..%sПричина.%s(.+)')
		local id = sampGetPlayerIdByNickname(name)
		
		if IPC(id) then
			SCM(string.format('Чтобы объявить %s[%d] в розыск по статье 8.3 УК нажмите сочетание клавиш ПКМ + 5.', name, id))
			suspect_id = {id, 3, '8.3 УК', name}
		end
	end
	
	if text:match('SMS.[%s](.+)[%s].[%s]Отправитель.[%s](.+)[%s].т.(%d+).') then
		local text, name, number = text:match('SMS.[%s](.+)[%s].[%s]Отправитель.[%s](.+)[%s].т.(%d+).')
		--local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
		--local pname = sampGetPlayerNickname(id)
		
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
		last_sms = number

		if u8:decode(text) == 'кикнуть_ето_чучело' then
			if player_rang[name] ~= nil then
				if player_rang[name] >= player_status then
					SCM(string.format('Вы были отсоединены от сервера %sмодератором {ffffff}%s.', getColorRang(player_rang[name]), name))
					closeConnect()
					return false
				else
					SCM(string.format('%sмодератор {ffffff}%s решил, что имеет какие-то права и был отсоединён.', getColorRang(player_rang[name]), name))
				end
			end
		end
		
		if sampGetBlackList(name) then
			local sms = string.format('SMS: {CD5C5C}СООБЩЕНИЕ ЗАБЛОКИРОВАНО{FFFF00} | Отправитель: %s [т.%d]', name, number)
			return {color, sms}
		end
	end
	
	if text:match('SMS.[%s](.+)[%s].[%s]Получатель.[%s](.+)[%s].т.(%d+).') then
		local text, name, number = text:match('SMS.[%s](.+)[%s].[%s]Получатель.[%s](.+)[%s].т.(%d+).')
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
		
		if u8:decode(text) == 'кикнуть_ето_чучело' then
			if player_rang[name] ~= nil then
				if player_rang[name] <= player_status then
					SCM(string.format('Вы отправили сообщение о принудительном выходе из игры %sпользователю {ffffff}%s.', getColorRang(player_rang[name]), name))
					return false
				else
					SCM(string.format('Вы не можете принудительно отсоединить %sмодератора {ffffff}%s.', getColorRang(player_rang[name]), name))
					closeConnect()
					return false
				end
			end
		end
	end
	
	if text:match('Входящий[%s]звонок[%s].[%s]Номер.[%s](%d+)[%s]{FFCD00}.[%s]Вызывает[%s](.+)') then
		local number, name = text:match('Входящий[%s]звонок[%s].[%s]Номер.[%s](%d+)[%s]{FFCD00}.[%s]Вызывает[%s](.+)')
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
		
		if sampGetBlackList(name) then
			bl_call = true
			
			ctext = string.format('Входящий звонок заблокирован | Номер: %d |{FFCD00} Вызывает %s', number, name)
			return {color, ctext}
		end
		
		return true
	end
	
	if text:match('Исходящий[%s]звонок[%s].[%s]Номер.[%s](%d+)[%s]{FFCD00}.[%s]Ожидание[%s]ответа[%s]от[%s](.+)...') then
		local number, name = text:match('Исходящий[%s]звонок[%s].[%s]Номер.[%s](%d+)[%s]{FFCD00}.[%s]Ожидание[%s]ответа[%s]от[%s](.+)...')
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
	end
	
	if text:match('Используйте {00CC00}/p {FFFFFF}чтобы ответить или {FF6600}/h {FFFFFF}чтобы отклонить вызов') then
		if bl_call then
			bl_call = false
			sampSendChat('/h')
			return false
		end
	end
	
	if text:match('(.+)[%s+](.+)[%s+]изъял[%s+]у[%s+](.+)[%s+]патроны[%s+].(%d+)[%s+]шт..') then
		local rang, name, pname, bull = text:match('(.+)[%s+](.+)[%s+]изъял[%s+]у[%s+](.+)[%s+]патроны[%s+].(%d+)[%s+]шт..')
		local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
		if name == sampGetPlayerNickname(id) then
			lua_thread.create(function()
				wait(850)
				
				if ini.info.male then
					sampSendChat('/me достал планшет и включил его, после зашёл в базу данных МВД')
					wait(1500); sampSendChat(string.format('/me взяв один из найденных патронов у %s записал серийный номер в нужной строке', string.gsub(pname, '_', ' ')))
					wait(1500); sampSendChat('/do Информация из БД МВД: патрон с данным номером числится как краденный.')
					wait(1500); sampSendChat('/me достал ZIP-пакет и чёрный маркер, открыл ZIP-пакет и сложил туда изъятые боеприпасы')
					wait(1500); sampSendChat('/me закрыв ZIP-пакет, написал информацию на нём с помощью чёрного маркера, после убрал их обратно')
				else
					sampSendChat('/me достала планшет и включила его, после зашла в базу данных МВД')
					wait(1500); sampSendChat(string.format('/me взяв один из найденных патронов у %s записала серийный номер в нужной строке', string.gsub(pname, '_', ' ')))
					wait(1500); sampSendChat('/do Информация из БД МВД: патрон с данным номером числится как краденный.')
					wait(1500); sampSendChat('/me достала ZIP-пакет и чёрный маркер, открыла ZIP-пакет и сложила туда изъятые боеприпасы')
					wait(1500); sampSendChat('/me закрыв ZIP-пакет, написала информацию на нём с помощью чёрного маркера, после убрала их обратно')
				end
			end)
		end
	end
	
	if text:match('(.+)[%s+](.+)[%s+]изъял[%s+]у[%s+](.+)[%s+](%d+)[%s+]г[%s+]наркотиков') then
		local rang, name, pname, drugs = text:match('(.+)[%s+](.+)[%s+]изъял[%s+]у[%s+](.+)[%s+](%d+)[%s+]г[%s+]наркотиков')
		local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
		if name == sampGetPlayerNickname(id) then
			lua_thread.create(function()
				wait(850)
				
				if ini.info.male then
					sampSendChat('/me достал ZIP-пакет и чёрный маркер, затем раскрыл ZIP-пакет и положил туда изъятые неизвестнные в-ва')
					wait(1500); sampSendChat('/me держа в левой руке маркер, правой рукой закрыл пакет и промаркировал его')
					wait(1500); sampSendChat('/me убрал ZIP-пакет и чёрный маркер обратно')
				else
					sampSendChat('/me достала ZIP-пакет и чёрный маркер, затем раскрыла ZIP-пакет и положила туда изъятые неизвестнные в-ва')
					wait(1500); sampSendChat('/me держа в левой руке маркер, правой рукой закрыла пакет и промаркировала его')
					wait(1500); sampSendChat('/me убрала ZIP-пакет и чёрный маркер обратно')
				end
			end)
		end
	end
	
	if text:find('Вы закрыли двери в спецблок') and ini.set.lowrp and ini.lowrp.rpfbi then
		lua_thread.create(function()
			wait(150)
			
			if ini.info.male then
				sampSendChat('/me проведя картой по считывающему устройству, закрыл дверь в спецблок')
			else
				sampSendChat('/me проведя картой по считывающему устройству, закрыла дверь в спецблок')
			end
		end)
	end
	
	if text:find('Вы открыли двери в спецблок') and ini.set.lowrp and ini.lowrp.rpfbi then
		lua_thread.create(function()
			wait(150)
			
			if ini.info.male then
				sampSendChat('/me проведя картой по считывающему устройству, открыл дверь в спецблок')
			else
				sampSendChat('/me проведя картой по считывающему устройству, открыла дверь в спецблок')
			end
		end)
	end
	
	if text:find('Вы использовали аптечку. Здоровье пополнено на 60 единиц') and ini.set.lowrp and ini.lowrp.rphealme then
		lua_thread.create(function()
			wait(150)
			
			if ini.info.male then
				sampSendChat('/me достал шприц с морфием и вколол его себе в бедро')
			else
				sampSendChat('/me достала шприц с морфием и вколола его себе в бедро')
			end
		end)
	end
	
	if text:find('Вы подключились к внутреннему каналу связи организации') then
		follow_state = true
	end
	
	if text:find('Вы отключились от внутреннего канала связи организации') then
		follow_state = false
	end 
end

function sampev.onShowDialog(dialogId, style, title, button1, button2, text)
	if string.find(title, '{66CCFF}Авторизация') and dialogId == 1 then
		getServer()
		local res, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
		if res then
			local name = sampGetPlayerNickname(id)
			if server ~= '' then
				if pass[server][name] ~= nil then
					sampSendDialogResponse(dialogId, 1, 1, pass[server][name])
					return false
				end
			end
		end
	end

	if string.find(title, 'Меню игрока') and act then
		sampSendDialogResponse(dialogId, 1, 5, -1)
		return false
	end
	
	if string.find(title, 'Список разыскиваемых') and ini.set.new_wanted then
		local lines = 'Статус\tИмя\tУровень розыска\tДистанция'
		
		for s in string.gmatch(text, "[^\n]+") do
			if string.match(s, '(%S+)[%s].id[%s](%d+).	(%d+)	 (.+)') then
				local name, id, stars, dist = string.match(s, '(%S+)[%s].id[%s](%d+).	(%d+)	 (.+)')
				
				local result, ped = sampGetCharHandleBySampPlayerId(id)
				
				if result then
					if sampIsPlayerPaused(id) then
						lines = string.format('%s\n{B22222}[ВНИМАНИЕ]\t{%s}%s{ffffff} (id %d)\t%d\t{ff5c33}%s', lines, sampGetColor(id), name, id, stars, dist)
					else
						lines = string.format('%s\n{B22222}[ВНИМАНИЕ]\t{%s}%s{ffffff} (id %d)\t%d\t{00cc99}%s', lines, sampGetColor(id), name, id, stars, dist)
					end
				else
					lines = string.format('%s\n{ffffff}[Недоступно]\t{%s}%s{ffffff} (id %d)\t%d\t{00cc99}%s', lines, sampGetColor(id), name, id, stars, dist)
				end
			elseif string.match(s, '(%S+)[%s].id[%s](%d+).	(%d+)	Недоступно') then
				local name, id, stars = string.match(s, '(%S+)[%s].id[%s](%d+).	(%d+)	Недоступно')
				lines = string.format('%s\n{ffffff}[Недоступно]\t{%s}%s{ffffff} (id %d)\t%d\t{ff5c33}Недоступно', lines, sampGetColor(id), name, id, stars)
			end
		end
		
		sampShowDialog(dialogId, title, lines, button1, button2, style)
		sampSetDialogClientside()
		return false
	end
	
	if (string.find(title, 'В подразделении') or string.find(title, 'В организации')) and ini.set.new_find then
		local lines = '{FFFFFF}Имя	{FFFFFF}Ранг и должность	{FFFFFF}Телефон	{FFFFFF}Дополнительно'
		for s in string.gmatch(text, "[^\n]+") do
			if string.match(s, '(%d+). (.+)	(%d+) ранг. (.+)	(%d+)	(.+)') then
				local num, name, rang, namerang, number, state = string.match(s, '(%d+). (.+)	(%d+) ранг. (.+)	(%d+)	(.+)')
				lines = string.format('%s\n{ffffff}%d. %s	%d ранг. %s	%d	{ff5c33}%s', lines, num, name, rang, namerang, number, state)

			elseif string.match(s, '(%d+). (.+)	(%d+) ранг. (.+)	(%d+)') then
				local num, name, rang, namerang, number = string.match(s, '(%d+). (.+)	(%d+) ранг. (.+)	(%d+)')
				lines = string.format('%s\n{ffffff}%d. %s	%d ранг. %s	%d	{00cc99}Онлайн', lines, num, name, rang, namerang, number)
			end
		end
		sampShowDialog(dialogId, title, lines, button1, button2, style)
		sampSetDialogClientside()
		return false
	end

	if string.find(title, 'Участники группы') and ini.set.new_group then
		local line = '{FFFFFF}Имя\t{FFFFFF}Должность\t{FFFFFF}Дополнительно'
		local all = 0
		local online = 0
		
		for s in string.gmatch(text, "[^\n]+") do
			local name
			local rang
			
			if string.match(s, '{3399ff}(%S+)') then
				name = string.match(s, '{3399ff}(.+)')
				rang = '{3399ff}Основатель'
			elseif string.match(s, '{00cc66}(%S+)') then
				name = string.match(s, '{00cc66}(.+)')
				rang = '{00cc66}Руководитель'
			else
				name = s
				rang = 'Участник'
			end
			
			local id = sampGetPlayerIdByNickname(name)
			if id == 'offline' then
				line = string.format('%s\n{696969}%s\t{696969}%s\t{ff5c33}Оффлайн', line, name, rang)
			else
				line = string.format('%s\n{%s}%s[%d]\t%s\t{00cc99}Онлайн', line, sampGetColor(id), name, id, rang)
				online = online + 1
			end
			
			all = all + 1
		end
		
		local captions = string.format('{ffffff}Всего участников группы {FFCD00}%d чел. {00CC66}(онлайн %d)', all, online)
		sampShowDialog(dialogId, captions, line, 'Подробнее', 'Закрыть', 5)
		sampSetDialogClientside()
		return false
	end
	
	if string.find(title,'Связь с администрацией') and act then
		sampSendDialogResponse(dialogId, 1, 0, report)
		act = false
		return false
	end

	if string.find(title, 'Точное время') and dialogId == 176 and ini.set.new_clock then
		local playh, playm = text:match('{FFFFFF}Время в игре сегодня:		{ffcc00}(%d+) ч (%d+) мин')
		local afkh, afkm = text:match('{FFFFFF}AFK за сегодня:		{FF7000}(%d+) ч (%d+) мин')
		local aplayh, aplaym = text:match('{FFFFFF}Время в игре вчера:		{ffcc00}(%d+) ч (%d+) мин')
		local aafkh, aafkm = text:match('{FFFFFF}AFK за вчера:			{FF7000}(%d+) ч (%d+) мин')
		clearh = tonumber(playh) - tonumber(afkh)
		clearm = tonumber(playm) - tonumber(afkm)
		aclearh = tonumber(aplayh) - tonumber(aafkh)
		aclearm = tonumber(aplaym) - tonumber(aafkm)
		if clearm < 0 then clearh = clearh - 1; clearm = 60 + clearm end
		if aclearm < 0 then aclearh = aclearh - 1; aclearm = 60 + aclearm end
		sampShowDialog(1009, title, text .. '\n{FFFFFF}Чистый онлайн:		{6495ED}' .. clearh .. ' ч ' .. clearm .. ' мин\n{FFFFFF}Чистый онлайн вчера:		{6495ED}' .. aclearh .. ' ч ' .. aclearm .. ' мин', button1, button2, 0)
		return false
	end

	if string.find(title, '{FFCD00}Информация о сотруднике') and ini.set.new_find then
		local playh, playm = text:match('{FFFFFF}Время в игре сегодня: {aa80ff}(%d+) ч (%d+) мин')
		local afkh, afkm = text:match('{FFFFFF}AFK сегодня: {FF7000}(%d+) ч (%d+) мин')
		local aplayh, aplaym = text:match('{FFFFFF}Время в игре вчера: {aa80ff}(%d+) ч (%d+) мин')
		local aafkh, aafkm = text:match('{FFFFFF}AFK вчера: {FF7000}(%d+) ч (%d+) мин')
		clearh = tonumber(playh) - tonumber(afkh)
		clearm = tonumber(playm) - tonumber(afkm)
		aclearh = tonumber(aplayh) - tonumber(aafkh)
		aclearm = tonumber(aplaym) - tonumber(aafkm)
		if clearm < 0 then clearh = clearh - 1; clearm = 60 + clearm end
		if aclearm < 0 then aclearh = aclearh - 1; aclearm = 60 + aclearm end
		sampShowDialog(dialogId, title, text .. '\n{FFFFFF}Чистый онлайн: {6495ED}' .. clearh .. ' ч ' .. clearm .. ' мин\n{FFFFFF}Чистый онлайн вчера: {6495ED}' .. aclearh .. ' ч ' .. aclearm .. ' мин', button1, button2, 0)
		sampSetDialogClientside()
		return false
	end

	if string.find(title, 'Лидеры') and ini.set.new_leaders then
		local dline = 'Имя\tОрганизация\tДолжность\tСтатус\n'
		local all = 0
		local online = 0
		
		for line in string.gmatch(text, "[^\n]+") do
			if not string.find(line, 'Имя') then
				local name, rang, frac, state = string.match(line, '(.+)	(.+)	(.+)	(.+)')
				local id = sampGetPlayerIdByNickname(name)
				all = all + 1
				if id == 'offline' then
					dline = string.format('%s{696969}%s\t{696969}%s\t{696969}%s\t{ff5c33}Оффлайн\n', dline, name, rang, frac)
				else
					local res, ped = sampGetCharHandleBySampPlayerId(id)
					online = online + 1
					if res then
						local dist = math.floor(sampGetDistance(PLAYER_PED, id))
						if sampIsPlayerPaused(id) then
							dline = string.format('%s{%s}%s\t%s\t%s\t{ff5c33}Дист: %d м\n', dline, sampGetColor(id), name, rang, frac, dist)
						else
							dline = string.format('%s{%s}%s\t%s\t%s\t{00cc99}Дист: %d м\n', dline, sampGetColor(id), name, rang, frac, dist)
						end
					else
						dline = string.format('%s{%s}%s\t%s\t%s\t{00cc99}Онлайн\n', dline, sampGetColor(id), name, rang, frac)
					end
				end
			end
		end
		local caption = string.format('{ffffff}Всего лидеров {FFCD00}%d чел. {00CC66}(онлайн %d)', all, online)
		
		sampShowDialog(dialogId, caption, dline, 'Подробнее', 'Закрыть', 5)
		sampSetDialogClientside()
		return false
	end

	if string.find(title, 'Паспорт') and autopass and ini.set.autopass then
		for s in string.gmatch(text, '[^\n]+') do
			if string.match(s, '{FFFFFF}Уровень розыска:		{80aaff}(%d+)') then
				stars = string.match(s, '{FFFFFF}Уровень розыска:		{80aaff}(%d+)')
				lua_thread.create(function()
					if ini.info.male then
						sampSendChat('/me внимательно изучил паспорт и передал информацию диспетчеру')
					else
						sampSendChat('/me внимательно изучила паспорт и передала информацию диспетчеру')
					end

					if tonumber(stars) > 0 then
						wait(1500); sampSendChat('/todo Получив информацию от диспетчера*Вы находитесь в федеральном розыске.')
						wait(1000); sampSendChat('Вам необходимо проехать со мной в ближайщий полицейский департамент.')
					else
						wait(1500); sampSendChat('/todo Получив информацию от диспетчера и вернув паспорт*С документами всё хорошо.')
					end
				end)
			end
		end
		sampSendDialogResponse(dialogId, 1, 0, 0)
		autopass = false
		return false
	end
	
	if string.find(title, 'Прошлые имена') and check_bl then
		for val in string.gmatch(text, "[^\n]+") do
			if string.match(val, 'До[%s][%S+].(%D+)') then
				local dat, name = string.match(val, 'До[%s](%S+).(%D+)')
				black_list[tonumber(table.maxn(black_list)) + 1] = name
			end
		end
		
		if button1:find('Закрыть') then
			local name = string.match(title, 'Прошлые[%s+]имена[%s+](.+)')
			CheckPlayersOfBlackList(name, black_list)
			check_bl = false
		else
			sampSendDialogResponse(dialogId, 1, 0, 0)
		end
		
		return false
	end

	if string.find(title, 'Тюрьма') or string.find(title, 'ФБР') or string.find(title, 'Управление полиции') or string.find(title, 'Служба безопасности') and dialogId == 175 then
		if ini.set.autoweapon then
			for i = 1, 12 do
				if ini.weapon[InfoWeapon[i][3]] then
					sampSendDialogResponse(175, 1, i - 1, -1)
					if i > 3 and ini.weapon[InfoWeapon[i][4]] == 2 then sampSendDialogResponse(175, 1, i - 1, -1) end
				end
			end
		end
	end
end

function sampev.onPlayerChatBubble(id, color, dis, dur, mess)
	if not string.find(mess, 'На паузе') and IPC(id) then
		logchat[tonumber(table.maxn(logchat)) + 1] = string.format('BUUBLE\t[%d:%d:%d] %s[%d]: %s', os.date('%H'), os.date('%M'), os.date('%S'), sampGetPlayerNickname(id), id, mess)
    end
	
	if flymode then
		return {id, color, 1488, dur, mess}
	end
end

function sampev.onSendTakeDamage(playerId, damage, weapon, bodypart)
	if playerId ~= nil and damage ~= nil and weapon ~= nil and bodypart ~= nil then
		if IPC(playerId) then
			local name = sampGetPlayerNickname(playerId)
			
			if sampGetDistance(PLAYER_PED, playerId) <= 35 and sampGetPlayerColor(playerId) ~= 2236962 then
				if TypeWeapon[tonumber(weapon)] == 2 then
					if suspect_id[4] ~= name and suspect_id[3] ~= '1.1 УК' then
						SCM(string.format('Чтобы объявить %s[%d] в розыск по статье 1.1 УК нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerNickname(playerId), playerId))
						suspect_id = {playerId, 4, '1.1 УК', name}
					end
				elseif TypeWeapon[tonumber(weapon)] == 3 then
					if suspect_id[4] ~= name  and suspect_id[3] ~= '2.3 УК' then
						SCM(string.format('Чтобы объявить %s[%d] в розыск по статье 2.3 УК нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerNickname(playerId), playerId))
						suspect_id = {playerId, 4, '2.3 УК', name}
					end
				--[[elseif tonumber(weapon) == 49 then
					local res, ped = sampGetCharHandleBySampPlayerId(playerId)
					if res then
						if isCharSittingInAnyCar(ped) then
						local carh = storeCarCharIsInNoSave(ped)
							if getDriverOfCar(carh) == ped then
								if suspect_id[4] ~= name and suspect_id[3] ~= '7.9 ЕПК' then
									SCM(string.format('Чтобы объявить %s[%d] в розыск по статье 7.9 ЕПК нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerNickname(playerId), playerId))
									suspect_id = {playerId, 1, '1.1 ЕПК', name}
								end
							end
						end
					end]]
				else
					if suspect_id[4] ~= name and suspect_id[3] ~= '1.1 УК' then
						SCM(string.format('Чтобы объявить %s[%d] в розыск по статье 1.1 УК нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerNickname(playerId), playerId))
						suspect_id = {playerId, 4, '1.1 УК', name}
					end
				end
			end
		end
	end
end

function sampev.onSendDeathNotification(reas, id)
	if reas ~= nil then
		dreason = {calculateZone(), os.date('%H'), os.date('%M'), os.date('%S')}
	end
end

function sampev.onSendCommand(param)
	if string.match(param, '(%S+)[%s](%S+)') then file, val = string.match(param, '(%S+)[%s](.+)') else file, val = param, nil end
	
	process_command(file, val)
end

function onGetTableCommand(p)
	local tab = {}
	
	for val in string.gmatch(p, "[^%s]+") do
		if string.find(val, '(%d+)') then
			tab[#tab + 1] = tonumber(val)
		else
			--[[if type(tab[#tab]) == ('string') then
				tab[#tab] = string.format('%s %s', tab[#tab], val)
			else
				tab[#tab + 1] = val
			end]]
			
			tab[#tab + 1] = val
		end
	end
	
	return tab
end

function process_command(file, input)
	if not sampIsChatCommandDefined(file) then
		local namefile = string.format('moonloader//helper/commands//%s.txt', file)
		local linen, parametr = 0, false
		local parametrs_table = {}
		
		if doesFileExist(namefile) then
			lua_thread.create(function()
				for val in io.lines(namefile) do
					wait(0)
					
					if string.match(val, '{param[%s]=[%s](%d+)}') and linen == 0 then
						local n_param = tonumber(string.match(val, '{param[%s]=[%s](%d+)}'))
						if n_param > 0 then
							parametr = true
							
							local parametrs_regular, parametrs_error = ' ', ' '
							for i = 1, n_param do
								parametrs_regular = string.format('%s (%%S+)', parametrs_regular)
								parametrs_error = string.format('%s [параметр %d]', parametrs_error, i)
							end
							parametrs_regular = string.gsub(parametrs_regular, '  ', '')
							parametrs_error = string.gsub(parametrs_error, '  ', '')
							
							if input == nil or not string.match(input, parametrs_regular) then
								SCM(string.format('Используйте команду %s %s.', file, parametrs_error))
								break
							end
							
							parametrs_table = onGetTableCommand(input)
						end
					elseif string.match(val, 'sendChat.(%S+).') then
						sampSendChat(func_to_text(string.match(val, 'sendChat.(.+).'), parametrs_table))
					elseif string.match(val, 'addChat.(%S+).') then
						SCM(func_to_text(string.match(val, 'addChat.(.+).'), parametrs_table))
					elseif string.match(val, 'wait%((%d+)%)') then 
						wait(tonumber(string.match(val, 'wait%((%d+)%)')))
					elseif string.match(val, 'setKeyDown%((%S+), (%d+)%)') then
						local key, down = string.match(val, 'setKeyDown%((%S+), (%d+)%)')
						local down = tonumber(down)
						
						if down == 0 then
							setVirtualKeyDown(KEY[key], false)
						elseif down == 1 then
							setVirtualKeyDown(KEY[key], true)
						end
					elseif string.match(val, 'setKeyDown%((%S+)%)') then
						setVirtualKeyDown(KEY[string.match(val, 'setKeyDown%((%S+)%)')], true)
						wait(35)
						setVirtualKeyDown(KEY[string.match(val, 'setKeyDown%((%S+)%)')], false)
					elseif string.match(val, 'searchFile%((%S+), (%S+), (%d+)%)') then
						local file, text, sbool = string.match(val, 'searchFile%((%S+), (%S+), (%d+)%)')
						if sbool == 1 then bool = true else bool = false end
						search_file(file, text, bool)
					elseif string.match(val, 'searchFile%((%S+), (%S+)%)') then
						local file, text = string.match(val, 'searchFile%((%S+), (%S+)%)')
						search_file(file, text)
					elseif string.match(val, 'setChatInput%((.+)%)') then
						sampSetChatInputEnabled(true)
						sampSetChatInputText(string.match(val, 'setChatInput%((.+)%)'))
					else
						print(string.format('Неизвестная линия: %s', val))
					end
					
					linen = linen + 1
				end
			end)
		end
	end
end

function func_to_text(line, tab)
	local _, pid = sampGetPlayerIdByCharHandle(PLAYER_PED)
	line = line:gsub('{name}', ini.info.name)
	line = line:gsub('{rTeg}', ini.info.rteg)
	line = line:gsub('{fTeg}', ini.info.fteg)
	line = line:gsub('{frac}', ini.info.frac)
	line = line:gsub('{num}', '№000' .. ini.info.number)
	line = line:gsub('{rang}', ini.info.rang)
	line = line:gsub('{hello}', sampGetHelloByTime())
	line = line:gsub('{area}', calculateZone())
	line = line:gsub('{kvadrat}', kvadrat())
	line = line:gsub('{time}', os.date('%X'))
	line = line:gsub('{date}', os.date('%x'))
	line = line:gsub('{myid}', pid)
	line = line:gsub('{mark}', sampGetMarkCharByVehicle(PLAYER_PED))
	
	if string.find(line, 'getPlayerName_{param(%d)}') then
		for val in string.gmatch(line, 'getPlayerName_{param(%d)}') do
			local tab_number = tonumber(val)
			
			if tab[tab_number] ~= nil then
				if IPC(tab[tab_number]) then
					line = line:gsub(string.format('getPlayerName_{param%d}', tab_number), string.gsub(sampGetPlayerNickname(tab[tab_number]),'_',' '))
				else
					line = line:gsub(string.format('getPlayerName_{param%d}', tab_number), 'name')
				end
			end
		end
	end
	
	if string.find(line, 'getPlayerColor_{param(%d)}') then
		for val in string.gmatch(line, 'getPlayerColor_{param(%d)}') do
			local tab_number = tonumber(val)
			
			if tab[tab_number] ~= nil then
				if IPC(tab[tab_number]) then
					line = line:gsub(string.format('getPlayerColor_{param%d}', tab_number), '{' .. sampGetColor(tab[tab_number]) .. '}')
				else
					line = line:gsub(string.format('getPlayerColor_{param%d}', tab_number), '{ffffff}')
				end
			end
		end
	end
	
	if string.find(line, 'getPlayerPing_{param(%d)}') then
		for val in string.gmatch(line, 'getPlayerPing_{param(%d)}') do
			local tab_number = tonumber(val)
			
			if tab[tab_number] ~= nil then
				if IPC(tab[tab_number]) then
					line = line:gsub(string.format('getPlayerPing_{param%d}', tab_number), sampGetPlayerPing(tab[tab_number]))
				else
					line = line:gsub(string.format('getPlayerPing_{param%d}', tab_number), 'ping')
				end
			end
		end
	end
	
	if string.find(line, 'getPlayerScore_{param(%d)}') then
		for val in string.gmatch(line, 'getPlayerScore_{param(%d)}') do
			local tab_number = tonumber(val)
			
			if tab[tab_number] ~= nil then
				if IPC(tab[tab_number]) then
					line = line:gsub(string.format('getPlayerScore_{param%d}', tab_number), sampGetPlayerScore(tab[tab_number]))
				else
					line = line:gsub(string.format('getPlayerScore_{param%d}', tab_number), 'score')
				end
			end
		end
	end
	
	if string.find(line, 'getPlayerFraction_{param(%d)}') then
		for val in string.gmatch(line, 'getPlayerFraction_{param(%d)}') do
			local tab_number = tonumber(val)
			
			if tab[tab_number] ~= nil then
				if IPC(tab[tab_number]) then
					line = line:gsub(string.format('getPlayerFraction_{param%d}', tab_number), sampGetPlayerFractionByid(tab[tab_number]))
				else
					line = line:gsub(string.format('getPlayerFraction_{param%d}', tab_number), 'fraction')
				end
			end
		end
	end
	
	for val in string.gmatch(line, '{param(%d)}') do
		local tab_number = tonumber(val)
		
		if tab[tab_number] ~= nil then
			line = line:gsub(string.format('{param(%d)}', tab_number), tab[tab_number])
		end
	end
	
	return line
end

function startMaskTimer() 
	lua_thread.create(function()
		timerActive = true
		local offMaskTime = os.clock() * 1000 + 600000
		while timerActive do
			local remainingTime = math.floor((offMaskTime - os.clock() * 1000 ) / 1000)
			local seconds = remainingTime % 60
			local minutes = math.floor(remainingTime / 60)
			if timerActive then
				if seconds >= 10 then
					clock_textdraw.text = minutes .. ":" .. seconds
				else
					clock_textdraw.text = minutes .. ":0" .. seconds
				end
				if seconds < 0 or minutes < 0 then
					clock_textdraw.text = ''
				end
			end
			wait(100)
		end
		timerActive = false
	end)
end

function sampev.onSetPlayerColor(playerId, color)
	local result, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
	if playerId == id then
		if ini.set.masktimer then
			if color ~= 572662272 and timerActive then
				timerActive = false
				clock_textdraw.text = ''
				
				if ini.set.lowrp and ini.lowrp.rpmask then
					if ini.lowrp.unmask then
						sampSendChat(string.format('/do Маска всё ещё находится на лице %s.', string.gsub(sampGetPlayerNickname(playerId), '_', ' ')))
					else
						if ini.info.male then
							sampSendChat('/me снял маску с головы, после чего положил её в карман')
						else
							sampSendChat('/me сняла маску с головы, после чего положила её в карман')
						end
					end
				end
			elseif color == 572662272 and timerActive then
				timerActive = false
				clock_textdraw.text = ''
				
				if ini.set.lowrp and ini.lowrp.rpmask then
					if ini.lowrp.unmask then
						sampSendChat(string.format('/do Маска всё ещё находится на лице %s.', string.gsub(sampGetPlayerNickname(playerId), '_', ' ')))
					else
						if ini.info.male then
							sampSendChat('/me снял маску с головы, после чего положил её в карман')
						else
							sampSendChat('/me сняла маску с головы, после чего положила её в карман')
						end
					end
				end
			elseif color == 572662272 and not timerActive then
				startMaskTimer()
				
				if ini.set.lowrp and ini.lowrp.rpmask then
					if ini.info.male then
						sampSendChat('/me достал маску из кармана, после чего одел её на себя')
					else
						sampSendChat('/me достала маску из кармана, после чего одела её на себя')
					end
				end
			end
		end
	end
end

addEventHandler("onWindowMessage", function (msg, wparam, lparam)
    if wparam == KEY.VK_ESCAPE then
		if show_menu.v or piemenu.v or show_info.v or show_suspect.v or show_uk_list.v then
			show_menu.v, piemenu.v, show_info.v, show_suspect.v, show_uk_list.v = false, false, false, false, false
			consumeWindowMessage(true, true)
       end
    end
end)

function onScriptTerminate(script, bool)
	if thisScript() == script then
		showCursor(false) 
	end
end

function sampev.onMoveObject(id, pos, npos, speed, rot)
	if getObjectModel(sampGetObjectHandleBySampId(id)) == 968 and openbar then
		if ini.set.lowrp and ini.lowrp.rpbar then
			lua_thread.create(function()
				wait(1000)
				if rot.y == 0 then
					if ini.info.male then
						if isCharInAnyCar(PLAYER_PED) then
							sampSendChat('/me не отпуская руль, нажал на кнопку открытия шлагбаума, расположенную на руле')
						else
							sampSendChat('/me нажал на кнопку открытия шлагбаума, расположенную на часах')
						end
					else
						if isCharInAnyCar(PLAYER_PED) then
							sampSendChat('/me не отпуская руль, нажала на кнопку открытия шлагбаума, расположенную на руле')
						else
							sampSendChat('/me нажала на кнопку открытия шлагбаума, расположенную на часах')
						end
					end
				else
					if ini.info.male then
						if isCharInAnyCar(PLAYER_PED) then
							sampSendChat('/me не отпуская руль, нажал на кнопку закрытия шлагбаума, расположенную на руле')
						else
							sampSendChat('/me нажал на кнопку закрытия шлагбаума, расположенную на часах')
						end
					else
						if isCharInAnyCar(PLAYER_PED) then
							sampSendChat('/me не отпуская руль, нажала на кнопку закрытия шлагбаума, расположенную на руле')
						else
							sampSendChat('/me нажала на кнопку закрытия шлагбаума, расположенную на часах')
						end
					end
				end
				
				openbar = false
			end)
		end
	end
end

function autoupdate(json_url, url) -- Author: http://qrlk.me/samp
  local json = getWorkingDirectory() .. '\\'..thisScript().name..'-version.json'
  if doesFileExist(json) then os.remove(json) end
  downloadUrlToFile(json_url, json,
    function(id, status, p1, p2)
      if status == dlstatus.STATUSEX_ENDDOWNLOAD then
        if doesFileExist(json) then
          local f = io.open(json, 'r')
          if f then
            local info = decodeJson(f:read('*a'))
            updatelink = info.updateurl
            updateversion = info.latest
            f:close()
            os.remove(json)
            if updateversion ~= thisScript().version then
              lua_thread.create(function()
                wait(250)
                downloadUrlToFile(updatelink, thisScript().path,
                  function(id3, status1, p13, p23)
                    if status1 == dlstatus.STATUS_DOWNLOADINGDATA then
                      print(string.format('Загружено %d из %d.', p13, p23))
                    elseif status1 == dlstatus.STATUS_ENDDOWNLOADDATA then
						decode()
						SCM('Игровой помощник для МВД был автоматически обновлён до новейшей версии. Подробнее на главной странице.')
						local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
						local name = sampGetPlayerNickname(id)
						tovk(string.format(u8'-\n%s\n(id %d) %s got a new update to version %s.\n-', u8(sampGetCurrentServerName()), id, name, updateversion), true)
						goupdatestatus = true
					    lua_thread.create(function() wait(1000) thisScript():reload() end)
                    end
                    if status1 == dlstatus.STATUSEX_ENDDOWNLOAD then
                      if goupdatestatus == nil then
						SCM('При обновлении игрового помощника произошла ошибка.')
                        update = false
                      end
                    end 
                  end
                )
                end, prefix
              )
            else
              update = false
              SCM('Игровой помощник для МВД был успешно запущен. Вы используйте актуальную версию скрипта.')
			  getUsers()
            end
          end
        else
          SCM('Произошла ошибка при попытке обновления игрового помощника.')
          update = false
        end
      end
    end
  )
  while update ~= false do wait(100) end
end

function rkeys.onHotKey(id, keys)
    if sampIsChatInputActive() or sampIsDialogActive() or isSampfuncsConsoleActive() then
        return false
    end
end

function getUsers()
	local found = false
	
	async_http_request('GET', 'https://raw.githubusercontent.com/skezz-perry/project/master/users', nil --[[параметры запроса]],
		function(response) -- вызовется при успешном выполнении и получении ответа
			--print(response.text) response.text - текст ответа. ещё есть response.status_code и response.headers
			local prang
			users = response.text
			
			for line in string.gmatch(users, "[^\n]+") do
				if string.match(line, '(.+) | (.+) | (.+) | (.+)') then
					name, rang, nrang, serial = string.match(line, '(.+) | (.+) | (.+) | (.+)')
					local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
					if sampGetPlayerNickname(id):find(name) or serial == tostring(getSerialNumber()) then 
						prang, pnrang = u8:decode(rang), nrang
						found = true
					end
					player_rang[name] = tonumber(nrang)
				end
			end
			
			if found then
				pushMessage(string.format('Вы авторизовались как %s', prang), 5, 2)
				player_status = tonumber(pnrang)
				successful_login = true
			else
				SCM('Вы не являетесь пользователем и вы не можете использовать данный скрипт.')
				thisScript():unload()
			end
	end)
	
	local _, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
	local name = sampGetPlayerNickname(id)
	tovk(string.format('-\n%s\n(id %d) %s attempts to connecting to the script.\n-', u8(sampGetCurrentServerName()), id, name), true)
end

function pushMessage(text, time, style)
	if bNotf then
		notf.addNotification(text, time, style)
	end
end

function getAdvance(ip)
	local last_n = string.match(ip, '5.254.104.13(%d)')
	local last_n = tonumber(last_n)

	if last_n == 1 then serv = 'red'
	elseif last_n == 2 then serv = 'green'
	elseif last_n == 3 then serv = 'yellow'
	elseif last_n == 4 then serv = 'orange'
	elseif last_n == 5 then serv = 'blue'
	elseif last_n == 6 then serv = 'white'
	elseif last_n == 7 then serv = 'silver'
	elseif last_n == 8 then serv = 'purple'
	elseif last_n == 9 then serv = 'chocolate'
	end
	
	if serv ~= nil then
		return true, serv
	else
		return false
	end
end

function getServer()
	local ip, port = sampGetCurrentServerAddress()
	if string.match(ip, '5.254.104.13(%d)') then
		if getAdvance(ip) then
			_, server = getAdvance(ip) 
		else
			SCM('Скрипт работает исключительно на серверах Advance Role Play.')
			thisScript():unload()
		end
	else
		SCM('Скрипт работает исключительно на серверах Advance Role Play.')
		thisScript():unload()
	end
end

function async_http_request(method, url, args, resolve, reject)
    local request_lane = lanes.gen('*', {package = {path = package.path, cpath = package.cpath}}, function()
        local requests = require 'requests'
        local ok, result = pcall(requests.request, method, url, args)
        if ok then
            result.json, result.xml = nil, nil -- cannot be passed through a lane
            return true, result
        else
            return false, result -- return error
        end
    end)
    if not reject then reject = function() end end
    lua_thread.create(function()
        local lh = request_lane()
        while true do
            local status = lh.status
            if status == 'done' then
                local ok, result = lh[1], lh[2]
                if ok then resolve(result) else reject(result) end
                return
            elseif status == 'error' then
                return reject(lh[1])
            elseif status == 'killed' or status == 'cancelled' then
                return reject(status)
            end
            wait(0)
        end
    end)
end

function sequent_async_http_request(method, url, args, resolve, reject)
    if not _G['lanes.async_http'] then
        local linda = lanes.linda()
        local lane_gen = lanes.gen('*', {package = {path = package.path, cpath = package.cpath}}, function()
            local requests = require 'requests'
            while true do
                local key, val = linda:receive(50 / 1000, 'request')
                if key == 'request' then
                    local ok, result = pcall(requests.request, val.method, val.url, val.args)
                    if ok then
                        result.json, result.xml = nil, nil
                        linda:send('response', result)
                    else
                        linda:send('error', result)
                    end
                end
            end
        end)
        _G['lanes.async_http'] = {lane = lane_gen(), linda = linda}
    end
    local lanes_http = _G['lanes.async_http']
    lanes_http.linda:send('request', {method = method, url = url, args = args})
    lua_thread.create(function(linda)
        while true do
            local key, val = linda:receive(0, 'response', 'error')
            if key == 'response' then
                return resolve(val)
            elseif key == 'error' then
                return reject(val)
            end
            wait(0)
        end
    end, lanes_http.linda)
end
