-- ==================================================================================--
--      __     __     _______     __          _______      _______     _______       --
--     |  |   |  |   |  ____/    |  |        |   __  \    |  ____/    |   __  \      --
--     |  |   |  |   |  |        |  |        |  |  |  |   |  |        |  |  |  |     --
--     |  |___|  |   |  |____    |  |        |  |__|  |   |  |____    |  |__|  |     --
--     |   ___   |   |   ____|   |  |        |   ____/    |   ____|   |   ____/      --
--     |  |   |  |   |  |        |  |        |  |         |  |        |  |           --
--     |  |   |  |   |  |___     |  |____    |  |         |  |___     |  |           --
--     |__|   |__|   |_______\   |_______|   |__|         |_______\   |__|           --
--                                                                                   --
-- ==================================================================================--

script_name('helper-for-mia')
script_version(14.7)

require 'lib.moonloader'
local weapons           = require 'lib.game.weapons'
local sf                = require 'lib.sampfuncs'
local mad               = require 'MoonAdditions'
local KEY               = require 'vkeys'
local rkeys             = require 'rkeys'
local memory            = require 'memory'
local imgui             = require 'imgui'
local pie               = require 'imgui_piemenu'
local encoding          = require 'encoding'
local color             = require 'colorise'
local inicfg            = require 'inicfg'
local lanes             = require('lanes').configure()
local downloadStatus    = require('moonloader').download_status
local font_flag         = require('moonloader').font_flag
local bNotf, notf       = pcall(import, "imgui_notf1.lua")
lsampev, sampev         = pcall(require, 'lib.samp.events')
imgui.HotKey            = require('imgui_addons').HotKey  
imgui.ToggleButton      = require('imgui_addons').ToggleButton
encoding.default        = 'CP1251'
u8                      = encoding.UTF8

local tCarsName = {"Landstalker", "Bravura", "Buffalo", "Linerunner", "Perrenial", "Sentinel", "Dumper", "Firetruck", "Trashmaster", "Stretch", "Manana", "Infernus",
	"Voodoo", "Pony", "Mule", "Cheetah", "Ambulance", "Leviathan", "Moonbeam", "Esperanto", "Taxi", "Washington", "Bobcat", "Whoopee", "BFInjection", "Hunter",
	"Premier", "Enforcer", "Securicar", "Banshee", "Predator", "Bus", "Rhino", "Barracks", "Hotknife", "Trailer", "Previon", "Coach", "Cabbie", "Stallion", "Rumpo",
	"RCBandit", "Romero","Packer", "Monster", "Admiral", "Squalo", "Seasparrow", "Pizzaboy", "Tram", "Trailer", "Turismo", "Speeder", "Reefer", "Tropic", "Flatbed",
	"Yankee", "Caddy", "Solair", "Berkley'sRCVan", "Skimmer", "PCJ-600", "Faggio", "Freeway", "RCBaron", "RCRaider", "Glendale", "Oceanic", "Sanchez", "Sparrow",
	"Patriot", "Quad", "Coastguard", "Dinghy", "Hermes", "Sabre", "Rustler", "ZR-350", "Walton", "Regina", "Comet", "BMX", "Burrito", "Camper", "Marquis", "Baggage",
	"Dozer", "Maverick", "NewsChopper", "Rancher", "FBIRancher", "Virgo", "Greenwood", "Jetmax", "Hotring", "Sandking", "BlistaCompact", "PoliceMaverick",
	"Boxvillde", "Benson", "Mesa", "RCGoblin", "HotringRacerA", "HotringRacerB", "BloodringBanger", "Rancher", "SuperGT", "Elegant", "Journey", "Bike",
	"MountainBike", "Beagle", "Cropduster", "Stunt", "Tanker", "Roadtrain", "Nebula", "Majestic", "Buccaneer", "Shamal", "hydra", "FCR-900", "NRG-500", "HPV1000",
	"CementTruck", "TowTruck", "Fortune", "Cadrona", "FBITruck", "Willard", "Forklift", "Tractor", "Combine", "Feltzer", "Remington", "Slamvan", "Blade", "Freight",
	"Streak", "Vortex", "Vincent", "Bullet", "Clover", "Sadler", "Firetruck", "Hustler", "Intruder", "Primo", "Cargobob", "Tampa", "Sunrise", "Merit", "Utility", "Nevada",
	"Yosemite", "Windsor", "Monster", "Monster", "Uranus", "Jester", "Sultan", "Stratum", "Elegy", "Raindance", "RCTiger", "Flash", "Tahoma", "Savanna", "Bandito",
	"FreightFlat", "StreakCarriage", "Kart", "Mower", "Dune", "Sweeper", "Broadway", "Tornado", "AT-400", "DFT-30", "Huntley", "Stafford", "BF-400", "NewsVan",
	"Tug", "Trailer", "Emperor", "Wayfarer", "Euros", "Hotdog", "Club", "FreightBox", "Trailer", "Andromada", "Dodo", "RCCam", "Launch", "PoliceCar", "PoliceCar",
	"PoliceCar", "PoliceRanger", "Picador", "SWAT", "Alpha", "Phoenix", "GlendaleShit", "SadlerShit", "Luggage A", "Luggage B", "Stairs", "Boxville", "Tiller",
	"UtilityTrailer"
}

local tCarsTypeName = {"Автомобиль", "Мотоцикл", "Вертолёт", "Самолёт", "Прицеп", "Лодка", "Другое", "Поезд", "Велосипед"}

local tCarsSpeed = {43, 40, 51, 30, 36, 45, 30, 41, 27, 43, 36, 61, 46, 30, 29, 53, 42, 30, 32, 41, 40, 42, 38, 27, 37,
	54, 48, 45, 43, 55, 51, 36, 26, 30, 46, 0, 41, 43, 39, 46, 37, 21, 38, 35, 30, 45, 60, 35, 30, 52, 0, 53, 43, 16, 33, 43,
	29, 26, 43, 37, 48, 43, 30, 29, 14, 13, 40, 39, 40, 34, 43, 30, 34, 29, 41, 48, 69, 51, 32, 38, 51, 20, 43, 34, 18, 27,
	17, 47, 40, 38, 43, 41, 39, 49, 59, 49, 45, 48, 29, 34, 39, 8, 58, 59, 48, 38, 49, 46, 29, 21, 27, 40, 36, 45, 33, 39, 43,
	43, 45, 75, 75, 43, 48, 41, 36, 44, 43, 41, 48, 41, 16, 19, 30, 46, 46, 43, 47, -1, -1, 27, 41, 56, 45, 41, 41, 40, 41,
	39, 37, 42, 40, 43, 33, 64, 39, 43, 30, 30, 43, 49, 46, 42, 49, 39, 24, 45, 44, 49, 40, -1, -1, 25, 22, 30, 30, 43, 43, 75,
	36, 43, 42, 42, 37, 23, 0, 42, 38, 45, 29, 45, 0, 0, 75, 52, 17, 32, 48, 48, 48, 44, 41, 30, 47, 47, 40, 41, 0, 0, 0, 29, 0, 0
}

local tCarsType = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1,
	3, 1, 1, 1, 1, 6, 1, 1, 1, 1, 5, 1, 1, 1, 1, 1, 7, 1, 1, 1, 1, 6, 3, 2, 8, 5, 1, 6, 6, 6, 1,
	1, 1, 1, 1, 4, 2, 2, 2, 7, 7, 1, 1, 2, 3, 1, 7, 6, 6, 1, 1, 4, 1, 1, 1, 1, 9, 1, 1, 6, 1,
	1, 3, 3, 1, 1, 1, 1, 6, 1, 1, 1, 3, 1, 1, 1, 7, 1, 1, 1, 1, 1, 1, 1, 9, 9, 4, 4, 4, 1, 1, 1,
	1, 1, 4, 4, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 7, 1, 1, 1, 1, 8, 8, 7, 1, 1, 1, 1, 1, 1, 1,
	1, 3, 1, 1, 1, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 1, 1, 1, 1, 8, 8, 7, 1, 1, 1, 1, 1, 4,
	1, 1, 1, 2, 1, 1, 5, 1, 2, 1, 1, 1, 7, 5, 4, 4, 7, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 5, 5, 1, 5, 5
}

local TypeWeapon = {1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 3, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1}

local InfoWeapon = {{'Щит', false, 'shit', 'bshit', 1},
	{'Дубинка', false, 'button', 'bbutton', 1},
	{'Пистолет с глушителем', true, 'sd', 'bsd', 250},
	{'Бронежилет', false, 'armour', 'barmour', 1},
	{'Маска', false, 'mask', 'bmask', 1},
	{'Desert Eagle', true, 'deagle', 'bdeagle', 250},
	{'Пистолет-пулемёт MP5', true, 'mp5', 'bmp5', 400},
	{'Дробовик', true, 'shotgun', 'bshotgun', 100},
	{'Дымовые шашки', true, 'smoke', 'bsmoke', 25},
	{'Снайперская винтовка', true, 'sniper', 'bsniper', 50},
	{'Штурмовая винтовка M4', true, 'm4', 'bm4', 350},
	{'АК-47', true, 'ak47', 'bak47', 350}
}

local frac = {
	name = {'mvd', 'prav', 'mm', 'mo', 'mz', 'lcn', 'rm', 'yak', 'grv', 'bal', 'vag', 'azt', 'rif', 'civ', 'mask', 'all'},
	fullname = {'Министерство внутренних дел', 'Правительство', 'Средства массовой информации', 'Министерство обороны', 'Министерство здравоохранения', 'La Cosa Nostra', 'Russian Mafia', 'Yakuza', 'Grove Street', 'The Ballas', 'Los Santos Vagos', 'Varios los Aztecas', 'The Rifa', 'Гражданские', 'В маске', 'Прочее'},
	color = {'{0000ff}', '{ccff00}', '{ff6600}', '{996633}', '{ff6666}', '{993366}', '{007575}', '{bb0000}', '{009900}', '{cc00ff}', '{ffcd00}', '{00ccff}', '{6666ff}', '{ffffff}', '{ffffff}', '{ffffff}'},
}

local descript_f = {
	ScrollbarGrab = 'Неизвестно', 
	CloseButtonHovered = 'Цвет при наведение на крестик, закрывающий меню.', 
	ComboBg = 'Не используется', 
	ResizeGrip = 'Цвет окон ввода данных', 
	ScrollbarGrabActive = 'Цвет клавиши скролла при нажатие', 
	HeaderHovered = 'Неизвестно', 
	ButtonHovered = 'Цвет клавиши при наведение', 
	FrameBgHovered = 'Неизвестно', 
	FrameBgActive = 'Неизвестно', 
	FrameBg = 'Неизвестно', 
	ScrollbarBg = 'Цвет скролла', 
	ButtonActive = 'Цвет клавиши при нажатие', 
	ResizeGripHovered = 'Цвет окна ввода при наведение', 
	ResizeGripActive = 'Цвет окна ввода при нажатие', 
	CheckMark = 'Цвет галочки в окнах выбора', 
	ScrollbarGrabHovered = 'Цвет скролла при наведение', 
	SliderGrabActive = 'Неизвестно', 
	HeaderActive = 'Неизвестно', 
	Button = 'Цвет клавиши', 
	CloseButtonActive = 'Цвет при нажатие на крестик, закрывающий меню', 
	TitleBgActive = 'Цвет верхней полосы в меню', 
	CloseButton = 'Цвет крестика, закрывающего меню', 
	WindowBg = 'Цвет фона', 
	TextSelectedBg = 'Неизвестно', 
	SliderGrab = 'Неизвестно', 
	Header = 'Неизвестно', 
	TitleBgCollapsed = 'Не используется', 
	TitleBg = 'Не используется', 
	Text = 'Цвет текста'
}

local static = {
	skin = nil,
	clock = {hour = nil, minute = nil},
	weather = nil
}

local ini = inicfg.load({
	info = {
		name                 = '',
		rang                 = '',
		frac                 = '',
		number               = '',
		male                 = true,
		female               = false,
		rteg                 = '',
		fteg                 = ''
	},
	set = {
		masktimer            = false,
		camera               = false,
		stopad               = false,
		strobes              = false,
		radio                = false,
		autopass             = false,
		autoweapon           = false,
		lowrp                = false,
		rpweapon             = false,
		autorpweapon         = false,
		halfrpweapon         = false,
		delay_rk             = 10,
		message_megafon      = false,
		new_leaders          = true,
		new_find             = true,
		new_clock            = true,
		new_group            = true,
		new_wanted           = true,
		blacklist            = '',
		streetlight          = false,
		slhour               = 21,
		mslhour              = 7,
		kvadrocopter         = false,
		pkvadrocopter        = false,
		skvadrocopter        = false,
		strob_lr             = 500,
		new_logo             = false,
		logo_x               = 500,
		logo_y               = 500,
		color_line           = 0xFF4169E1,
		idforname            = false,
		autobuy              = false
	},
	uk_set = {
		insubordination      = '3 | 31.2 УК', -- неподчинение
		cancel_ticket        = '3 | 31.2 УК',
		attack_1             = '2 | 2.1 УК', -- без оружия
		attack_2             = '3 | 2.2 УК', -- холодное оружие
		attack_3             = '4 | 2.3 УК', -- огнестрел
		--attack_4             = '4 | 2.3 УК', -- на машине
	},
	weapons = {
		shit                 = false,
		button               = false,
		armour               = false,
		mask                 = false,
		sd                   = false,
		bsd                  = false,
		deagle               = false,
		bdeagle              = false,
		mp5                  = false,
		bmp5                 = false,
		shotgun              = false,
		bshotgun             = false,
		smoke                = false,
		bsmoke               = false,
		sniper               = false,
		bsniper              = false,
		m4                   = false,
		bm4                  = false,
		ak47                 = false,
		bak47                = false
	},
	rpweapon = {
		Brass_Knuckles       = '',
		Golf_Club            = '',
		Nightstick           = '',
		Knife                = '',
		Baseball_Bat         = '',
		Shovel               = '',
		Pool_Cue             = '',
		Katana               = '',
		Chainsaw             = '',
		Purple_Dildo         = '',
		Dildo                = '',
		Vibrator             = '',
		Silver_Vibrator      = '',
		Flowers              = '',
		Cane                 = '',
		Grenade              = '',
		Tear_Gas             = '',
		Molotov_Cocktail     = '',
		p9mm                 = '',
		Silenced_9mm         = '',
		Desert_Eagle         = 'схатившись правой рукой за пистолет, вытащил его из кобуры',
		Shotgun              = 'взявшись за ремень дробовика, снял его с плеча и взял в руки',
		Sawnoff_Shotgun      = '',
		Combat_Shotgun       = '',
		Micro_Uzi            = '',
		MP5                  = 'скинул пистолет-пулемёт MP-5 с плеча и взял его в руки',
		AK_47                = '',
		M4                   = '',
		Tec_9                = '',
		Country_Rifle        = '',
		Sniper_Rifle         = '',
		RPG                  = '',
		HS_Rocket            = '',
		Flamethrower         = '',
		Minigun              = '',
		Satchel_Charge       = '',
		Detonator            = '',
		Spraycan             = '',
		Fire_Extinguisher    = '',
		Camera               = '',
		Night_Vis_Goggles    = '',
		Thermal_Goggles      = '',
		Parachute            = ''
	},
	rpweaponoff = {
		Brass_Knuckles       = '',
		Golf_Club            = '',
		Nightstick           = '',
		Knife                = '',
		Baseball_Bat         = '',
		Shovel               = '',
		Pool_Cue             = '',
		Katana               = '',
		Chainsaw             = '',
		Purple_Dildo         = '',
		Dildo                = '',
		Vibrator             = '',
		Silver_Vibrator      = '',
		Flowers              = '',
		Cane                 = '',
		Grenade              = '',
		Tear_Gas             = '',
		Molotov_Cocktail     = '',
		p9mm                 = '',
		Silenced_9mm         = '',
		Desert_Eagle         = 'убрал пистолет обратно в кобуру, застягнув её',
		Shotgun              = 'повесил дробовик обратно на плечо, придерживая за ремень',
		Sawnoff_Shotgun      = '',
		Combat_Shotgun       = '',
		Micro_Uzi            = '',
		MP5                  = 'повесил пистолет-пулемёт MP-5 обратно на плечо',
		AK_47                = '',
		M4                   = '',
		Tec_9                = '',
		Country_Rifle        = '',
		Sniper_Rifle         = '',
		RPG                  = '',
		HS_Rocket            = '',
		Flamethrower         = '',
		Minigun              = '',
		Satchel_Charge       = '',
		Detonator            = '',
		Spraycan             = '',
		Fire_Extinguisher    = '',
		Camera               = '',
		Night_Vis_Goggles    = '',
		Thermal_Goggles      = '',
		Parachute            = ''
	},
	lowrp = {
		rphealme             = false,
		rpmask               = false,
		rpfbi                = false,
		rpbar                = false,
		rpradio              = false,
		unmask               = false
	},
	custom = {
		ScrollbarGrab        = 1525125412,
		CloseButtonHovered   = 1525125412,
		ComboBg              = 1525125412,
		ResizeGrip           = 1522877218,
		ScrollbarGrabActive  = 1525125412,
		HeaderHovered        = 1525125412,
		ButtonHovered        = 2529510178,
		FrameBgHovered       = 1522877218,
		FrameBgActive        = 2529510178, 
		FrameBg              = 1522877218,
		ScrollbarBg          = 1525125412,
		ButtonActive         = 1522877218,
		ResizeGripHovered    = 2191869489,
		ResizeGripActive     = 2529510178,
		CheckMark            = 1525125412,
		ScrollbarGrabHovered = 1522877218,
		SliderGrabActive     = 1525125412,
		HeaderActive         = 1525125412,
		Button               = 1522877218,
		CloseButtonActive    = 1525125412,
		TitleBgActive        = 4039459618,
		CloseButton          = 2529510178,
		WindowBg             = 4028175123,
		TextSelectedBg       = 1525125412,
		SliderGrab           = 1522877218,
		Header               = 1525125412,
		TitleBgCollapsed     = 851788578,
		TitleBg              = 24124124,
		Text                 = 4294967295
	},
	hkey = {
		eat = '2, 49',
		open = '2, 50',
		onvec_m = '2, 51',
		onfoot_m = '2, 52',
		smart_su = '2, 53',
		lock = '76',
		menu = '99',
		fast_menu = '90',
		camera = '123',
		camhack_on = '67, 49',
		camhack_off = '67, 50',
		strob_right = false,
		strob_left = false
	},
	custom_hkey = {
	},
	number = {
	}
}, 'Helper for MIA.ini')

local scriptCommands = {
	default = {
		r = {true, 'command_r'},
		rn = {true, 'command_rn'},
		f = {true, 'command_f'},
		fn = {true, 'command_fn'},
		cuff = {true, 'command_cuff'},
		uncuff = {true, 'command_uncuff'},
		arrest = {true, 'command_arrest'},
		pull = {true, 'command_pull'},
		su = {true, 'command_su'},
		skip = {true, 'command_skip'},
		clear = {true, 'command_clear'},
		hold = {true, 'command_hold'},
		ticket = {true, 'command_ticket'}, 
		takelic = {true, 'command_takelic'},
		putpl = {true, 'command_putpl'},
		rights = {true, 'command_rights'},
		search = {true, 'command_search'},
		follow = {true, 'command_follow'},
		hack = {true, 'command_hack'},
		invite = {true, 'command_invite'},
		uninvite = {true, 'command_uninvite'},
		rang = {true, 'command_rang'},
		changeskin = {true, 'command_changeskin'},
		ud = {true, 'command_ud'},
		pas = {true, 'command_pas'},
		rep = {true, 'command_report'},
		uk = {true, 'command_uk'},
		ak = {true, 'command_ak'},
		code = {true, 'command_code'},
		ustav = {true, 'command_ustav'},
		sw = {true, 'command_setweather'},
		st = {true, 'command_settime'},
		sskin = {true, 'command_setskin'},
		history = {true, 'command_history'},
		asms = {true, 'command_asms'},
		gov = {true, 'command_gov'},
		addbl = {true, 'command_addbl'},
		delbl = {true, 'command_delbl'},
		pay = {true, 'command_apay'},
		users = {true, 'command_users'},
		rkinfo = {true, 'command_rkinfo'},
		sms = {true, 'command_sms'},
		open = {true, 'command_open'},
		bl = {true, 'command_bl'},
		blname = {true, 'command_namebl'},
		rec = {true, 'command_reconnect'},
		recn = {true, 'command_reconnectwithchange'},
		recd = {true, 'command_reconnectwithchangeip'},
		rtag = {true, 'command_radiotag'},
		push = {true, 'command_push'},
		mh = {true, 'command_menu'},
		strobes = {true, 'command_strobes'}
	}
}

local allCommands = inicfg.load({
	default = {
		r = true,
		rn = true,
		f = true,
		fn = true,
		cuff = true,
		uncuff = true,
		arrest = true,
		pull = true,
		su = true,
		skip = true,
		clear = true,
		hold = true,
		ticket = true,
		takelic = true,
		putpl = true,
		rights = true,
		search = true,
		follow = true,
		hack = true,
		invite = true,
		uninvite = true,
		rang = true,
		changeskin = true,
		ud = true,
		pas = true,
		rep = true,
		uk = true,
		ak = true,
		code = true,
		ustav = true,
		sw = true,
		st = true,
		sskin = true,
		history = true,
		asms = true,
		gov = true,
		addbl = true,
		delbl = true,
		pay = true,
		users = true,
		rkinfo = true,
		sms = true,
		open = true,
		bl = true,
		blname = true,
		rec = true,
		recn = true,
		recd = true,
		rtag = true,
		push = true,
		mh = true,
		strobes = true
	},
	custom = {
	}
}, 'HfMIA Commands.ini')

local pass = inicfg.load({
	server = {}
}, 'password.ini')

local hotkey_butt = {
	eat = {key = {v = {}}, last = {}, bind = -1, name = 'Использоние еды (/eat)'},
	open = {key = {v = {}}, last = {}, bind = -1, name = 'Открытие шлагбаума (/open)'},
	lock = {key = {v = {}}, last = {}, bind = -1, name = 'Открыть или закрыть машину (/lock)'},
	menu = {key = {v = {}}, last = {}, bind = -1, name = 'Открыть или закрыть основное меню'},
	fast_menu = {key = {v = {}}, last = {}, bind = -1, name = 'Открыть или закрыть быстрое меню'},
	camera = {key = {v = {}}, last = {}, bind = -1, name = 'Клавиша для использования RP-камеры'},
	onvec_m = {key = {v = {}}, last = {}, bind = -1, name = 'Использование мегафона в машине'},
	onfoot_m = {key = {v = {}}, last = {}, bind = -1, name = 'Сообщение о погоне в рацию'},
	smart_su = {key = {v = {}}, last = {}, bind = -1, name = 'Использование быстрого розыска'},
	camhack_on = {key = {v = {}}, last = {}, bind = -1, name = 'Включить CamHack'},
	camhack_off = {key = {v = {}}, last = {}, bind = -1, name = 'Выключить CamHack'}
}

local hotkey_cust_butt = {}

local users              = ''
local lgov               = {}
local dreason            = {}
local gnews              = {}
local suspect_id         = {0, 0, '', '', -1}
local target_id          = 0
local last_message       = {name = '', id = -1}
local player_rang        = {}
local static_camera      = {}
local smart_suspect      = {id = nil, text = {}}
local smart_ticket       = {id = nil, text = {}}
local need_buy           = {aid = 0, mask = 0}
local maskTimer			 = {state = false, clock = 0}
local notificationsTimer = {}
local param_cmd          = 0
local last_sms           = 0
local lweap              = 0
local gov_delay          = 0
local rpweaponid         = 1
local speed              = 0.3
local flymode            = false
local autopass           = false
local follow_state       = false
local timerActive        = false
local openbar            = false
local successful_login   = false
local player_status      = 0
local player_a_status    = 0
local show_menu          = imgui.ImBool(false)
local fastMenu           = imgui.ImBool(false)
local show_help          = imgui.ImBool(false)
local show_suspect       = imgui.ImBool(false)
local show_ticket        = imgui.ImBool(false)
local show_uk_list       = imgui.ImBool(false)
local show_ak_list       = imgui.ImBool(false)
local show_uk_edit       = imgui.ImBool(false)
local show_notification  = imgui.ImBool(false)
local show_item          = imgui.ImInt(8)
local set_item           = imgui.ImInt(0)
local page_num           = imgui.ImInt(0)
local weaponid           = imgui.ImInt(46)
local commandid          = imgui.ImInt(0)
local inpball            = imgui.ImInt(5)
local pmslhour           = imgui.ImInt(ini.set.mslhour)
local pslhour            = imgui.ImInt(ini.set.slhour)
local pdelay_rk          = imgui.ImInt(ini.set.delay_rk)

local govermentNews = {
	lineOne = imgui.ImBuffer(250),
	lineTwo = imgui.ImBuffer(250),
	lineThree = imgui.ImBuffer(250),
	lineAlone = imgui.ImBuffer(250)
}

local notificationsSettings = {
	name = imgui.ImBuffer(60),
	text = imgui.ImBuffer(600),
	hour = imgui.ImInt(7),
	minute = imgui.ImInt(30)
}

local passname           = imgui.ImBuffer(250)
local passpass           = imgui.ImBuffer(250)
local passip             = imgui.ImBuffer(250)
local passkey            = imgui.ImBuffer(250)
local idnews             = imgui.ImBuffer(4)
local pname              = imgui.ImBuffer(u8(ini.info.name), 256)
local prang              = imgui.ImBuffer(u8(ini.info.rang), 256)
local pfrac              = imgui.ImBuffer(u8(ini.info.frac), 256)
local pnumber            = imgui.ImBuffer(u8(tostring(ini.info.number)), 256)
local rteg               = imgui.ImBuffer(u8(ini.info.rteg), 256)
local fteg               = imgui.ImBuffer(u8(ini.info.fteg), 256)
local name_cmd           = imgui.ImBuffer(256)
local takeweap           = imgui.ImBuffer(256)
local takeweapoff        = imgui.ImBuffer(256)
local url_bl             = imgui.ImBuffer(500)
local cmduse             = imgui.ImBuffer(30)
local cmdinp             = imgui.ImBuffer(30)
local inpcomment         = imgui.ImBuffer(1000)
local search_place       = imgui.ImBuffer(1000)
local text_cmd           = imgui.ImBuffer(9999)
local editor             = imgui.ImBool(false)

function main()
	if not isSampLoaded() or not isSampfuncsLoaded() then return end
	while not isSampAvailable() do wait(100) end
	
	addChat('Данная версия игрового помощника более не поддерживается :(')
	autoUpdate('https://raw.githubusercontent.com/skezz-perry/project/master/version', 'https://github.com/skezz-perry/project/blob/master/projectRAZRAB_protected.luac?raw=true')
	--attempToGetFileAndDir()

	for command, _function in pairs(scriptCommands.default) do
		if not sampIsChatCommandDefined(command) then
			if _function[1] then
				if type(_G[_function[2]]) == ('function') then
					sampRegisterChatCommand(command, _G[_function[2]])
				end
			end
		end
	end

	lua_thread.create(strobe)
	lua_thread.create(rpweapon)
	lua_thread.create(show_flymode)
	lua_thread.create(logotyp)
	lua_thread.create(speedometr)
	lua_thread.create(notifications)
	
	apply_custom_style()
	register_custom_hotkey()
	add_new_hotkey()
	
	while true do
		wait(0)

		if sampTextdrawIsExists(0) and ini.set.new_logo then
			if sampTextdrawGetString(0):find('Advance_RP') then
				sampTextdrawDelete(0)
			end
		end
		
		if ini.set.halfrpweapon and ini.set.rpweapon then
			if wasKeyPressed(KEY.VK_RBUTTON) and lweap ~= getCurrentCharWeapon(playerPed) then
				if not isSampfuncsConsoleActive() and not sampIsChatInputActive() and not sampIsDialogActive() then
					if getCurrentCharWeapon(playerPed) ~= 0 then
						lua_thread.create(function()
							local result, rp = sampWeaponScene(getCurrentCharWeapon(playerPed))
							if result then
								wait(350)
								lweap = getCurrentCharWeapon(playerPed)
								sampSendChat(string.format('/me %s', rp))
								
								while lweap == getCurrentCharWeapon(playerPed) do wait(0) end
								
								wait(800)
								
								if (lweap ~= getCurrentCharWeapon(playerPed)) then
									local aresult, arp = sampWeaponSceneOff(lweap)
									if aresult then
										sampSendChat(string.format('/me %s', arp))
										lweap = -1
									end
								end
							end
						end)
					end
				end
			end
			
			if wasKeyPressed(KEY.VK_R) and isKeyDown(VK_MENU) and lweap ~= getCurrentCharWeapon(playerPed) then
				if not isSampfuncsConsoleActive() and not sampIsChatInputActive() and not sampIsDialogActive() then
					if getCurrentCharWeapon(playerPed) ~= 0 then
						lua_thread.create(function()
							local result, rp = sampWeaponScene(getCurrentCharWeapon(playerPed))
							if result then
								wait(350)
								lweap = getCurrentCharWeapon(playerPed)
								sampSendChat(string.format('/me %s', rp))
								
								while lweap == getCurrentCharWeapon(playerPed) do wait(0) end
								
								wait(800)
								
								if (lweap ~= getCurrentCharWeapon(playerPed)) then
									local aresult, arp = sampWeaponSceneOff(lweap)
									if aresult then
										sampSendChat(string.format('/me %s', arp))
										lweap = -1
									end
								end
							end
						end)
					end
				end
			end
		end

		if isKeyDown(VK_RBUTTON) then
			local id = sampGetPlayerIdByTarget()
			if id then
				if target_id ~= id then
					target_id = id
				end
			end
		end

		if maskTimer.state then
			local sx, sy = getScreenResolution()
			local alltime = 600 - math.floor(os.clock() - maskTimer.clock)

			local minute = math.floor(alltime / 60)
			local secund = math.fmod(alltime, 60)

			local text = string.format('%d minutes %d seconds', minute, secund)

			renderFontDrawText(font_logo, text, sx - 200, sy - 30, 0xFFFFFFFF)
		end

		if set_time then
			setTimeOfDay(set_time[1], set_time[2])
		end
		
		if show_menu.v or fastMenu.v or show_suspect.v or show_uk_list.v or show_ticket.v or show_ak_list.v or show_notification.v then
			imgui.Process = true
		else
			imgui.Process = false
		end
		
		if ini.set.streetlight then
			local hour = getTimeOfDay() 
			if hour >= ini.set.slhour or hour <= ini.set.mslhour then 
				local x, y, z = getCharCoordinates(playerPed)
				for _, object in ipairs(mad.get_all_objects(x, y, z, 300)) do
					local model = getObjectModel(object)
					
					if getObjectHealth(object) > 0  and isObjectOnScreen(object) then
						if model == 1226 then
							local matrix = mad.get_object_matrix(object)
							if matrix then
								local objx, objy, objz = matrix:get_coords_with_offset(-1.3, 0.165, 3.69)
								local ground_z = getGroundZFor3dCoord(objx, objy, objz)
								mad.draw_spotlight(objx, objy, objz, objx, objy, ground_z, 0.065, 27)
							end
						elseif model == 1297 then
							local matrix = mad.get_object_matrix(object)
							if matrix then
								local objx, objy, objz = matrix:get_coords_with_offset(-0.5, 0, 3.1)
								local ground_z = getGroundZFor3dCoord(objx, objy, objz)
								mad.draw_spotlight(objx, objy, objz, objx, objy, ground_z, 0.065, 27)
							end
						end
					end
				end
			end
		end 
		 
		if successful_login and sampGetCurrentServerName() ~= 'SA-MP' then
			local _, id = sampGetPlayerIdByCharHandle(playerPed)
			local name = sampGetPlayerName(id)
			local text = string.format('-\n(id %d ~ rang %d) %s successfully logged in as a user.\n-', id, player_status, name)
			sendGroup(text, true)
			successful_login = false
		end

		if isCharInAnyCar(playerPed) and ini.set.strobes then

			local car = storeCarCharIsInNoSave(playerPed)
			local driverPed = getDriverOfCar(car)

			if isKeyDown(VK_LMENU) and isKeyCheckAvailable() and driverPed == playerPed then
				local state = true

				for i = 1, 10 do
					wait(100)
					if not isKeyDown(VK_LMENU) then state = false end
				end

				if isKeyDown(VK_LMENU) and state then

					local state = not isCarSirenOn(car)
					switchCarSiren(car, state)

					while isKeyDown(VK_LMENU) do wait(0) end

				end

			end

		end

		if flymode and not sampIsChatInputActive() and not isSampfuncsConsoleActive() then
			offMouX, offMouY = getPcMouseMovement()
			  
			offMouX = offMouX / 4.0
			offMouY = offMouY / 4.0
			angZ = angZ + offMouX
			angY = angY + offMouY

			if angZ > 360.0 then angZ = angZ - 360.0 end
			if angZ < 0.0 then angZ = angZ + 360.0 end

			if angY > 89.0 then angY = 89.0 end
			if angY < -89.0 then angY = -89.0 end   

			curZ = angZ + 180.0
			curY = angY * -1.0      
			radZ = math.rad(curZ) 
			radY = math.rad(curY)                   
			sinZ = math.sin(radZ)
			cosZ = math.cos(radZ)      
			sinY = math.sin(radY)
			cosY = math.cos(radY)       
			sinZ = sinZ * cosY      
			cosZ = cosZ * cosY 
			sinZ = sinZ * 10.0     
			cosZ = cosZ * 10.0       
			sinY = sinY * 10.0                       
			posPlX = posX + sinZ 
			posPlY = posY + cosZ 
			posPlZ = posZ + sinY              
			angPlZ = angZ * -1.0

			if isKeyDown(VK_W) then      
				radZ = math.rad(angZ) 
				radY = math.rad(angY)                   
				sinZ = math.sin(radZ)
				cosZ = math.cos(radZ)      
				sinY = math.sin(radY)
				cosY = math.cos(radY)       
				sinZ = sinZ * cosY      
				cosZ = cosZ * cosY 
				sinZ = sinZ * speed      
				cosZ = cosZ * speed       
				sinY = sinY * speed  
				posX = posX + sinZ 
				posY = posY + cosZ 
				posZ = posZ + sinY      
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)      
			end 

			if isKeyDown(VK_S) then  
				curZ = angZ + 180.0
				curY = angY * -1.0      
				radZ = math.rad(curZ) 
				radY = math.rad(curY)                   
				sinZ = math.sin(radZ)
				cosZ = math.cos(radZ)      
				sinY = math.sin(radY)
				cosY = math.cos(radY)       
				sinZ = sinZ * cosY      
				cosZ = cosZ * cosY 
				sinZ = sinZ * speed      
				cosZ = cosZ * speed       
				sinY = sinY * speed                       
				posX = posX + sinZ 
				posY = posY + cosZ 
				posZ = posZ + sinY      
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end 
			  
			if isKeyDown(VK_A) then  
				curZ = angZ - 90.0
				radZ = math.rad(curZ)
				radY = math.rad(angY)
				sinZ = math.sin(radZ)
				cosZ = math.cos(radZ)
				sinZ = sinZ * speed
				cosZ = cosZ * speed
				posX = posX + sinZ
				posY = posY + cosZ
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end       

			if isKeyDown(VK_D) then  
				curZ = angZ + 90.0
				radZ = math.rad(curZ)
				radY = math.rad(angY)
				sinZ = math.sin(radZ)
				cosZ = math.cos(radZ)       
				sinZ = sinZ * speed
				cosZ = cosZ * speed
				posX = posX + sinZ
				posY = posY + cosZ      
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end 
			
			if isKeyDown(VK_SPACE) then  
				posZ = posZ + speed
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end 

			if isKeyDown(VK_SHIFT) then  
				posZ = posZ - speed
				setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
			end
			
			radZ = math.rad(angZ) 
			radY = math.rad(angY)             
			sinZ = math.sin(radZ)
			cosZ = math.cos(radZ)      
			sinY = math.sin(radY)
			cosY = math.cos(radY)       
			sinZ = sinZ * cosY      
			cosZ = cosZ * cosY 
			sinZ = sinZ * 1.0      
			cosZ = cosZ * 1.0     
			sinY = sinY * 1.0
			if targetSet == nil then
				poiX = posX
				poiY = posY
				poiZ = posZ   
				poiX = poiX + sinZ 
				poiY = poiY + cosZ 
				poiZ = poiZ + sinY
			else
				local result, ped = sampGetCharHandleBySampPlayerId(targetSet)
				
				if result then
					poiX, poiY, poiZ = getCharCoordinates(ped)
				else
					targetSet = nil
				end
			end
			
			pointCameraAtPoint(poiX, poiY, poiZ, 2)

			if isKeyDown(187) then 
				speed = speed + 0.0005
			end 
			               
			if isKeyDown(189) then 
				speed = speed - 0.0005
				if speed < 0.001 then speed = 0.001 end
			end   
		end
	end
end

function notifications()
	while true do
		wait(0)

		for name, value in pairs(notificationsTimer) do
			if value.switch then
				local hour, minute, second = os.date('%H'), os.date('%M'), os.date('%S')

				if (value.time.hour == tonumber(hour)) and (value.time.minute == tonumber(minute)) and (tonumber(second) == 1) then
					local caption = string.format('{FFFFFF}Уведомление. {00CC66}%s.', value.name)
					local text = string.format('{ffffff}%s', value.text)

					if value.sound then
						addOneOffSound(0.0, 0.0, 0.0, 1058)
					end

					sampShowDialog(500, caption, text, 'Хорошо', 'Закрыть', 0)
					value.switch = false
				end
			end
		end
	end
end

function speedometr()
	while true do
		wait(0)

		if isCharSittingInAnyCar(playerPed) then
			if speedometr_id == nil or not sampTextdrawIsExists(speedometr_id) then
				for number = 0, 3000 do
					if sampTextdrawIsExists(number) then
						if sampTextdrawGetString(number):find('Fuel') then
							speedometr_id = number
							break
						end
					end
				end
			else
				if sampTextdrawIsExists(speedometr_id) then
					local vehicle       = storeCarCharIsInNoSave(playerPed)
					local vehicle_speed = math.ceil(getCarSpeed(vehicle) * 2.02)
					local vehicle_text  = sampTextdrawGetString(speedometr_id)
					local vehicle_text  = vehicle_text:gsub('%d+_km/h', string.format('%d_km/h', vehicle_speed))

 					sampTextdrawSetString(speedometr_id, vehicle_text)
				end
			end
		end
	end
end

function logotyp()
	local server_name = {'RED', 'GREEN', '', '', 'BLUE'}

	while true do
		wait(0)
		
		if sampIsLocalPlayerSpawned() then
			if ini.set.new_logo then
				if not draw_new_logo then
					font_logo = renderCreateFont('Calibri', 15, font_flag.BOLD)
					font_logo_lil = renderCreateFont('Calibri', 8, font_flag.BOLD)
					logo_texture = renderLoadTextureFromFileInMemory(memory.strptr(logotype_texture), 4096)
					text_logo = 'ADVANCE'
					draw_new_logo = true
				else
					if string.match(sampGetCurrentServerAddress(), '5.254.104.13(%d+)') then
						local id = string.match(sampGetCurrentServerAddress(), '5.254.104.13(%d+)')
						text_logo_lil = 'ROLE PLAY ' .. server_name[tonumber(id)]
						renderFontDrawText(font_logo, text_logo, ini.set.logo_x + 65, ini.set.logo_y + 15, 0xFFFFFFFF)
						renderFontDrawText(font_logo_lil, text_logo_lil, ini.set.logo_x + 65, ini.set.logo_y + 33, 0xFFFFFFFF)
						renderDrawTexture(logo_texture, ini.set.logo_x, ini.set.logo_y, 60, 60, 0, 0xFFFFFFFF)
					end
				end
			end
		end
	end
end

function command_menu()
	show_menu.v = not show_menu.v
end

function command_push()
	show_notification.v = not show_notification.v
end

function command_strobes()
	if isCharInAnyCar(playerPed) and ini.set.strobes  then
		local car = storeCarCharIsInNoSave(playerPed)
		local driverPed = getDriverOfCar(car)

		if playerPed == driverPed then
			local state = not isCarSirenOn(car)
			switchCarSiren(car, state)
		end
	end
end

function command_r(text)
	if not string.match(text, '(.+)') then addChat('Используйте команду /r [текст].')
	else
		local mark = sampGetMarkCharByVehicle(playerPed)
		
		local tab = {['cod 11'] = '$m to DISP, занимаю маркировку $m, CODE: 1-1, RFR, over **',
			['cod 13'] = '$m to DISP, освобождаю маркировку $m, CODE: 1-3, nRFR, over **',
			['cod 14'] = '$m to DISP, доставляю подозреваемого в департамент, CODE: 1-4, nRFR, over **',
			['tf 55'] = '$m to DISP, провожу 10-55, CODE: 4, 10-20 $p, nRFR, over **', 
			['tf 66'] = '$m to DISP, провожу 10-66, CODE: 3, 10-20 $p, nRFR, over **',
			['tf 9957v'] = '$m to DISP, 10-99 по 10-57 V, RFR, over **',
			['tf 9957f'] = '$m to DISP, 10-99 по 10-57 F, RFR, over **',
			['tf 995'] = '$m to DISP, 10-99 по 10-55, RFR, over **',
			['tf 996'] = '$m to DISP, 10-99 по 10-66, RFR, over **',
			['cod 0'] = '$m to DISP, CODE: 0, требуется срочная помощь!, 10-20 $p, nRFR, over **',
			['cod 1'] = '$m to DISP, CODE: 1, требуется помощь!, 10-20 $p, nRFR, over **',
		}
		
		for name, value in pairs(tab) do
			if text == name then
				text = string.gsub(text, name, value)
			end
		end
		
		text = string.gsub(text, '%$m', mark)
		text = string.gsub(text, '%$p', string.format('%s (%s)', calculateZone(), kvadrat()))
		text = string.format('%s %s', ini.info.rteg, text)
		
		if string.len(text) > 77 then
			sampSendChat(string.format('/r %s ...', string.sub(text, 0, 77)))
			sampSendChat(string.format('/r ... %s', string.sub(text, 78, string.len(text))))
		else
			sampSendChat(string.format('/r %s', text))
		end
		
		if ini.lowrp.rpradio and ini.set.lowrp then
			lua_thread.create(function()
				wait(800)
			
				if not ini.info.male then
					sampSendChat('/me снял тангету с плеча, зажал кнопку PTT и что-то произнёс по рации')
				else
					sampSendChat('/me сняла тангету с плеча, зажала кнопку PTT и что-то произнесла по рации')
				end
			end)
		end
	end
end

function command_rn(text) 
	if not string.match(text, '(%S+)') then addChat('Используйте команду /rn [текст].') else sampSendChat(string.format('/r (( %s ))', text)) end
end

function command_f(text)
	if not string.match(text, '(%S+)') then 
		addChat('Используйте команду /f [текст].')
	else 
		local mark = sampGetMarkCharByVehicle(playerPed)
		
		local tab = {['cod 11'] = '$m to DISP, занимаю маркировку $m, CODE: 1-1, RFR, over **',
			['cod 13'] = '$m to DISP, освобождаю маркировку $m, CODE: 1-3, nRFR, over **',
			['cod 14'] = '$m to DISP, доставляю подозреваемого в департамент, CODE: 1-4, nRFR, over **',
			['tf 55'] = '$m to DISP, провожу 10-55, CODE: 4, 10-20 $p, nRFR, over **', 
			['tf 66'] = '$m to DISP, провожу 10-66, CODE: 3, 10-20 $p, nRFR, over **',
			['tf 9957v'] = '$m to DISP, 10-99 по 10-57 V, RFR, over **',
			['tf 9957f'] = '$m to DISP, 10-99 по 10-57 F, RFR, over **',
			['tf 995'] = '$m to DISP, 10-99 по 10-55, RFR, over **',
			['tf 996'] = '$m to DISP, 10-99 по 10-66, RFR, over **',
			['cod 0'] = '$m to DISP, CODE: 0, требуется срочная помощь!, 10-20 $p, nRFR, over **',
			['cod 1'] = '$m to DISP, CODE: 1, требуется помощь!, 10-20 $p, nRFR, over **',
		}
		
		for name, value in pairs(tab) do
			if text == name then
				text = string.gsub(text, name, value)
			end
		end
		
		text = string.gsub(text, '%$m', mark)
		text = string.gsub(text, '%$p', string.format('%s (%s)', calculateZone(), kvadrat()))
		text = string.format('%s %s', ini.info.fteg, text)
		
		if string.len(text) > 77 then
			sampSendChat(string.format('/f %s ...', string.sub(text, 0, 77)))
			sampSendChat(string.format('/f ... %s', string.sub(text, 78, string.len(text))))
		else
			sampSendChat(string.format('/f %s', text))
		end
		
		if ini.lowrp.rpradio then
		
			lua_thread.create(function()
				wait(800)
			
				if not ini.info.male then
					sampSendChat('/me снял тангету с плеча, зажал кнопку PTT и что-то произнёс по рации')
				else
					sampSendChat('/me снял тангету с плеча, зажала кнопку PTT и что-то произнесла по рации')
				end
			end)
		end
	end
end

function command_fn(text)
	if not string.match(text, '(%S+)') then addChat('Используйте команду /f [текст].') else sampSendChat(string.format('/f (( %s ))', text)) end
end

function command_radiotag()
	local text = ''
	text = string.format('%s\n{FFCD00}cod 11\t\t{ffffff}$m to DISP, занимаю маркировку $m, CODE: 1-1, RFR, over **', text)
	text = string.format('%s\n{FFCD00}cod 13\t\t{ffffff}$m to DISP, освобождаю маркировку $m, CODE: 1-3, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}cod 14\t\t{ffffff}$m to DISP, доставляю подозреваемого в департамент, CODE: 1-4, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 55\t\t{ffffff}$m to DISP, Провожу 10-55, CODE: 4, 10-20 $p, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 66\t\t{ffffff}$m to DISP, Провожу 10-66, CODE: 3, 10-20 $p, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 9957v\t\t{ffffff}$m to DISP, 10-99 по 10-57 V, RFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 9957f\t\t{ffffff}$m to DISP, 10-99 по 10-57 F, RFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 995\t\t{ffffff}$m to DISP, 10-99 по 10-55, RFR, over **', text)
	text = string.format('%s\n{FFCD00}tf 996\t\t{ffffff}$m to DISP, 10-99 по 10-66, RFR, over **', text)
	text = string.format('%s\n{FFCD00}cod 0\t\t{ffffff}$m to DISP, CODE: 0, требуется срочная помощь!, 10-20 $p, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}cod 1\t\t{ffffff}$m to DISP, CODE: 1, требуется помощь!, 10-20 $p, nRFR, over **', text)
	text = string.format('%s\n{FFCD00}$m\t\t{ffffff}Маркировка автомобиля', text)
	text = string.format('%s\n{FFCD00}$p\t\t{ffffff}Местоположение (Район / Квадрат)', text)
	
	sampShowDialog(1005, '{FFCD00}Список радио-тэгов для рации', text, 'Закрыть', '', 2)
end

function command_reconnect(parametrs)
	if string.match(parametrs, '(%d+)') then
		local delay = tonumber(parametrs)
		if delay > 0 and delay <= 60 then
			reconnect(delay)
		else
			addChat('Задержка между переподключениями не должна быть менее 0 и более 60 секунд.')
		end
	else
		addChat('Используйте команду /rec [задержка].')
	end
end

function command_reconnectwithchange(parametrs)
	if string.match(parametrs, '(%d+) (%S+)') then
		local delay, name = string.match(parametrs, '(%d+) (.+)')
		local delay = tonumber(delay)
		if delay > 0 and delay <= 60 then
			sampSetLocalPlayerName(name)
			reconnect(delay)
		else
			addChat('Задержка между переподключениями не должна быть менее 0 и более 60 секунд.')
		end
	else
		addChat('Используйте команду /recn [задержка] [никнейм].')
	end
end

function command_reconnectwithchangeip(parametrs)
	if string.match(parametrs, '(%d+) (%S+)') then
		local id, name = string.match(parametrs, '(%d+) (.+)')
		local id = tonumber(id)
		if id >= 1 and id <= 9 then
			sampSetLocalPlayerName(name)
			reconnect(1, string.format('5.254.104.13%d:7777', id))
		else
			addChat('Номер сервера не должен быть менее 1 и более 9.')
		end
	elseif string.match(parametrs, '(%d+)') then
		local id = tonumber(parametrs)
		if id >= 1 and id <= 9 then
			reconnect(1, string.format('5.254.104.13%d:7777', id))
		else
			addChat('Номер сервера не должен быть менее 1 и более 9.')
		end
	else
		addChat('Используйте команду /recd [номер сервера] [никнейм (необязательно)]')
	end
end

function reconnect(delay, ip)
	if type(delay) == ('number') and ip == nil then
		lua_thread.create(function()
			local wdelay = delay * 1000
			printStyledString(string.format('~w~reconnect with ~p~ %d ~w~ seconds delay', delay), wdelay, 4)
			sampDisconnectWithReason(1)
			wait(wdelay)
			sampSetGamestate(1)
		end)
	elseif type(delay) == ('number') and type(ip) == ('string') then
		lua_thread.create(function()
			if string.match(ip, '(%S+):(%d+)') then
				local ipadress, port = string.match(ip, '(.+):(%d+)')
				local port = tonumber(port)
				local wdelay = delay * 1000
				printStyledString(string.format('~w~reconnect with ~p~ %d ~w~ seconds delay', delay), wdelay, 4)
				sampConnectToServer(ipadress, port)
			end
		end)
	end
end

function command_rkinfo()
	if dreason[1] ~= nil then
		local timed = getTimeByPeriod(tonumber(dreason[2]), tonumber(dreason[3]), tonumber(dreason[4]), ini.set.delay_rk)
		addChat(string.format('Вы можете вернутся в район %s в %d ч. %d мин. %d сек.', dreason[1], timed[1], timed[2], timed[3]))
		if sampGetPassedTimeByPeriod(tonumber(dreason[2]), tonumber(dreason[3]), tonumber(dreason[4]), ini.set.delay_rk) then
			addChat(string.format('Время вышло и вы уже {00cc99}можете{ffffff} вернутся в район %s.', dreason[1]))
		else
			addChat(string.format('В данный момент Вы {ff5c33}не можете{ffffff} вернутся в район %s.', dreason[1]))
			if tostring(calculateZone()) == tostring(dreason[1]) then
				addChat(string.format(' {ff5c33}[ПРЕДУПРЕЖДЕНИЕ] {ffffff}Вы находитесь в запрещённом для Вас районе %s.', dreason[1]))
			end
		end
	else
		addChat('Вы не умирали.')
	end
end

function command_apay(param)
	if string.match(param, '(%d+) (%d+)') then
		local id, money = string.match(param, '(%d+) (%d+)')
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 3 then
				if tonumber(money) < 200000 then
					lua_thread.create(function()
						while sampGetDistanceToPlayer(id) < 3 do
							if (tonumber(money) - 5000) <= 0 then
								sampSendChat(string.format('/pay %d %d', id, money))
								break
							else
								sampSendChat(string.format('/pay %d 5000', id, money))
								money = tonumber(money) - 5000
							end
							wait(3500)
						end
					end)
				else
					addChat('Невозможно передать более 200.000$.')
				end
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /pay [ид игрока] [сумма]')
	end
end

function table_to_text(tab)
	for i, val in pairs(tab) do
		imgui.TextColoredRGB(val)
	end
end

function command_report(text)
	if not string.match(text, '(.+)') then
		addChat('Используйте команду /rep [текст].')
	else
		toReport = text
		sampSendChat('/mn')
	end
end

function command_sms(value)
	if string.match(value, '(%d+) (%S+)') then 
		local number, text = string.match(value, '(%d+) (.+)')
		local found = false
		
		if IPC(number) then
			local name = sampGetPlayerName(number)
			if ini.number[name] ~= nil then
				number = ini.number[name]
			else
				addChat('Номер не найден в базе данных.')
				found = true
			end
		end
		
		if not found then
			if string.len(text) > 60 then
				sampSendChat(string.format('/sms %d %s ..', number, string.sub(text, 0, 60)))
				sampSendChat(string.format('/sms %d .. %s', number, string.sub(text, 61, string.len(text))))
			else
				sampSendChat(string.format('/sms %d %s', number, string.sub(text, 0, 60)))
			end
		end
	else
		addChat('Используйте команду /sms [номер телефона] [сообщение]')
	end
end

function command_addbl(name)
	if string.match(name, '(%S+)') then
		local path = 'moonloader//helper//black-list.txt'
		
		local filew = io.open(path, 'a')
		filew:write(name)
		filew:close()
		
		addChat(string.format('Игрок {FFCD00}%s{ffffff} был добавлен в чёрный список.', name))
	else
		addChat('Используйте команду /addbl [имя игрока]')
	end
end

function command_delbl(name)
	if string.match(name, '(%S+)') then
		local path = 'moonloader//helper//black-list.txt'
		
		local filer = io.open(path, 'r')
		local bl = filer:read('*a')
		filer:close()
		
		if bl:find(name) then
			local text = string.gsub(bl, name, '')
			local filew = io.open(path, 'w')
			filew:write(text)
			filew:close()
			
			addChat(string.format('Игрок {FFCD00}%s{ffffff} был удалён из чёрного списка.', name))
		else
			addChat('Данного игрока нет в чёрном списке.')
		end
	else
		addChat('Используйте команду /debl [имя игрока]')
	end
end

function command_asms(text)
	if string.match(text, '(%S+)') then
		if last_sms ~= 0 then
			command_sms(string.format('%d %s', last_sms, text))
		else
			addChat('Ранее вам никто не отправлял SMS-сообщения.')
		end
	else
		addChat('Используйте команду /asms [текст].')
	end
end

function command_gov(id) 
	if player_status > 0 then
		if string.match(id, '(%d+)') then
			if gnews[1] ~= nil then
				local timed = getTimeByPeriod(tonumber(gnews[1]), tonumber(gnews[2]), tonumber(gnews[3]), 5)
				if sampGetPassedTimeByPeriod(tonumber(gnews[1]), tonumber(gnews[2]), tonumber(gnews[3]), 5) then
					send_gnews(id)
				else
					addChat(string.format('В данный момент Вы {ff5c33}не можете{ffffff} отправить гос. новость.', gnews[1]))
				end
			else
				send_gnews(id)
			end
		else
			if gnews[1] ~= nil then
				local timed = getTimeByPeriod(tonumber(gnews[1]), tonumber(gnews[2]), tonumber(gnews[3]), 5)
				if sampGetPassedTimeByPeriod(tonumber(gnews[1]), tonumber(gnews[2]), tonumber(gnews[3]), 5) then
					addChat('Используйте команду /gov [ид новости]. Вы {00cc99}можете{ffffff} отправить гос. новость.')
				else
					addChat('Используйте команду /gov [ид новости]. Вы {ff5c33}не можете{ffffff} отправить гос. новость.')
					addChat(string.format('Вы сможете отправить гос. новость в %d ч. %d мин. %d сек.', timed[1], timed[2], timed[3]))
				end
			else
				addChat('Используйте команду /gov [ид новости]. Вы {00cc99}можете{ffffff} отправить гос. новость.')
			end
		end
	else
		addChat('Вы не можете использовать данную функцию, вы не лидер.')
	end
end

function send_gnews(id)
	if doesFileExist(string.format('moonloader//helper//gnews//news-%d.txt', id)) then
		local gtype = '0'
		lua_thread.create(function()
			for val in io.lines(string.format('moonloader//helper//gnews//news-%d.txt', id)) do
				if string.match(val, 'type=(%d+)') then
					gtype = string.match(val, 'type=(%d+)')
				elseif string.match(val, 'line(%d+)=(.+)') then
					local line, text = string.match(val, 'line(%d+)=(.+)')
					if tonumber(gtype) == 3 then
						if tonumber(line) <= 3 then
							if tonumber(line) == 1 then sampSendChat(string.format('/gnews %s', text)) end
							if tonumber(line) == 2 then sampSendChat(string.format('/gnews %s', text)) end
							if tonumber(line) == 3 then sampSendChat(string.format('/gnews %s', text)) end
							gnews = {os.date('%H'), os.date('%M'), os.date('%S'), 3}
						end
					elseif tonumber(gtype) == 1 then
						if tonumber(line) == 4 then sampSendChat(string.format('/gnews %s', text)) end
						gnews = {os.date('%H'), os.date('%M'), os.date('%S'), 1}
					end
					
					wait(1000)
				end
			end
		end)
	else
		addChat('Не найдена новость с данным ID.')
	end
end

function decode()
	local f = io.open(thisScript().path, 'r')
	local text = f:read('*a')
	f:close()
		
	local fw = io.open(thisScript().path, 'w')
	fw:write(u8:decode(text))
	fw:close()
end

function command_rights()
	lua_thread.create(function()
		sampSendChat('Вы имеете право хранить молчание. ')
		wait(1500)
		sampSendChat('Всё, что вы скажете, может и будет использовано против вас в суде. ')
		wait(1500)
		sampSendChat('Ваш адвокат может присутствовать при допросе. ')
		wait(1500)
		sampSendChat('Если вы не можете оплатить услуги адвоката, он будет предоставлен вам государством.')
		wait(1500)
		sampSendChat('Вы понимаете свои права?')
	end)
end

function command_setskin(param)
	if player_status > 1 then
		if string.match(param, '(%d+) (%d+) (%d+)') then
			local id, skin, state = string.match(param, '(%d+) (%d+) (%d+)')
			if IPC(id) then
				if sampGetDistanceToPlayer(id) < 200 then
					local BS = raknetNewBitStream()
					raknetBitStreamWriteInt32(BS, id)
					raknetBitStreamWriteInt32(BS, skin)
					raknetEmulRpcReceiveBitStream(153, BS)
					raknetDeleteBitStream(BS)
					
					local name = string.gsub(sampGetPlayerName(id),'_',' ')
					if tonumber(state) ~= 1 then addChat('Вы установили визуальный скин ({FFCD00}' .. skin .. '{ffffff}) для игрока ' .. name .. '[' .. id .. ']') end
				else
					addChat('Данный игрок находится слишком далеко от Вас.')
				end
			else
				addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			addChat('Используйте команду /sskin [ид игрока] [ид скина] [0 или 1].')
		end
	end
end

function command_history(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			sampSendChat(string.format('/history %s', sampGetPlayerName(id)))
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID или введите никнейм.')
		end
	elseif string.match(id, '(%S+)') then
		sampSendChat(string.format('/history %s', id))
	else
		addChat('Используйте команду /history [никнейм или ид игрока].')
	end
end

function command_setweather(id)
	if string.match(id, '(%d+)') then 
		if tonumber(id) > 0 and tonumber(id) <= 45 then
			forceWeatherNow(id)
			addChat('Вы установили ID погоды {FFCD00}' .. id .. '.')
		else
			addChat('ID погоды не должен быть больше 45 и меньше 1.')
		end
	else
		addChat('Используйте команду /sw [ид погоды].')
	end
end

function command_settime(param)
	if string.match(param, '(%d+) (%d+)') then
		local hour, min = string.match(param, '(%d+) (%d+)')
		if tonumber(hour) >= 0 and tonumber(hour) <= 23 and tonumber(min) >= 0 and tonumber(min) < 60 then
			patch_samp_time_set(true)
			set_time = {hour, min}
			addChat('Вы установили время {FFCD00}' .. hour .. '{ffffff} часов, {FFCD00}' .. min .. '{ffffff} минут.')
		else
			patch_samp_time_set(false)
			set_time = nil
			addChat('Часы не должны быть больше 23 и меньше 0. Минуты не должны быть больше 59 и меньше 0.')
		end
	else
		addChat('Используйте команду /st [часы] [минуты].')
	end
end

function command_ud()
	lua_thread.create(function()
		if not ini.info.male then
			sampSendChat('/me достал удостоверение, открыл его и показал человеку напротив')
			wait(1500); sampSendChat('/do В удостоверение: ' .. ini.info.frac .. ', ' .. ini.info.rang .. ', ' .. ini.info.name .. '.')
			wait(1000); sampSendChat('/me закрыл удостоверение и убрал его обратно')

		else
			sampSendChat('/me достала удостоверение, открыла его и показала человеку напротив')
			wait(1500); sampSendChat('/do В удостоверение: ' .. ini.info.frac .. ', ' .. ini.info.rang .. ', ' .. ini.info.name .. '.')
			wait(1000); sampSendChat('/me закрыла удостоверение и убрала его обратно')
		end
	end)
end

function command_pas(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 5 then
				lua_thread.create(function()
					sampSendChat(sampGetHelloByTime() .. ', я ' .. ini.info.rang .. ' ' .. ini.info.name .. '.')
					wait(1000); sampSendChat('/do На груди висит значок с личным номером №000' .. ini.info.number .. '.')
					wait(1500); sampSendChat('Будьте любезны, предъявите документы, удостоверяющие вашу личность.')
					if ini.set.autopass then autopass = true end
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /pas [ид игрока].')
	end
end

function command_search(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 5 then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me из внутреннего кармана достал белые, латекстные перчатки и надел их на руки')
					else
						sampSendChat('/me из внутреннего кармана достала белые, латекстные перчатки и надела их на руки')
					end
					wait(1500); sampSendChat('/me осмотривает все карманы, возможные места хранение запрещённых веществ и предметов')
					wait(1000); sampSendChat(string.format('/search %d', id))
					idsearch = id
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /search [ид игрока].')
	end
end

function search_file(file, text, bool)
	if type(file) == ('string') and type(text) == ('string') then
		if doesFileExist(string.format('moonloader\\helper\\%s.txt', file)) then
			for line in io.lines(string.format('moonloader\\helper\\%s.txt', file)) do
				if line:find(text) then 
					for i = 0, string.len(line) / 115 do
						addChat(string.sub(line, i * 115, i * 115 + 114))
					end
					
					if not bool then break end
				end
			end
		end
	end
end

function search_law(table, text)
	if table ~= nil and text ~= nil then
		for _, val in pairs(table) do
			for i, item in ipairs(val.st) do
				if string.match(item, '(.+) | (.+) | (.+)') then
					local stars, reason, info = string.match(item, '(.+) | (.+) | (.+)')

					if info:find(text) then
						addChat(string.format('%s,  %d | %s', reason, stars, info))
						break
					end
				end
			end
		end
	end
end

function command_ustav(text)
	if not string.match(text, '(.+)') then addChat('Используйте команду /устав [часть или номер статьи]')
	else
		search_file('ustav', text)
	end
end

function command_uk(text)
	if not string.match(text, '(%S+)') then show_uk_list.v = not show_uk_list.v
	else
		--search_law(smart_suspect.text, text)
	end
end

function command_ak(text)
	if not string.match(text, '(%S+)') then show_ak_list.v = not show_ak_list.v
	else
		--search_file('ak', text)
	end
end

function command_code(text)
	if not string.match(text, '(.+)') then addChat('Используйте команду /код [часть или номер кода]')
	else
		search_file('code', text)
	end
end

function command_hack(id)
	if string.match(id, '(%d+)') then
		lua_thread.create(function()
			if not ini.info.male then
				sampSendChat('/do На плечах висит рюкзак в котором лежит балончик с заморозкой.')
				wait(1500); sampSendChat('/me скинув рюкзак с плеч, открыл его и достал балончик')
				wait(1500); sampSendChat('/me закрыл рюкзак и повесил его на плечи')
				wait(1500); sampSendChat('/me встряхнув балончик, распылил содержимое на дверной замок')
				wait(1500); sampSendChat('/do Под действием содержимого балончика замок промёрз и стал хрупок.')
				wait(1500); sampSendChat('/me снял дубинку с поясного держателя и, размахнувшись, ударил тыльной частью по замку')
			else
				sampSendChat('/do На плечах висит рюкзак в котором лежит балончик с заморозкой.')
				wait(1500); sampSendChat('/me скинув рюкзак с плеч, открыла его и достала балончик')
				wait(1500); sampSendChat('/me закрыла рюкзак и повесила его на плечи')
				wait(1500); sampSendChat('/me встряхнув балончик, распылила содержимое на дверной замок')
				wait(1500); sampSendChat('/do Под действием содержимого балончика замок промёрз и стал хрупок.')
				wait(1500); sampSendChat('/me сняла дубинку с поясного держателя и, размахнувшись, ударила тыльной частью по замку')
			end
			wait(1000); sampSendChat(string.format('/hack %d', id))
		end)
	else
		addChat('Используйте команду /hack [ид дома]')
	end
end

function command_invite(param)
	if player_status > 0 then
		if string.match(param, '(%d+) (%d+)') then
			inv_id, inv_rang = string.match(param, '(%d+) (%d+)')
			if IPC(id) then
				if sampGetDistanceToPlayer(inv_id) < 3 then
					lua_thread.create(function()
						if not ini.info.male then
							sampSendChat('/me из внутреннего кармана достал планшет и включил его')
							wait(1500); sampSendChat('/me зайдя в базу данных, добавил новое личное дело ' .. string.gsub(sampGetPlayerName(inv_id),'_',' ') .. '')
							wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
							wait(1500); sampSendChat('/me достал ключ от шкафчика под номером ' .. inv_id .. ' и передал его ' .. string.gsub(sampGetPlayerName(inv_id),'_',' '))
						else
							sampSendChat('/me из внутреннего кармана достала планшет и включила его')
							wait(1500); sampSendChat('/me зайдя в базу данных, добавила новое личное дело ' .. string.gsub(sampGetPlayerName(inv_id),'_',' ') .. '')
							wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
							wait(1500); sampSendChat('/me достала ключ от шкафчика под номером ' .. inv_id .. ' и передала его ' .. string.gsub(sampGetPlayerName(inv_id),'_',' '))
						end
						wait(1000); sampSendChat(string.format('/invite %d', inv_id))
					end)
				else
					addChat('Данный игрок находится слишком далеко от Вас.')
				end
			else
				addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			addChat('Используйте команду /invite [ид игрока] [ранг].')
		end
	else
		addChat('Вы не можете использовать данную функцию, вы не лидер и не его заместитель.')
	end
end

function command_uninvite(param)
	if player_status > 0 then
		if string.match(param, '(%d+) (%S+)') then
			local id, reason = string.match(param, '(%d+) (.+)')
			if IPC(id) then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me из внутреннего кармана достал планшет и включил его')
						wait(1500); sampSendChat('/me зайдя в базу данных, удалил личное дело ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. '')
						wait(1000); sampSendChat(string.format('/uninvite %d %s', id, reason))
						wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
					else
						sampSendChat('/me из внутреннего кармана достала планшет и включила его')
						wait(1500); sampSendChat('/me зайдя в базу данных, удалила личное дело ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. '')
						wait(1000); sampSendChat(string.format('/uninvite %d %s', id, reason))
						wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
					end
					wait(1000); command_r('Сотрудник ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. ' уволен по причине: ' .. reason)
				end)
			else
				addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			addChat('Используйте команду /uninvite [ид игрока] [причина].')
		end
	else
		addChat('Вы не можете использовать данную функцию, вы не лидер и не его заместитель.')
	end
end

function command_follow()
	lua_thread.create(function()
		if follow_state then
			if not ini.info.male then
				sampSendChat('/me достал планшет, перешёл в базу данных и выбрал пункт с настройкой радио-канала')
				wait(1000); sampSendChat('/follow')
				wait(1500); sampSendChat('/me отключился от внутреннего радио-канала, снял наушники и убрал их')
				wait(1500); sampSendChat('/me потушил экран планшета, убрал его обратно')
			else
				sampSendChat('/me достала планшет, перешла в базу данных и выбрала пункт с настройкой радио-канала')
				wait(1000); sampSendChat('/follow')
				wait(1500); sampSendChat('/me отключилась от внутреннего радио-канала, сняла наушники и убрала их')
				wait(1500); sampSendChat('/me потушила экран планшета, убрала его обратно')
			end
		else
			if not ini.info.male then
				sampSendChat('/me достал планшет, перешёл в базу данных и выбрал пункт с настройкой радио-канала')
				wait(1500); sampSendChat('/me ввёл необходимые параметры для подключенния к внутреннему радио-каналу')
				wait(1500); sampSendChat('/me достал наушники, параллельно заполнив нужную форму получения радио-сигналов')
				wait(1000); sampSendChat('/follow')
				wait(1500); sampSendChat('/me надел наушники, проверил звук, потушил экран планшета и убрал его')
			else
				sampSendChat('/me достала планшет, перешла в базу данных и выбрала пункт с настройкой радио-канала')
				wait(1500); sampSendChat('/me ввела необходимые параметры для подключенния к внутреннему радио-каналу')
				wait(1500); sampSendChat('/me достала наушники, параллельно заполнив нужную форму получения радио-сигналов')
				wait(1000); sampSendChat('/follow')
				wait(1500); sampSendChat('/me надела наушники, проверила звук, потушила экран планшета и убрала его')
			end
		end
	end)
end

function command_rang(param)
	if player_status > 0 then
		if string.match(param, '(%d+) [+?-]') then
			local id, rang = string.match(param, '(%d+) (.+)')
			if IPC(id) then
				if sampGetDistanceToPlayer(id) < 3 then
					lua_thread.create(function()
						if not ini.info.male then
							sampSendChat('/me из внутреннего кармана достал планшет и включил его')
							wait(1500); sampSendChat('/me зайдя в базу данных, изменил должность ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. '')
							wait(1000); sampSendChat(string.format('/rang %d %s', id, rang))
							wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
						else
							sampSendChat('/me из внутреннего кармана достала планшет и включила его')
							wait(1500); sampSendChat('/me зайдя в базу данных, изменила должность ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. '')
							wait(1000); sampSendChat(string.format('/rang %d %s', id, rang))
							wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
						end
					end)
				else
					addChat('Данный игрок находится слишком далеко от Вас.')
				end
			else
				addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			addChat('Используйте команду /rang [ид игрока] [+ или -].')
		end
	else
		addChat('Вы не можете использовать данную функцию, вы не лидер и не его заместитель.')
	end
end

function command_changeskin(id)
	if player_status > 0 then
		if string.match(id, '(%d+)') then
			if IPC(id) then
				if sampGetDistanceToPlayer(id) < 3 then
					lua_thread.create(function()
						if not ini.info.male then
							sampSendChat('/me достал ключ от шкафчика под номером ' .. id .. ' и передал его ' .. string.gsub(sampGetPlayerName(id),'_',' '))
						else
							sampSendChat('/me достала ключ от шкафчика под номером ' .. id .. ' и передала его ' .. string.gsub(sampGetPlayerName(id),'_',' '))
						end
						wait(1000); sampSendChat(string.format('/changeskin %d', id))
					end)
				else
					addChat('Данный игрок находится слишком далеко от Вас.')
				end
			else
				addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
			end
		else
			addChat('Используйте команду /changeskin [ид игрока].')
		end
	else
		addChat('Вы не можете использовать данную функцию, вы не лидер и не его заместитель.')
	end
end

function command_cuff(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 3 then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me завёл руки нарушителя за спину, после чего растягнул чехол для наручников'); wait(1500)
						sampSendChat('/me достав наручники из чехла, застегнул их на запястьях преступника')
					else
						sampSendChat('/me завела руки нарушителя за спину, после чего растягнула чехол для наручников'); wait(1500)
						sampSendChat('/me достав наручники из чехла, застегнула их на запястьях преступника')
					end
					wait(1000); sampSendChat(string.format('/cuff %d', id))
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /cuff [ид игрока].')
	end
end

function command_uncuff(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 3 then
				lua_thread.create(function()
					sampSendChat('/do На запястьях ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. ' находятся наручники.'); wait(1500)
					if not ini.info.male then
						sampSendChat('/me сняв с пояса связку ключей, провернул один из них в замке наручников'); wait(1000)
						sampSendChat(string.format('/uncuff %d', id)); wait(1500)
						sampSendChat('/me убрав наручники в чехол, повесил связку ключей на пояс')
					else
						sampSendChat('/me сняв с пояса связку ключей, провернула один из них в замке наручников'); wait(1000)
						sampSendChat(string.format('/uncuff %d', id)); wait(1500)
						sampSendChat('/me убрав наручники в чехол, повесила связку ключей на пояс')
					end
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /uncuff [ид игрока].')
	end
end

function command_skip(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 5 then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me из внутреннего кармана достал планшет и включил его')
						wait(1500); sampSendChat('/me зайдя в базу данных, оформил временный пропуск на имя ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. '')
						wait(1000); sampSendChat(string.format('/skip %d', id))
						wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
						wait(1000); command_r('Оформил временный пропуск на имя ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. '.')
					else
						sampSendChat('/me из внутреннего кармана достала планшет и включила его')
						wait(1500); sampSendChat('/me зайдя в базу данных, оформила временный пропуск на имя ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. '')
						wait(1000); sampSendChat(string.format('/skip %d', id))
						wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
						wait(1000); command_r('Оформил временный пропуск на имя ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. '.')
					end
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /skip [ид игрока].')
	end
end

function command_upopen()
	lua_thread.create(function()
		sampSendChat('/open')
		openbar = true
		wait(150)
		openbar = false
	end)
end

function command_clear(param)
	if string.match(param, '(%d+) (%S+)') then
		local id, reason = string.match(param, '(%d+) (.+)')
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 10 then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me достав планшет, зашёл в базу данных и нашёл нужное дело')
						wait(1500); sampSendChat('/me пролистав страницу в самый низ, выбрал пункт с закрытием дела')
						wait(1000); sampSendChat(string.format('/clear %d' , id))
						wait(1500); command_f('Дело №' .. id .. ' (' .. string.gsub(sampGetPlayerName(id),'_',' ') .. ') закрыто. Причина: ' .. reason .. '')
						wait(1500); sampSendChat('/me потушил экран планшета и убрал его обратно')
					else
						sampSendChat('/me достав планшет, зашла в базу данных и нашла нужное дело')
						wait(1500); sampSendChat('/me пролистав страницу в самый низ, выбрала пункт с закрытием дела')
						wait(1000); sampSendChat(string.format('/clear %d' , id))
						wait(1500); command_f('Дело №' .. id .. ' (' .. string.gsub(sampGetPlayerName(id),'_',' ') .. ') закрыто. Причина: ' .. reason .. '')
						wait(1500); sampSendChat('/me потушила экран планшета и убрала его обратно')
					end
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /clear [ид игрока] [причина].')
	end
end

function command_putpl(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 4 then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me подведя подозреваемого к автомобилю, открыл дверь и посадил его туда')
					else
						sampSendChat('/me подведя подозреваемого к автомобилю, открыла дверь и посадила его туда')
					end
					wait(1000); sampSendChat(string.format('/putpl %d', id))
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /putpl [ид игрока].')
	end
end

function command_hold(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 3 then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me заломав руку подозреваемого, повёл его за собой')
					else
						sampSendChat('/me заломав руку подозреваемого, повела его за собой')
					end
					wait(1000); sampSendChat(string.format('/hold %d', id))
					wait(1000); sampSendChat('/n При багоюзе (нажатие G) тебя кикнет и ты попадёшь в КПЗ.')
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /hold [ид игрока].')
	end
end

function command_ticket(param)
	if string.match(param, '(%d+) (%d+) (%S+)') then
		local id, money, reason = string.match(param, '(%d+) (%d+) (.+)')
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 5 then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me достал блокнот, ручку и начал записывать информацию о нарушении')
						wait(1500); sampSendChat('/me заполнив всю информацию о нарушении, передал бланк нарушителю')
						wait(1000); sampSendChat(string.format('/ticket %d %d %s', id, money, reason))
						wait(1500); sampSendChat('/me убрал блокнот и ручку обратно во внутренний карман')
					else
						sampSendChat('/me достала блокнот, ручку и начала записывать информацию о нарушении')
						wait(1500); sampSendChat('/me заполнив всю информацию о нарушении, передала бланк нарушителю')
						wait(1000); sampSendChat(string.format('/ticket %d %d %s', id, money, reason))
						wait(1500); sampSendChat('/me убрала блокнот и ручку обратно во внутренний карман')
					end
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Вы ввели неверный ид игрока (игрок не авторизован)')
		end
	elseif string.match(param, '(%d+)') then
		local id = string.match(param, '(%d+)')
		if IPC(id) then
			if sampGetDistanceToPlayer(id) <= 5 then
				if smart_ticket.text ~= nil then
					smart_ticket.id = id
					show_ticket.v = not show_ticket.v
				else
					addChat('Данная возможность Вам недоступна.')
				end
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /ticket [ид игрока] [сумма] [причина]')
	end
end

function command_takelic(param)
	if string.match(param, '(%d+) (%S+)') then
		local id, reason = string.match(param, '(%d+) (.+)')
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 15 then
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me достал планшет, зашёл в базу данных и ввёл номер Т/С')
						wait(1500); sampSendChat('/me получив информацию о водителе, изъял его лицензию на вождение')
					else
						sampSendChat('/me достала планшет, зашла в базу данных и ввела номер Т/С')
						wait(1500); sampSendChat('/me получив информацию о водителе, изъяла его лицензию на вождение')
					end
					wait(1000); sampSendChat(string.format('/takelic %d %s', id, reason))
				end)
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Вы ввели неверный ид игрока (игрок не авторизован)')
		end
	else
		addChat('Используйте команду /takelic [ид игрока] [причина]')
	end
end

function command_pull(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 3 then
				local res, vid = sampIsPlayerCar(id)
				if res then
					lua_thread.create(function()
						if tCarsType[vid - 399] == 2 or tCarsType[vid - 399] == 9 then
							if not ini.info.male then
								sampSendChat('/me подойдя к подозреваемому, толкнул его, тем самым скинул его с байка')
								wait(1000); sampSendChat(string.format('/pull %d', id))
							else
								sampSendChat('/me подойдя к подозреваемому, толкнула его, тем самым скинула его с байка')
								wait(1000); sampSendChat(string.format('/pull %d', id))
							end
						else
							if not ini.info.male then
								sampSendChat('/me сняв дубинку с пояса, ударил её тыльную частью по стеклу')
								wait(1500); sampSendChat('/me повесив дубинку на пояс, просунул руку в стекло и открыл дверь')
								wait(1500); sampSendChat('/me взявшись за подозреваемого, вытащил его из машины')
								wait(1000); sampSendChat(string.format('/pull %d', id))
							else
								sampSendChat('/me сняв дубинку с пояса, ударила её тыльную частью по стеклу')
								wait(1500); sampSendChat('/me повесив дубинку на пояс, просунула руку в стекло и открыла дверь')
								wait(1500); sampSendChat('/me взявшись за подозреваемого, вытащила его из машины')
								wait(1000); sampSendChat(string.format('/pull %d', id))
							end
						end
					end)
				else
					addChat('Данный игрок не находится в автомобиле.')
				end
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /pull [ид игрока].')
	end
end

function command_arrest(id)
	if string.match(id, '(%d+)') then
		if IPC(id) then
			if sampGetDistanceToPlayer(id) < 5 then
				if sampIsPlayerCarHaveSuspect(id) then
					lua_thread.create(function()
						if not ini.info.male then
							sampSendChat('/me включил бортовой компьютер и заполнил информацию о нарушителе'); wait(1500)
							sampSendChat('/me снял рацию с плеча, поднёс её ко рту и что-то произнёс'); wait(1000)
						else
							sampSendChat('/me включила бортовой компьютер и заполнила информацию о нарушителе'); wait(1500)
							sampSendChat('/me сняла рацию с плеча, поднесла её ко рту и что-то произнесла'); wait(1000)
						end
						command_r(('Подозреваемый по делу №%d (%s) передан в департамент.'):format(id, string.gsub(sampGetPlayerName(id),'_',' '))); wait(1000)
						sampSendChat(string.format('/arrest %d', id))
					end)
				else
					addChat('В вашей машине не находится данный игрок.')
				end
			else
				addChat('Данный игрок находится слишком далеко от Вас.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /arrest [ид игрока].')
	end
end

function command_su(param)
	if string.match(param, '(%d+) (%d+) (%S+)') then
		local id, stars, reason = string.match(param, '(%d+) (%d+) (.+)')
		if IPC(id) then
			if sampGetPlayerColor(id) ~= 2236962 then
				lua_thread.create(function()
					if sampGetCharHandleBySampPlayerId(id) then
						if not ini.info.male then
							sampSendChat('/me сняв тангету с плеча, передал диспетчеру информацию о подозреваемом')
						else
							sampSendChat('/me сняв тангету с плеча, передала диспетчеру информацию о подозреваемом')
						end
						
						wait(1000)
						
						if sampGetDistanceToPlayer(id) <= 65 then
							sampSendChat(string.format('/su %d %d %s', id, stars, reason))
							wait(1500)
							sampSendChat('/do ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. ' был объявлен в розыск по причине: ' .. reason .. '.')
						else
							addChat('Подозреваемый слишком далеко, розыск выдастся сразу же, как будет возможность.')
							while sampGetDistanceToPlayer(id) > 65 do
								wait(0)
							
								local result, ped = sampGetCharHandleBySampPlayerId(id)
								if not result then 
									addChat('Подозревамый пропал из зоны видимости.')
									break
								elseif sampGetPlayerColor(id) == 2236962  then
									addChat('Подозреваемый надел на лицо маску, невозможно выдать розыск.')
									break
								end
							end
							
							if sampGetDistanceToPlayer(id) <= 65 then
								sampSendChat(string.format('/su %d %d %s', id, stars, reason))
								wait(1500)
								sampSendChat('/do ' .. string.gsub(sampGetPlayerName(id),'_',' ') .. ' был объявлен в розыск по причине: ' .. reason .. '.')
							end
						end
					else
						addChat('Данный игрок находится слишком далеко от Вас.')
					end
				end)
			else
				addChat('Данный игрок находится в маске.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	elseif string.match(param, '(%d+)') then
		local id = string.match(param, '(%d+)')
		if IPC(id) then
			if sampGetPlayerColor(id) ~= 2236962 then
				if sampGetDistanceToPlayer(id) <= 65 then
					if smart_suspect.text ~= nil then
						smart_suspect.id = id
						show_suspect.v = not show_suspect.v
					else
						addChat('Данная возможность Вам недоступна.')
					end
				else
					addChat('Данный игрок находится слишком далеко от Вас.')
				end
			else
				addChat('Данный игрок находится в маске.')
			end
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	else
		addChat('Используйте команду /su [ид игрока] [кол-во звёзд] [причина].')
	end
end

function command_users()
	if player_status > 2 then
		async_http_request('GET', 'https://raw.githubusercontent.com/skezz-perry/project/master/users', nil,
			function(response)
				users = response.text
		end)
			
		local dline = 'Имя\tСтатус\tДата окончания подписки\tСтатус подписки\n'
		local all = 0
		local online = 0

		for line in string.gmatch(users, "[^\n]+") do
			if string.match(line, '(.+) | (.+) | (.+) | (.+) | (.+)') then
				local name, rang, nrang, serial, date = string.match(line, '(.+) | (.+) | (.+) | (.+) | (.+)')
				local rang = u8:decode(rang)
				local id = sampGetPlayerIdByNickname(name)
				all = all + 1

				local rang = string.format('%s %s', getColorRang(nrang), rang)

				if checkValiditySubscription(date) then
					status = string.format('%s\t{00cc99}Дейсвительна', date)
				else
					status = string.format('%s\t{ff5c33}Просрочена', date)
				end
					
				if id == 'OFF' then
					dline = string.format('%s{696969}%s\t{696969}%s ранг. %s\t%s\n', dline, name, player_rang[name], rang, status)
				else
					online = online + 1
					dline = string.format('%s{%s}%s[%d]\t%s ранг. %s\t%s\n', dline, sampGetColorByPlayer(id), name, id, player_rang[name], rang, status)
				end
			end
		end
			
		local caption = string.format('{ffffff}Всего пользователей {FFCD00}%d чел. {00CC66}(онлайн %d)', all, online)
		sampShowDialog(1001, caption, dline, 'Закрыть', '', 5)
	end
end

function command_bl(param)
	if string.match(param, '(%d+)') then
		if IPC(param) then
			local name = sampGetPlayerName(param)
			sampSendChat('/history ' .. name)
			pushMessage('Ожидайте...', 3, 4)
			check_bl = true
			black_list = nil
			black_list = {}
		end
	elseif string.match(param, '(%S+)') then
		sampSendChat('/history ' .. param)
		pushMessage('Ожидайте...', 3, 4)
		check_bl = true
		black_list = nil
		black_list = {}
	else
		addChat('Используйте команду /bl [ид или никнейм игрока].')
	end
end

function command_namebl(param)
	if string.match(param, '(%d+)') then
		if IPC(param) then
			pushMessage('Ожидайте...', 3, 4)
		
			local name = sampGetPlayerName(param)
			async_http_request('GET', ini.set.blacklist, nil,
				function(response)
				
				if u8:decode(response.text):find(name) or u8:decode(response.text):find(string.gsub(name, '_', ' ')) then
					addChat(string.format('%s {ff5c33}находится{ffffff} в чёрном списке.', name))
				else
					addChat(string.format('%s {00cc99}не находится{ffffff} в чёрном списке.', name))
				end
				addChat('Не забывайте указывать актуальную ссылку на чёрный список в Расширенные настройки > Дополнительно > Ссылка на ЧС.')
			end)
		else
			addChat('Данный игрок не подключён к серверу. Проверьте правильность введёного ID.')
		end
	elseif string.match(param, '(%S+)') then
		pushMessage('Ожидайте...', 3, 4)
		async_http_request('GET', ini.set.blacklist, nil,
			function(response)
			
			if u8:decode(response.text):find(param) or u8:decode(response.text):find(string.gsub(param, '_', ' ')) then
				addChat(string.format('%s {ff5c33}находится{ffffff} в чёрном списке.', param))
			else
				addChat(string.format('%s {00cc99}не находится{ffffff} в чёрном списке.', param))
			end
			addChat('Не забывайте указывать актуальную ссылку на чёрный список в Расширенные настройки > Дополнительно > Ссылка на ЧС.')
		end)
	else
		addChat('Используйте команду /blname [ид или никнейм игрока].')
	end
end

function CheckPlayersOfBlackList(name, tab)
	if type(tab) == ('table') then
		local blfound = false
	
		async_http_request('GET', ini.set.blacklist, nil,
			function(response) 
			
			for i, val in pairs(tab) do
				if u8:decode(response.text):find(val) or u8:decode(response.text):find(string.gsub(val, '_', ' ')) then
					addChat(string.format('%s {ff5c33}находится{ffffff} в чёрном списке под именем %s.', name, val))
					blfound = true
					break
				end
			end
			
			if not blfound then
				addChat(string.format('%s {00cc99}не находится{ffffff} в чёрном списке.', name))
			end
			addChat('Не забывайте указывать актуальную ссылку на чёрный список в Расширенные настройки > Дополнительно > Ссылка на ЧС.')
		end)
	end
end

function show_flymode()
	local font_t = renderCreateFont('Century Gothic', 14, font_flag.BOLD)
	local type_vision = 0
	
	while true do
		wait(0)
		
		if flymode and ini.set.kvadrocopter then
			local sx, sy = getScreenResolution()
			
			-- эффект затемнения
			if ini.set.skvadrocopter then
				--renderDrawBox(0.0, 0.0, sx, sy, 0x991C1C1C)
			end
			--
			
			-- прицел перекрестие
			renderDrawLine(sx / 2 - 3.0, sy / 2 - 25, sx / 2 - 3.0, sy / 2 - 235, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2, sy / 2 + 25, sx / 2, sy / 2 + 235, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - 25, sy / 2 - 3.0, sx / 2 - 235, sy / 2 - 3.0, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 + 25, sy / 2 - 3.0, sx / 2 + 235, sy / 2 - 3.0, 3.0, 0xFFFFFFFF)
			
			renderDrawLine(sx / 2 - 22.0, sy / 2 - 235, sx / 2 + 20.0, sy / 2 - 235, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - 23.0, sy / 2 + 235, sx / 2 + 20.0, sy / 2 + 235, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - 235, sy / 2 - 23.0, sx / 2 - 235, sy / 2 + 20.0, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 + 235, sy / 2 - 22.0, sx / 2 + 235, sy / 2 + 20.0, 3.0, 0xFFFFFFFF)
			
			renderDrawLine(sx / 2 - 22.0, sy / 2 - (235 / 2), sx / 2 + 20.0, sy / 2 - (235 / 2), 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - 23.0, sy / 2 + (235 / 2), sx / 2 + 20.0, sy / 2 + (235 / 2), 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 - (235 / 2), sy / 2 - 23.0, sx / 2 - (235 / 2), sy / 2 + 20.0, 3.0, 0xFFFFFFFF)
			renderDrawLine(sx / 2 + (235 / 2), sy / 2 - 22.0, sx / 2 + (235 / 2), sy / 2 + 20.0, 3.0, 0xFFFFFFFF)
			--
			
			-- изображение времени
			local t_time = string.format('%s', os.date('%X'))
			local t_date = string.format('%d of %s, %d', os.date('%d'), os.date('%B'), os.date('%Y'))
			
			renderFontDrawText(font_t, t_time, sx / 2 + 410, sy / 2 + 300, 0xFFFFFFFF)
			renderFontDrawText(font_t, t_date, sx / 2 + 410, sy / 2 + 280, 0xFFFFFFFF)
			--
			
			-- изображение текста
			local f_line = string.format('0    A-G    MAN    NARO')
			local s_line = string.format('RAY    FF 30')
			local t_line = string.format('A-LIR    B0RE')
			local p_line = string.format('UNMANNED AERIAL VEHICLE')
			local m_line = string.upper(string.format('%s [%s]', calculateZone(posX, posY, posZ), kvadrat(posX, posY, posZ)))
			
			renderFontDrawText(font_t, f_line, sx - 215, 300, 0xFFFFFFFF)
			renderFontDrawText(font_t, s_line, sx - 115, 330, 0xFFFFFFFF)
			renderFontDrawText(font_t, t_line, sx - 120, 360, 0xFFFFFFFF)
			renderFontDrawText(font_t, p_line, sx / 2 - ((string.len(p_line) / 2) * 10), sy - 30, 0xFFFFFFFF)
			renderFontDrawText(font_t, m_line, sx / 2 - ((string.len(m_line) / 2) * 10), sy - 48, 0xFFFFFFFF)
			--
			
			
			
			-- проверка на отдаление и изображение помех
			local x, y, z = getCharCoordinates(playerPed)
			local distance = getDistanceBetweenCoords3d(x, y, z, posX, posY, posZ)
			
			if distance >= 245 then
				destroy_camhack()
			elseif distance >= 235 then
				renderFontDrawText(font_t, 'LOSS OF CONNECTION. SHUTDOWN.', sx / 2 + 30, sy / 2 + 30, 0xFFFF0000)
			elseif distance >= 200 then
				renderFontDrawText(font_t, 'LOSS OF CONNECTION. RETURN BACK.', sx / 2 + 30, sy / 2 + 30, 0xFFFF0000)
			else
				local text = string.format('%d m from unit', distance)
				renderFontDrawText(font_t, text, sx / 2 + 30, sy / 2 + 30, 0xFFFFFFFF)
			end
			
			--[[for i = 1, distance * 4 do
				local err_col = {0xFF363636, 0xFF4F4F4F, 0xFF696969, 0xFF828282, 0xFF9C9C9C}
				local psx, psy, err = math.random(0, sx), math.random(0, sy), math.random(1, 5)
				renderDrawBox(psx, psy, 3, 3, 0xFFCECECE, err_col[err])
			end]]
			--
			
			if targetSet ~= nil then
				local result, pped = sampGetCharHandleBySampPlayerId(targetSet)
				
				if result then
					local px, py, pz = getCharCoordinates(pped)
					local pdistance = getDistanceBetweenCoords3d(x, y, z, px, py, pz)
					
					local text = string.format('%d m to the target', pdistance)
					renderFontDrawText(font_t, text, sx / 2 + 30, sy / 2 + 48, 0xFFFFFFFF)
				else
					targetSet = nil
				end
			end
			
			if wasKeyPressed(KEY.VK_LBUTTON) then
				targetSet = getnear()
			end
			
			if wasKeyPressed(KEY.VK_RBUTTON) then
				targetSet = nil
			end
			
			if wasKeyPressed(KEY.VK_O) then
				if isKeyCheckAvailable() then
					type_vision = type_vision + 1
					if type_vision > 2 then type_vision = 0 end
				
					if type_vision == 0 then
						setNightVision(false)
						setInfraredVision(false)
					elseif type_vision == 1 then
						setInfraredVision(true)
						setNightVision(false)
					elseif type_vision == 2 then
						setInfraredVision(false)
						setNightVision(true)
					end
				end
			end
			
			-- изображение типа отображения
			if type_vision == 0 then
				color_infra, color_night = 0x88FFFFFF, 0x88FFFFFF
			elseif type_vision == 1 then
				color_infra, color_night = 0xFFFFFFFF, 0x88FFFFFF
			elseif type_vision == 2 then
				color_infra, color_night = 0x88FFFFFF, 0xFFFFFFFF
			end
			
			renderFontDrawText(font_t, 'INFRARED VISION', 60, sy / 2, color_infra)
			renderFontDrawText(font_t, 'NIGHT VISION', 60, sy / 2 + 30, color_night)
			--
 		end
	end
end

function getnear()
    local all_players = getAllChars()
    local lastchar = {}
    local mx, my, mz = poiX, poiY, poiZ

    for k, v in pairs(all_players) do
        if v ~= nil and v ~= 1 then
            local x, y, z = getCharCoordinates(v)
            if lastchar[1] == nil and isCharOnScreen(v) then
                local distance = getDistanceBetweenCoords2d(mx, my, x, y)
                lastchar = {v, distance}
            else
				if isCharOnScreen(v) then
					local distance = getDistanceBetweenCoords2d(mx, my, x, y)
					if tonumber(lastchar[2]) > tonumber(distance) then
						lastchar = {v, distance}
					end
				end
            end
        end
    end

    if lastchar[1] ~= nil then
		local id = select(2, sampGetPlayerIdByCharHandle(lastchar[1]))
		--local nick = sampGetPlayerName(id)
		--addChat(string.format('Ближайший игрок: %s [%s]', nick, lastchar[2]))
		return id
    end
end

function checkBox(name, block, value)
	if imgui.Checkbox(u8(name), imgui.ImBool(ini[block][value])) then 
		ini[block][value] = not ini[block][value]
		inicfg.save(ini, 'Helper for MIA.ini')
		return true
	end
end

function toggleButton(name, block, value)
	if imgui.ToggleButton('##' .. name, imgui.ImBool(ini[block][value])) then
		ini[block][value] = not ini[block][value]
		inicfg.save(ini, 'Helper for MIA.ini')
		return true
	end
	
	imgui.SameLine() imgui.Text(u8(name))
end

local w, h = getScreenResolution()

function imgui.OnDrawFrame()
	if show_notification.v then
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(450, 550))
		imgui.Begin(u8'##notifications', show_notification, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)

			imgui.CenterTextColoredRGB('УВЕДОМЛЕНИЯ')
			imgui.Text('')

			if drawAllNotifications then
				imgui.BeginChild('##allNotifications', imgui.ImVec2(435, 400), true, imgui.WindowFlags.VerticalScrollbar)
					if notificationsTimer[1] ~= nil then
						imgui.Columns(5)
						imgui.Separator()
						imgui.SetColumnWidth(-1, 60) imgui.CenterColumnText(u8'ID') imgui.NextColumn()
						imgui.SetColumnWidth(-1, 60) imgui.CenterColumnText(u8'ON • OFF') imgui.NextColumn()
						imgui.SetColumnWidth(-1, 60) imgui.CenterColumnText(u8'SOUND') imgui.NextColumn()
						imgui.SetColumnWidth(-1, 120) imgui.CenterColumnText(u8'НАЗВАНИЕ') imgui.NextColumn()
						imgui.SetColumnWidth(-1, 140) imgui.CenterColumnText(u8'ВРЕМЯ АКТИВАЦИИ') imgui.NextColumn()
						imgui.Separator()
			
						for id, value in pairs(notificationsTimer) do
							imgui.CenterColumnText(tostring(id)) 
							imgui.NextColumn()

							imgui.SetCursorPosX((imgui.GetColumnOffset() + (imgui.GetColumnWidth() / 2)) - 15)
							if imgui.ToggleButton('##ID' .. id, imgui.ImBool(value.switch)) then
								value.switch = not value.switch
							end imgui.NextColumn()

							imgui.SetCursorPosX((imgui.GetColumnOffset() + (imgui.GetColumnWidth() / 2)) - 15)
							if imgui.ToggleButton('##SOUND' .. id, imgui.ImBool(value.sound)) then
								value.sound = not value.sound
							end imgui.NextColumn()

							imgui.CenterColumnText(u8(value.name)) imgui.NextColumn()

							local time = string.format('%d:%d', value.time.hour, value.time.minute)
							imgui.CenterColumnText(time) imgui.NextColumn()

							imgui.Separator()
						end
					else
						imgui.CenterTextColoredRGB('У вас нет уведомлений o.o')
					end
				imgui.EndChild()
			else
				
				imgui.CenterTextColoredRGB('Введите название уведомления')
				imgui.PushItemWidth(432)
				imgui.InputText(u8'##inputName', notificationsSettings.name)

				if notificationsSound then soundNotification = 'ОТКЛЮЧИТЬ ЗВУКОВОЕ УВЕДОМЛЕНИЕ' else soundNotification = 'ВКЛЮЧИТЬ ЗВУКОВОЕ УВЕДОМЛЕНИЕ' end
				if imgui.Button(u8(soundNotification), imgui.ImVec2(432, 20)) then
					notificationsSound = not notificationsSound
				end

				imgui.Text('')
				imgui.CenterTextColoredRGB('Укажите время, в которое будет активироватся уведомление')

				imgui.PushItemWidth(214)
				imgui.SliderInt('##inputHour', notificationsSettings.hour, 0, 23) ItemPovered('В этом слайдере указывается час активации') 
				imgui.SameLine()
				imgui.SliderInt('##inputMinute', notificationsSettings.minute, 0, 59) ItemPovered('В этом слайдере указывается минута активации')


				imgui.Text('')
				imgui.CenterTextColoredRGB('Введите текст, который будет содержать уведомление')
				imgui.InputTextMultiline('##inputText', notificationsSettings.text, imgui.ImVec2(-1, imgui.GetTextLineHeight() * 6))

				if imgui.Button(u8'СОЗДАТЬ', imgui.ImVec2(214, 20)) then
					if notificationsSettings.name.v ~= '' and notificationsSettings.text.v ~= '' then
						if notificationsSound == nil then
							notificationsSound = false
						end

						notificationsTimer[#notificationsTimer + 1] = {
							switch = true,
							sound = notificationsSound,
							time = {
								hour = notificationsSettings.hour.v,
								minute = notificationsSettings.minute.v
							}, 
							name = u8:decode(notificationsSettings.name.v), 
							text = u8:decode(notificationsSettings.text.v)
						}

						notificationsSettings.name.v = ''
						notificationsSettings.text.v = ''
						notificationsSettings.hour.v = 7
						notificationsSettings.minute.v = 30

						pushMessage('Новое уведомление было успешно создано', 3, 4)
					else
						pushMessage('Чтобы создать уведомление нужно добавить название и текст', 3, 3)
					end
				end imgui.SameLine()

				if imgui.Button(u8'ОЧИСТИТЬ', imgui.ImVec2(214, 20)) then
					notificationsSettings.name.v = ''
					notificationsSettings.text.v = ''
					notificationsSettings.hour.v = 7
					notificationsSettings.minute.v = 30
				end

				imgui.Text('')
				imgui.Text(u8'Если в нужное время вы будете находится в AFK или перед этим')
				imgui.Text(u8'перезайдёте или перезагрузите скрипт, то уведомление не придёт.')
			end

			imgui.SetCursorPosY(520)
			if drawAllNotifications then textNotification = 'ВЕРНУТСЯ' else textNotification = 'ВСЕ УВЕДОМЛЕНИЯ' end
			if imgui.Button(u8(textNotification), imgui.ImVec2(432, 20)) then
				drawAllNotifications = not drawAllNotifications
			end
		imgui.End()
	end

	if show_menu.v then
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(900, 550))
		imgui.Begin(u8'##menu', show_menu, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)

			imgui.BeginChild('##button_block', imgui.ImVec2(250, 520), true, imgui.WindowFlags.VerticalScrollbar)
				imgui.CenterTextColoredRGB('HELPER FOR MIA')
				
				imgui.Text('')
				
				if not drawAllSettings then
					if imgui.Button(u8'Главная страница', imgui.ImVec2(235, 20)) then show_item.v = 8 end
					if imgui.Button(u8'Настройки', imgui.ImVec2(235, 20)) then show_item.v = 0 end
					if imgui.Button(u8'Расширенные настройки', imgui.ImVec2(235, 20)) then drawAllSettings = true end
					if imgui.Button(u8'Дополнительные возможности', imgui.ImVec2(235, 20)) then show_item.v = 4 end
					if imgui.Button(u8'Менеджер паролей', imgui.ImVec2(235, 20)) then show_item.v = 6 end
					if player_status > 0 then 	
						if imgui.Button(u8'Панель лидера', imgui.ImVec2(235, 20)) then show_item.v = 7 end
					end
				else
					if imgui.Button(u8'Получение оружия на складе', imgui.ImVec2(235, 20)) then set_item.v = 0 end
					if imgui.Button(u8'Улучшенные диалоги', imgui.ImVec2(235, 20)) then set_item.v = 3 end
					if imgui.Button(u8'RP-отыгровки оружия', imgui.ImVec2(235, 20)) then set_item.v = 1 end
					if imgui.Button(u8'RP-отыгровки мелких действий', imgui.ImVec2(235, 20)) then set_item.v = 2 end
					if imgui.Button(u8'Изменение состояния команд', imgui.ImVec2(235, 20))  then set_item.v = 8 end
					if imgui.Button(u8'Изменение горячих клавиш', imgui.ImVec2(235, 20)) then set_item.v = 6 end
					if imgui.Button(u8'Кастомизация', imgui.ImVec2(235, 20)) then set_item.v = 5 end
					if imgui.Button(u8'Дополнительно', imgui.ImVec2(235, 20)) then set_item.v = 4 end
					if imgui.Button(u8'Модификации', imgui.ImVec2(235, 20)) then set_item.v = 7 end

					imgui.Text('')

					if imgui.Button(u8'Назад', imgui.ImVec2(235, 20)) then drawAllSettings = false end
				end

				if imgui.Button(u8'Перезагрузить', imgui.ImVec2(235, 20)) then
					show_menu.v = not show_menu.v
					lua_thread.create(function() wait(1000) thisScript():reload() end)
				end
				if imgui.Button(u8'Выключить', imgui.ImVec2(235, 20)) then
					thisScript():unload()
				end
				
				imgui.Text('')
				
				imgui.CenterTextColoredRGB('All rights reserved © 2019')
				
			imgui.EndChild()
			
			imgui.SameLine()
			
			if drawAllSettings then
				imgui.BeginChild('##another_block', imgui.ImVec2(630, 520), true)
					if set_item.v == 0 then
						imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | АВТОМАТИЧЕСКОЕ ПОЛУЧЕНИЕ ОРУЖИЯ')
						imgui.Text('')


						draw_add_autoweapons()
					end

					if set_item.v == 8 then
						imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | ИЗМЕНЕНИЕ СОСТОЯНИЯ ОСНОВНЫХ КОМАНД')
						imgui.Text('')
						draw_settings_allcommands()
					end
					
					if set_item.v == 1 then
						imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | RP-ОТЫГРОВКИ ОРУЖИЯ')
						imgui.Text('')
						draw_settings_rpweapon()
					end
					
					if set_item.v == 2 then
						imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | RP-ОТЫГРОВКИ МЕЛКИХ ДЕЙСТВИЙ')
						imgui.Text('')

						if ini.set.lowrp then
							toggleButton('Отыгровка при использовании аптечки', 'lowrp', 'rphealme')
							toggleButton('Отыгровка при использовании маски', 'lowrp', 'rpmask')
							toggleButton('Отыгровка при открытии спецблока в здание Федерального Бюро', 'lowrp', 'rpfbi')
							toggleButton('Отыгровка при открытии шлагбаума', 'lowrp', 'rpbar')
							toggleButton('Отыгровка при использовании рации', 'lowrp', 'rpradio')
						else
							imgui.CenterTextColoredRGB('Вам недоступен данный подраздел.')
						end
					end
					
					if set_item.v == 3 then
						imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | УЛУЧШЕННЫЕ ДИАЛОГИ')
						imgui.Text('')
						draw_new_dialog()
					end
					
					if set_item.v == 4 then
						imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | ДОПОЛНИТЕЛЬНЫЕ НАСТРОЙКИ')
						imgui.Text('')
						draw_another_settings()
					end
					
					if set_item.v == 5 then
						draw_customization()
					end

					if set_item.v == 6 then
						imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | ИЗМЕНЕНИЕ ГОРЯЧИХ КЛАВИШ')
						imgui.Text('')
						draw_hotkey_settings()
					end
					
					if set_item.v == 7 then
						imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | МОДИФИКАЦИИ')
						imgui.Text('')

						draw_modification()
					end
				imgui.EndChild()
			else
				if show_item.v == 8 then
					imgui.BeginChild('##another_block', imgui.ImVec2(630, 520), true)
						draw_head_page()
					imgui.EndChild()
				end
			
				if show_item.v == 3 then
					imgui.BeginChild('##another_block', imgui.ImVec2(630, 520), true)
						draw_moderators_panel()
					imgui.EndChild()
				end

				if show_item.v == 0 then
					imgui.BeginChild('##another_block', imgui.ImVec2(630, 510), true)
					
						imgui.CenterTextColoredRGB('НАСТРОЙКА ИНФОРМАЦИИ О СОТРУДНИКЕ')
					
						imgui.Text('')
					
						imgui.PushItemWidth(200)
						if imgui.InputText(u8'Имя и фамилия', pname) then
							ini.info.name = u8:decode(pname.v)
							inicfg.save(ini, 'Helper for MIA.ini')
						end
						if imgui.InputText(u8'Должность', prang) then
							ini.info.rang = u8:decode(prang.v)
							inicfg.save(ini, 'Helper for MIA.ini')
						end
						if imgui.InputText(u8'Подразделение', pfrac) then
							ini.info.frac = u8:decode(pfrac.v)
							inicfg.save(ini, 'Helper for MIA.ini')
						end
						if imgui.InputText(u8'Личный номер', pnumber) then
							ini.info.number = u8:decode(pnumber.v)
							inicfg.save(ini, 'Helper for MIA.ini')
						end
						if imgui.InputText(u8'Префикс в основную рацию', rteg) then
							ini.info.rteg = u8:decode(rteg.v)
							inicfg.save(ini, 'Helper for MIA.ini')
						end
						if imgui.InputText(u8'Префикс в общую волну', fteg) then
							ini.info.fteg = u8:decode(fteg.v)
							inicfg.save(ini, 'Helper for MIA.ini')
						end
					
						imgui.Text('')
					
						imgui.Separator()
					
						imgui.Text('')
					
						imgui.CenterTextColoredRGB('ОСНОВНЫЕ БАЗОВЫЕ НАСТРОЙКИ')
					
						imgui.Text('')
					
						toggleButton('Режим женских отыгровок', 'info', 'male') imgui.SameLine(250) toggleButton('Отыгровка камеры', 'set', 'camera')
						toggleButton('Объявления от СМИ', 'set', 'stopad') imgui.SameLine(250) toggleButton('Мелкие отыгровки', 'set', 'lowrp')
						toggleButton('Стробоскопы', 'set', 'strobes') imgui.SameLine(250) toggleButton('Отыгровки оружия', 'set', 'rpweapon')
						toggleButton('Изменённая рация', 'set', 'radio') imgui.SameLine(250) toggleButton('Получение оружия', 'set', 'autoweapon')
						toggleButton('Покупка аптечек и масок', 'set', 'autobuy') imgui.SameLine(250) toggleButton('Проверка документов', 'set', 'autopass')
					
						imgui.SetCursorPosY(487.0)
						if imgui.Button('RETURN TO THE NORMAL ENCODING', imgui.ImVec2(615, 20)) then
							decode()
						end
						ItemPovered('Данная кнопка нужна для того, чтобы восстановить кодировку скрипта. Если же у вас нету иероглифов, то слетит весь текст в скрипте.')
					imgui.EndChild()
				end
				
				if show_item.v == 4 then
					imgui.BeginChild('##another_block', imgui.ImVec2(630, 520), true, imgui.WindowFlags.HorizontalScrollbar)
						draw_another_custom_command()
					imgui.EndChild()
				end
			
				if show_item.v == 6 then
					imgui.BeginChild('##another_block', imgui.ImVec2(630, 520), true)
						imgui.CenterTextColoredRGB('МЕНЕДЖЕР ПАРОЛЕЙ')
					
						imgui.Text('')
					
						if not spypass then
							if imgui.Button(u8'ВКЛЮЧИТЬ ОТОБРАЖЕНИЕ ПАРОЛЕЙ', imgui.ImVec2(305, 20)) then
								spypass = true
							end
						else
							if imgui.Button(u8'СКРЫТЬ ОТОБРАЖЕНИЕ ПАРОЛЕЙ', imgui.ImVec2(305, 20)) then
								spypass = false
							end
						end imgui.SameLine()
						
						if editpass then
							if imgui.Button(u8'НАЗАД', imgui.ImVec2(305, 20)) then
								editpass = false
							end
						else
							if imgui.Button(u8'ДОБАВИТЬ НОВЫЙ АККАУНТ', imgui.ImVec2(305, 20)) then
								editpass = true
							end
						end
						
						imgui.Text('')
					
						if editpass then
							imgui.PushItemWidth(150)
							imgui.InputText('NICKNAME', passname)
							ShowHelpMarker('Введите Nickname аккаунта или выберите текущий.') imgui.SameLine(250)
						
							imgui.PushItemWidth(180)
							imgui.InputText(u8'IP-АДРЕСС', passip)
							ShowHelpMarker('Введите IP-адресс сервера или выберите текущий.')
						
							if imgui.Button(u8'ТЕКУЩИЙ##1', imgui.ImVec2(150, 17)) then
								local result, playerId = sampGetPlayerIdByCharHandle(playerPed)
								if result then
									passname.v = sampGetPlayerName(playerId)
								end
							end imgui.SameLine(250)
						
							if imgui.Button(u8'ТЕКУЩИЙ##2', imgui.ImVec2(180, 17)) then
								passip.v = sampGetCurrentServerAddress()
							end
						
							imgui.Text('')
						
							imgui.PushItemWidth(180)
							imgui.InputText(u8'ПАРОЛЬ', passpass)
							ShowHelpMarker('Введите сюда пароль от аккаунта.')
						
							imgui.InputText(u8'КЛЮЧ GOOGLE AUTHENTIFICATOR', passkey)
							ShowHelpMarker('Введите сюда ключ  Google Authentificator`a.')
						
							if imgui.Button(u8'СОХРАНИТЬ', imgui.ImVec2(615, 20)) then
								if u8:decode(passname.v):match('%S+') and u8:decode(passpass.v):match('%S+') and u8:decode(passip.v):match('%S+') then
									local path = string.format('%s_%s', u8:decode(passname.v), u8:decode(passip.v))
								
									if u8:decode(passkey.v) == '' then gkey = '-1' else gkey = u8:decode(passkey.v) end
									local input = string.format('%s | %s', u8:decode(passpass.v), gkey)
									
									pass.server[path] = input
									inicfg.save(pass, 'password.ini')
									
									pushMessage('Данные о аккаунте были добавлены (обновлены).', 3, 4)
								else
									pushMessage('Заполните все поля ввода. Ключ указывать не обязательно.', 3, 3)
								end
							end
						
							imgui.Text('')
						
							imgui.CenterTextColoredRGB('Ключ Google Authentificator`a получить никак нельзя, вы должны были')
							imgui.CenterTextColoredRGB('записать его во время подключения к аккаунту на сайте.')
							imgui.Text('')
							imgui.CenterTextColoredRGB('Никогда и никому не передавайте пароль или ключ Google Authentificator`a.')
							imgui.CenterTextColoredRGB('Так же не отправляйте файл password.ini, который находится в папке config.')
							imgui.CenterTextColoredRGB('Автор не несёт ответственность за сохранность Ваших личных данных.')
						else
							imgui.Columns(4)
							imgui.Separator()
							imgui.SetColumnWidth(-1, 140) imgui.CenterColumnText(u8'IP') imgui.NextColumn()
							imgui.SetColumnWidth(-1, 150) imgui.CenterColumnText(u8'ИМЯ') imgui.NextColumn()
							imgui.SetColumnWidth(-1, 150) imgui.CenterColumnText(u8'ПАРОЛЬ') imgui.NextColumn()
							imgui.SetColumnWidth(-1, 175) imgui.CenterColumnText(u8'АУТЕНТИФИКАТОР') imgui.NextColumn()
						
						
							for name, val in pairs(pass.server) do
								if name:match('(%S+)_(%S+)') and val:match('(%S+) | (%S+)') then
									imgui.Separator()
									local name, ip = name:match('(.+)_(.+)')
									local pass, auth = val:match('(.+) | (.+)')
								
									if not spypass then
										pass, auth = pass:gsub('.', '*'), auth:gsub('.', '*')
									end
								
									imgui.CenterColumnText(ip) imgui.NextColumn()
									imgui.CenterColumnText(name) imgui.NextColumn()
									imgui.CenterColumnText(pass) imgui.NextColumn()
									imgui.CenterColumnText(auth) 
									if auth ~= '-1' and spypass then
										ItemPovered(gauth.gencode(auth, math.floor(os.time() / 30))) 
									end
									imgui.NextColumn()
								end
							end
							imgui.Separator()
						end
					imgui.EndChild()
				end
				
				if show_item.v == 7 then
					imgui.BeginChild('##another_block', imgui.ImVec2(630, 520), true, imgui.WindowFlags.HorizontalScrollbar)
						imgui.CenterTextColoredRGB('ГОСУДАРСТВЕННЫЕ НОВОСТИ')
					
						imgui.Text('')
					
						imgui.Text(u8'ID-новости ')
					
						imgui.SameLine()
					
						imgui.PushItemWidth(80)
						imgui.InputText('##id_news', idnews)
						ItemPovered('Введите в это окно ID новости, которую хотите найти или создать.')
					
						imgui.SameLine()
					
						if imgui.Button(u8'НАЙТИ', imgui.ImVec2(149, 20)) then
							if string.match(idnews.v, '(%d+)') then
								if doesFileExist(string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)) then
									pushMessage('Новость найдена и открыта для настройки', 3, 4)
							
									for val in io.lines(string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)) do
										if string.match(val, 'type=(%d+)') then
											local ntype = string.match(val, 'type=(%d+)')
											if tonumber(ntype) == 3 then three_or_one_line = true else three_or_one_line = false end
										elseif string.match(val, 'line(%d+)=(.+)') then
											local line, text = string.match(val, 'line(%d+)=(.+)')
											if tonumber(line) <= 3 then
												if tonumber(line) == 1 then govermentNews.lineOne.v = u8(text) end
												if tonumber(line) == 2 then govermentNews.lineTwo.v = u8(text) end
												if tonumber(line) == 3 then govermentNews.lineThree.v = u8(text) end
											elseif tonumber(line) == 4 then
												govermentNews.lineAlone.v = u8(text)
											end
										end
									end
								else
									pushMessage('Новости с данным ID не существует', 3, 3)
								end
							else
								pushMessage('Не указан ID-новости или он некорректен', 3, 3)
							end
						end
						ItemPovered('С помощь этой кнопки вы можете найти уже созданную гос. новость.')
					
						imgui.SameLine()
					
						if imgui.Button(u8'СОЗДАТЬ', imgui.ImVec2(148, 20)) then
							if string.match(idnews.v, '(%d+)') then
								if not doesFileExist(string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)) then
									pushMessage('Новость создана и открыта для настройки', 3, 4)
								
									local file = string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)
									local filew = io.open(file, 'w')
									filew:write('type=1')
									filew:close()
								
									three_or_one_line = false
								end
							else
								pushMessage('Не указан ID-новости или он некорректен', 3, 3)
							end
						end
						ItemPovered('С помощь этой кнопки вы можете создать новую гос. новость.')
					
						imgui.SameLine()
					
						if imgui.Button(u8'СОХРАНИТЬ', imgui.ImVec2(148, 20)) then
							if string.match(idnews.v, '(%d+)') then
								if doesFileExist(string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)) then
									local file = string.format('moonloader//helper//gnews//news-%d.txt', idnews.v)
									local filew = io.open(file, 'w')
									if three_or_one_line then
										filew:write(string.format('type=3\nline1=%s\nline2=%s\nline3=%s', u8:decode(govermentNews.lineOne.v), u8:decode(govermentNews.lineTwo.v), u8:decode(govermentNews.lineThree.v)))
									else
										filew:write(string.format('type=1\nline4=%s', u8:decode(govermentNews.lineAlone.v)))
									end
									filew:close()
								
									pushMessage('Новость успешно сохранена', 3, 4)
								else
									pushMessage('Новости с данным ID не существует', 3, 3)
								end
							else
								pushMessage('Не указан ID-новости или он некорректен', 3, 3)
							end
						end
						ItemPovered('С помощь этой кнопки вы можете сохранить созданую гос. новость.')
					
						if three_or_one_line then
							if imgui.Button(u8'ИЗМЕНИТЬ НА 1 СТРОКУ', imgui.ImVec2(610, 20)) then three_or_one_line = not three_or_one_line end
						else
							if imgui.Button(u8'ИЗМЕНИТЬ НА 3 СТРОКИ', imgui.ImVec2(610, 20)) then three_or_one_line = not three_or_one_line end
						end
						ItemPovered('С помощью этой кнопки вы сможете выбрать сколько строк будет в гос. новости.')
					
						imgui.Text('')
					
						imgui.Separator()
					
						imgui.Text('')
					
						imgui.CenterTextColoredRGB('НАСТРОЙКА СТРОК ГОС. НОВОСТИ')
					
						imgui.Text('')
					
						imgui.PushItemWidth(540)
						if three_or_one_line then
							imgui.InputText(u8'1-я строка ##gnews1', govermentNews.lineOne)
							imgui.InputText(u8'2-я строка ##gnews2', govermentNews.lineTwo)
							imgui.InputText(u8'3-я строка ##gnews3', govermentNews.lineThree)
						else
							imgui.InputText(u8'Строка ##gnews1', govermentNews.lineAlone)
						end
						
						if three_or_one_line then
							if govermentNews.lineOne.v ~= '' or govermentNews.lineTwo.v ~= '' or govermentNews.lineThree.v ~= '' then
								imgui.Text('')
								imgui.Separator()
								imgui.Text('')
								imgui.CenterTextColoredRGB('РЕЗУЛЬТАТ')
								imgui.Text('')

								imgui.TextColoredRGB(string.format('{4466CC}Гос. новости: Ringo[0]: %s', u8:decode(govermentNews.lineOne.v)))
								imgui.TextColoredRGB(string.format('{4466CC}Гос. новости: Ringo[0]: %s', u8:decode(govermentNews.lineTwo.v)))
								imgui.TextColoredRGB(string.format('{4466CC}Гос. новости: Ringo[0]: %s', u8:decode(govermentNews.lineThree.v)))
							end
						else
							if govermentNews.lineAlone.v ~= '' then
								imgui.Text('')
								imgui.Separator()
								imgui.Text('')
								imgui.CenterTextColoredRGB('РЕЗУЛЬТАТ')
								imgui.Text('')

								imgui.TextColoredRGB(string.format('{4466CC}Гос. новости: Ringo[0]: %s', u8:decode(govermentNews.lineAlone.v)))
							end
						end
					imgui.EndChild()
				end
			end
		imgui.End()
		
		if show_help.v then
			local info_function = {'ФУНКЦИИ | ОПИСАНИЕ',
				'{name} | Имя и фамилия, указанная в настройках',
				'{rang} | Должность, указанная в настройках',
				'{frac} | Подразделение, указанное в настройках',
				'{number} | Личный номер, указанный в настройках',
				'{rteg} | Префикс в рацию, указанный в настройках',
				'{fteg} | Префикс в общую волну, указанный в настройках',
				'{mark} | Маркировка юнита (автомобиля или самого игрока)',
				'{hello} | Приветствие',
				'{area} | Район в котором вы находитесь',
				'{square} | Квадрат на карте в котором вы находитесь',
				'{time} | Текущее время',
				'{date} | Текущая дата',
				'{myid} | Ваш ID',
				'{param*число*} | Получить значение параметра. {param1} {param2} и тд',
				'{suspect} | ID игрока, который был предложен для быстрого розыска',
				'{target} | ID игрока, в которого вы целитесь (целились)',

				'getPlayerName_{ID} | Имя игрока по ID. getPlayerName_{param2}',
				'getPlayerFraction_{ID} | Организация игрока по ID. getPlayerFraction_{suspect}',
				'getPlayerColor_{ID} | Цвет клиста игрока по ID. getPlayerColor_{param1}',
				'getPlayerPing_{ID} | Пинг игрока по ID. getPlayerPing_{target}',
				'getPlayerScore_{ID} | Уровень игрока по ID. getPlayerScore_{target}',
				
				'sendChat(text) | Сообщение в обычный чат (с отправкой на сервер)',
				'setChatInput(text) | Ввод в чат без отправки на сервер',
				'addChat(text) | Сообщение в обычный чат (без отправки на сервер)',
				'wait(delay) | Задержка между действиями',
				'setKeyDown(key[, bool]) | Симуляция нажатия клавиши KEY',
			}
			
			imgui.SetNextWindowSize(imgui.ImVec2(550, 430))
			imgui.Begin(u8'ФУНКЦИИ | HELPER FOR MIA', show_help, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
				for i, val in pairs(info_function) do
					local f, i = string.match(val, '(.+) | (.+)')
					if f ~= nil and i ~= nil then
						imgui.Separator()
						if f ~= 'ФУНКЦИИ' then 
							if imgui.Button(u8(f), imgui.ImVec2(170, 20)) then
								setClipboardText(f)
							end
							ItemPovered('Copy value')
						else
							imgui.Text(string.format('%s', u8(f)))
						end
						imgui.SameLine(190)
						imgui.Text(string.format('%s', u8(i)))
					end
				end
			imgui.End()
		end
	end
	
	if show_suspect.v then
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(600, 550))
		
		draw_show_suspect() 
	end
	
	if show_ticket.v then
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(600, 550))
		
		draw_show_ticket()
	end
	
	if show_uk_list.v then
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(600, 550))
		
		draw_uk_list()
	end
	
	if show_ak_list.v then
		imgui.SetNextWindowPos(imgui.ImVec2(w / 2, h / 2), imgui.Cond.FirstUseEver, imgui.ImVec2(0.5, 0.5))
		imgui.SetNextWindowSize(imgui.ImVec2(600, 550))
		
		draw_ak_list()
	end

	if fastMenu.v then
		imgui.OpenPopup('fastMenu')

        if pie.BeginPiePopup('fastMenu', 0) then
			pairsTableForMenu(test_table)
			pie.EndPiePopup()
        end
    end
end

function pairsTableForMenu(table)
	for name, value in pairs(table) do
		if type(value) == ('table') then
			if pie.BeginPieMenu(u8(name)) then
				pairsTableForMenu(value)
				pie.EndPieMenu()
			end
		else
			if pie.PieMenuItem(u8(name)) then
				if type(value) == ('function') then
					value()
				else
					process_command(value)
				end

				fastMenu.v = false
			end
		end
	end
end

test_table = {
	['SUSPECT'] = {
		['CUFF'] = {
			['CUFF'] = function() command_cuff(target_id) end,
			['UNCUFF'] = function() command_uncuff(target_id) end
		},
		['HOLD'] = function() command_hold(target_id) end,
		['PUTPL'] = function() command_putpl(target_id) end,
		['ARREST'] = function() command_arrest(target_id) end,
		['RIGHTS'] = function() command_rights() end
	},
	['LEADERS'] = {
		['INVITE'] = {
			['1 RANG'] = function() command_invite(string.format('%d 1', target_id)) end,
			['2 RANG'] = function() command_invite(string.format('%d 2', target_id)) end,
			['3 RANG'] = function() command_invite(string.format('%d 3', target_id)) end,
			['4 RANG'] = function() command_invite(string.format('%d 4', target_id)) end,
			['5 RANG'] = function() command_invite(string.format('%d 5', target_id)) end,
			['6 RANG'] = function() command_invite(string.format('%d 6', target_id)) end,
			['7 RANG'] = function() command_invite(string.format('%d 7', target_id)) end,
			['8 RANG'] = function() command_invite(string.format('%d 8', target_id)) end,
			['9 RANG'] = function() command_invite(string.format('%d 9', target_id)) end
		},
		['RANG'] = {
			['PLUS'] = function() command_rang(string.format('%d +', target_id)) end,
			['MINUS'] = function() command_rang(string.format('%d -', target_id)) end
		}
	},
	['PLAYERS'] = {
		['PASS'] = function() sampSendChat(string.format('/pass %d', target_id)) end,
		['LICENSES'] = function() sampSendChat(string.format('/lic %d', target_id)) end,
		['SKILL'] = function() sampSendChat(string.format('/skill %d', target_id)) end,
		['WBOOK'] = function() sampSendChat(string.format('/wbook %d', target_id)) end,
		['ALLOW'] = function() sampSendChat(string.format('/allow %d', target_id)) end
	}
}

function draw_new_dialog()
	toggleButton('Улучшенный диалог списка лидеров (/leaders)', 'set', 'new_leaders')
	toggleButton('Улучшенный диалог списка участников группы (/group)', 'set', 'new_group')
	toggleButton('Улучшенный диалог списка сотрудников (/find)', 'set', 'new_find')
	toggleButton('Улучшенный диалог списка преступников (/wanted)', 'set', 'new_wanted')
	toggleButton('Улучшенный диалог отображения точного времени (/c 60)', 'set', 'new_clock')
end

function draw_another_settings()
	imgui.PushItemWidth(200)
	if imgui.SliderInt('##ITEM', pdelay_rk, 0, 30) then
		ini.set.delay_rk = pdelay_rk.v
		inicfg.save(ini, 'Helper for MIA.ini')
	end
	
	imgui.SameLine(220)
	imgui.Text(u8'Задержка, установленная для RK')
	
	if imgui.InputText(u8'Ссылка на чёрный список', url_bl) then
		ini.set.blacklist = url_bl.v
		inicfg.save(ini, 'Helper for MIA.ini') 
	end
	
	toggleButton('Сообщение в рацию при использовании мегафона (погоня / пешая погоня)', 'set', 'message_megafon')
	
	if ini.lowrp.rpmask then
		toggleButton('Сообщение в /do о наличие маски при снятие её системой', 'lowrp', 'unmask')
	end
end

function draw_settings_rpweapon()
	if ini.set.rpweapon then
		if ini.set.halfrpweapon then
			if imgui.Button(u8'ПОЛУАВТОМАТИЧЕСКИЕ ОТЫГРОВКИ ОРУЖИЯ', imgui.ImVec2(350, 20)) then
				ini.set.halfrpweapon = false
				ini.set.autorpweapon = true
				inicfg.save(ini, 'Helper for MIA.ini') 
			end
			ItemPovered('Отыгровка происходит при прицеливании или нажатии специальных клавиш.')
		else
			if imgui.Button(u8'АВТОМАТИЧЕСКИЕ ОТЫГРОВКИ ОРУЖИЯ', imgui.ImVec2(350, 20)) then
				ini.set.halfrpweapon = true
				ini.set.autorpweapon = false
				inicfg.save(ini, 'Helper for MIA.ini')
			end
			ItemPovered('Отыгровка происходит автоматические при взятии или скрытии оружия.')
		end imgui.SameLine()
		
		if imgui.Button(u8'СОХРАНИТЬ', imgui.ImVec2(260, 20)) then
			local wname = weapons.get_name(rpweaponid)
			if wname == '9mm' then wname = 'p9mm' end
			local wname = string.gsub(wname, '-', '_')
			local wname = string.gsub(wname, ' ', '_')
				
			ini.rpweapon[wname]     = u8:decode(takeweap.v)
			ini.rpweaponoff[wname]  = u8:decode(takeweapoff.v)
			inicfg.save(ini, 'Helper for MIA.ini')
									
			pushMessage('Отыгровка успешно сохранена.', 3, 4)
		end
		
		imgui.Text('')
		imgui.TextColoredRGB(string.format('{EEEEFF}Оружие, выбранное для редактирования: {B22222}%s', weapons.get_name(rpweaponid)))
			
		imgui.PushItemWidth(610)
		imgui.Text(u8'Отыгровка при взятии оружия в руки.')
		imgui.InputText('##takeweap', takeweap) 
		imgui.Text(u8'Отыгровка при скрытии оружия.')
		imgui.InputText('##takeweapoff', takeweapoff)
		
		imgui.Text('')

		imgui.BeginChild('##fisrt_block', imgui.ImVec2(165, 290), true)
			imgui.Columns(2)
			imgui.Separator()
			imgui.SetColumnWidth(-1, 125) imgui.CenterColumnText(u8'НАЗВАНИЕ') imgui.NextColumn()
			imgui.SetColumnWidth(-1, 30) imgui.CenterColumnText(u8'ID') imgui.NextColumn()
			
			for i = 1, 46 do
				if weapons.get_name(i) ~= nil then 
					local name_weap = weapons.get_name(i)
					
					imgui.Separator()
					
					if rpweaponid ~= i then
						if imgui.Button(u8(name_weap), imgui.ImVec2(115, 18)) then
							rpweaponid = i
							
							if name_weap == '9mm' then name_weap = 'p9mm' end
							local name_weap = string.gsub(name_weap, '-', '_')
							local name_weap = string.gsub(name_weap, ' ', '_')

							if ini.rpweapon[name_weap] then
								takeweap.v = u8(ini.rpweapon[name_weap])
							end

							if ini.rpweaponoff[name_weap] then
								takeweapoff.v = u8(ini.rpweaponoff[name_weap])
							end
						end 
					else
						imgui.Button(u8'• ' .. name_weap, imgui.ImVec2(115, 18))
					end imgui.NextColumn()
					imgui.CenterColumnText(tostring(i)) imgui.NextColumn()
				end
			end
			
			imgui.Separator()
		imgui.EndChild() imgui.SameLine()
		
		imgui.BeginChild('##second_block', imgui.ImVec2(420, 225), true)
			imgui.Text(u8'Для начала редактирования нужно выбрать оружие из списка левее')
			imgui.Text(u8'и после этого в строках заполнить отыгровки, которые будут')
			imgui.Text(u8'проигроватся, если вы возьмёте оружие в руки или активируйте')
			imgui.Text(u8'клавишей.')
			imgui.Text('')
			imgui.Text(u8'Так же можно переключить режим работы отыгровок на')
			imgui.Text(u8'автоматический или полуавтоматический. С авто-отыгровками всё')
			imgui.Text(u8'понятно, полуавтоматические срабатывают тогда, когда вы')
			imgui.Text(u8'активируйте их клавишей или нацеливайтесь с помощью оружия.')
		imgui.EndChild()
	else
		imgui.CenterTextColoredRGB('Вам недоступен данный подраздел.')
	end
end

local uk_path = {['Неподчинение сотруднику полиции'] = 'insybordination',
	['Отказ от оплаты штрафа'] = 'cancel_ticket',
	['Нападение без оружия'] = 'attack_1',
	['Нападение с применением холодного оружия'] = 'attack_2',
	['Нападение с применением огнестрельного оружия'] = 'attack_3'
	--['Нападение с помощью транспорта'] = 'attack_4'
}

function draw_uk_list()
	imgui.Begin(u8'Уголовный кодекс • Helper for MIA', show_uk_list, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
		for name, val in pairs(smart_suspect.text) do
			local named = u8(val.name)
			if string.len(named) > 135 then
				named = string.sub(named, 0, 135) .. '..'
			end
			
			if imgui.TreeNode(string.format(u8'СТАТЬЯ %d | %s', name, named)) then
				for i, item in ipairs(val.st) do
					if string.match(item, '(.+) | (.+) | (.+)') then
						local stars, reason, text = string.match(item, '(.+) | (.+) | (.+)')
							
						local ttext = u8(text)
						if string.len(ttext) > 120 then
							ttext = string.sub(ttext, 0, 120) .. '..'
						end

						if imgui.Button(string.format('%s | %d | %s', u8(reason), stars, ttext), imgui.ImVec2(540, 20)) then
							uk_static = {stars = stars, name = reason}
							show_uk_edit.v = not show_uk_edit.v
						end
						
						if string.len(u8(text)) > 120 then
							ItemPovered(text)
						end
					else 
						imgui.Text('Unexpected line.')
					end
				end
				imgui.TreePop()
			end
		end
	imgui.End()
	
	if show_uk_edit.v then
		imgui.Begin(u8'Редактор уголовного кодекса • Helper for MIA', show_uk_edit, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
			imgui.CenterTextColoredRGB(string.format('Статья выбранная для редактирования %s, количество звёзд %d.', uk_static.name, uk_static.stars))
			imgui.CenterTextColoredRGB('Выберите нарушение, за которое будет выдан розыск с причиной выше.')
			imgui.Text('')
		
			for name, val in pairs(uk_path) do
				if imgui.Button(u8(name), imgui.ImVec2(450, 20)) then
					addChat(string.format('Значение статьи для "%s" изменено на %s, количество звёзд %d.', name, uk_static.name, uk_static.stars))
					ini.uk_set[val] = string.format('%d | %s', uk_static.stars, uk_static.name)
					inicfg.save(ini, 'Helper for MIA.ini')
				end
			end
		imgui.End()
	end
end

function draw_add_autoweapons()
	if ini.set.autoweapon then
		imgui.BeginChild('##first_block', imgui.ImVec2(300, 350), true)
			imgui.Columns(3)
			imgui.Separator()
			
			imgui.SetColumnWidth(-1, 60) imgui.CenterColumnText(u8'ON • OFF') imgui.NextColumn()
			imgui.SetColumnWidth(-1, 60) imgui.CenterColumnText(u8'x2') imgui.NextColumn()
			imgui.SetColumnWidth(-1, 170) imgui.CenterColumnText(u8'НАЗВАНИЕ') imgui.NextColumn()
			
			for i, val in pairs(InfoWeapon) do
				imgui.Separator()
				imgui.SetCursorPosX((imgui.GetColumnOffset() + (imgui.GetColumnWidth() / 2)) - 15)
				if imgui.ToggleButton('##' .. val[1], imgui.ImBool(ini.weapons[val[3]])) then
					ini.weapons[val[3]] = not ini.weapons[val[3]]
					inicfg.save(ini, 'Helper for MIA.ini')
				end imgui.NextColumn()
				
				if type(ini.weapons[val[4]]) == ('boolean') then
					imgui.SetCursorPosX((imgui.GetColumnOffset() + (imgui.GetColumnWidth() / 2)) - 15)
					if imgui.ToggleButton('##1' .. val[1], imgui.ImBool(ini.weapons[val[4]])) then
						ini.weapons[val[4]] = not ini.weapons[val[4]]
						inicfg.save(ini, 'Helper for MIA.ini')
					end
				else
					imgui.CenterColumnText('~')
				end imgui.NextColumn()
				
				imgui.Text('  ' .. u8(val[1])) imgui.NextColumn()
			end
		imgui.EndChild()
		
		imgui.SameLine()
		
		imgui.BeginChild('##second_block', imgui.ImVec2(310, 350), true)
			imgui.Text(u8'Переключая значение ON - OFF можно включить')
			imgui.Text(u8'авто-получение оружия на складе ПД, ФБР и тд.')
			imgui.Text(u8'Включая множитель можно удваивать количество')
			imgui.Text(u8'боеприпасов взятых на складе.')
			
			imgui.Text('')
			
			imgui.Text(u8'Патроны полученные множителем не являются')
			imgui.Text(u8'валидными, хоть и получены от сервера. Их')
			imgui.Text(u8'пнельзя положить в шкаф, передать...')
			imgui.Text(u8'Не стоит злоупотреблять множителем патрон')
			imgui.Text(u8'это может привести к различным последствиям.')
		imgui.EndChild()
	end
end

function draw_ak_list()
	imgui.Begin(u8'Кодекс о административных правонарушениях', show_ak_list, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
		for name, val in pairs(smart_ticket.text) do
			local named = u8(val.name)
			if string.len(named) > 135 then
				named = string.sub(named, 0, 135) .. '..'
			end
		
			if imgui.TreeNode(string.format(u8'СТАТЬЯ %d | %s', name, named)) then
				for i, item in ipairs(val.st) do
					if string.match(item, '(.+) | (.+) | (.+)') then
						local stars, reason, text = string.match(item, '(.+) | (.+) | (.+)')
							
						local ttext = u8(text)
						if string.len(ttext) > 120 then
							ttext = string.sub(ttext, 0, 120) .. '..'
						end

						imgui.Button(string.format('%s | %d | %s', u8(reason), stars, ttext), imgui.ImVec2(540, 20))
						
						if string.len(u8(text)) > 120 then
							ItemPovered(text)
						end
					else 
						imgui.Text('Unexpected line.')
					end
				end
				imgui.TreePop()
			end
		end
	imgui.End()
end

function draw_show_ticket()
	local id = smart_ticket.id
	if IPC(id) then
		imgui.Begin(string.format(u8'Выдача штрафа %s [%d]', sampGetPlayerName(id), id), show_ticket, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
			for name, val in pairs(smart_ticket.text) do
				local named = u8(val.name)
				if string.len(named) > 135 then
					named = string.sub(named, 0, 135) .. '..'
				end
			
				if imgui.TreeNode(string.format(u8'СТАТЬЯ %d | %s', name, named)) then
					for i, item in ipairs(val.st) do
						if string.match(item, '(.+) | (.+) | (.+)') then
							local stars, reason, text = string.match(item, '(.+) | (.+) | (.+)')
							
							local ttext = u8(text)
							if string.len(ttext) > 120 then
								ttext = string.sub(ttext, 0, 120) .. '..'
							end
							
							if imgui.Button(string.format('%s | %d | %s', u8(reason), stars, ttext), imgui.ImVec2(540, 20)) then
								if stars == '-1' then
									addChat('За данное нарушение не предусмотрено наказание.')
								elseif stars == '-2' then
									command_takelic(string.format('%d %s', id, reason))
								else
									if tonumber(stars) > 2000 then
										addChat('За данное нарушение предусмотрен штраф суммой более {FFCD00}2.000${ffffff}.')
										addChat('При желании вы можете выписать штраф ещё на {00CC66}' .. tonumber(stars) - 2000 .. '${ffffff}.')
									end
									
									command_ticket(string.format('%d %d %s', id, stars, reason))
								end
							end
							
							if string.len(u8(text)) > 120 then
								ItemPovered(text)
							end
						else 
							imgui.Text('Unexpected line.')
						end
					end
					imgui.TreePop()
				else
					if string.len(named) > 135 then
						ItemPovered(val.name)
					end
				end
			end
		imgui.End()
	else
		addChat('Подозревамый пропал из зоны видимости.')
		show_ticket.v = not show_ticket.v
	end
end

function draw_show_suspect()
	local id = smart_suspect.id
	if IPC(id) then
		imgui.Begin(string.format(u8'Объявление в розыск %s [%d]', sampGetPlayerName(id), id), show_suspect, imgui.WindowFlags.NoCollapse + imgui.WindowFlags.NoResize)
			for name, val in pairs(smart_suspect.text) do
				if imgui.TreeNode(string.format(u8'СТАТЬЯ %d | %s', name, u8(val.name))) then
					for i, item in ipairs(val.st) do
						if string.match(item, '(.+) | (.+) | (.+)') then
							local stars, reason, text = string.match(item, '(.+) | (.+) | (.+)')
							
							local ttext = u8(text)
							if string.len(ttext) > 120 then
								ttext = string.sub(ttext, 0, 120) .. '..'
							end
							
							if imgui.Button(string.format('%s | %d | %s', u8(reason), stars, ttext), imgui.ImVec2(540, 20)) then
								command_su(string.format('%d %d %s', id, stars, reason))
							end
							
							if string.len(ttext) > 120 then
								ItemPovered(text)
							end
						else 
							imgui.Text('Unexpected line.')
						end
					end
					imgui.TreePop()
				end
			end
		imgui.End()
	else
		addChat('Подозревамый пропал из зоны видимости.')
		show_suspect.v = not show_suspect.v
	end
end

function draw_modification()
	if imgui.TreeNode(u8'Уличные фонари') then
		toggleButton('Включить отображение уличных фонарей в указанное время', 'set', 'streetlight')

		imgui.PushItemWidth(200)
		if imgui.SliderInt('##ITEM1', pslhour, 0, 23) then
			ini.set.slhour = pslhour.v
			inicfg.save(ini, 'Helper for MIA.ini') 
		end
		imgui.SameLine() imgui.Text(u8'Время включения уличных фонарей')
		
		if imgui.SliderInt('##ITEM2', pmslhour, 0, 23) then
			ini.set.mslhour = pmslhour.v
			inicfg.save(ini, 'Helper for MIA.ini') 
		end
		imgui.SameLine() imgui.Text(u8'Время отключения уличных фонарей')
		
		imgui.TreePop()
	end
	
	if imgui.TreeNode(u8'Модицированный CamHack') then
		toggleButton('Включить отображение эффектов при использовании CamHack`a', 'set', 'kvadrocopter')
		
		imgui.TreePop()
	end
	
	if imgui.TreeNode(u8'ID игроков в чате') then
		toggleButton('Дописывает [ID] около ника игрока, если его там нет', 'set', 'idforname')
		
		imgui.TreePop()
	end

	if imgui.TreeNode(u8'Таймер маски') then
		toggleButton('Отображает время действия маски', 'set', 'masktimer')

		imgui.TreePop()
	end
	
	if imgui.TreeNode(u8'Новый логотип для Advance RP') then
		toggleButton('Включить отображение нового логотипа', 'set', 'new_logo')
		
		if ini.set.new_logo then
			if imgui.Button(u8'Изменить местоположение логотипа') then
				addChat('С помощью мыши установите логотип в нужное место. По завершению нажмите ЛКМ.')
				lua_thread.create(function()
					while show_menu.v do
						wait(0)
						
						ini.set.logo_x, ini.set.logo_y = getCursorPos()
						
						if wasKeyPressed(KEY.VK_LBUTTON) then
							break
						end
					end
					
					addChat('Новое местоположение для логотипа было установлено.')
					inicfg.save(ini, 'Helper for MIA.ini') 
				end)
			end
		end
		
		imgui.TreePop()
	end
end

function draw_hotkey_settings()
	for name in pairs(ini.hkey) do
		if ini.hkey[name] then
			if imgui.HotKey('##' .. name, hotkey_butt[name].key, hotkey_butt[name].last, 100) then
				if not rkeys.isHotKeyDefined(hotkey_butt[name].key.v) then
					rkeys.changeHotKey(hotkey_butt[name].bind, hotkey_butt[name].key.v)
				
					local key = ' '
					for _, val in pairs(hotkey_butt[name].key.v) do
						key = string.format('%s, %s', key, val)
					end
				
					ini.hkey[name] = string.gsub(key, '%s,%s', '')
					inicfg.save(ini, 'Helper for MIA.ini')
					pushMessage('Для этой команды установленно новое сочетание клавиш.', 3, 4)
				else
					hotkey_butt[name].key = hotkey_butt[name].last
					pushMessage('Данное сочетание клавиш уже используется.', 3, 3)
				end
			end
			imgui.SameLine()
			imgui.Text(u8(hotkey_butt[name].name))
		end
	end
end

function draw_head_page()
	imgui.CenterTextColoredRGB('ГЛАВНАЯ СТРАНИЦА')
	
	imgui.Text('')
	
	if not communication_page then head_page_text = 'СВЯЗЬ С РАЗРАБОТЧИКОМ' else head_page_text = 'ВЕРНУТЬСЯ НА ГЛАВНУЮ СТРАНИЦУ' end
	if imgui.Button(u8(head_page_text), imgui.ImVec2(615, 20)) then
		communication_page = not communication_page
	end
	
	
	if not communication_page then
		imgui.Text('')
		
		imgui.BeginChild('##Update_Info', imgui.ImVec2(610, 410), true)
			
			imgui.CenterTextColoredRGB('{FFA54F}ИНФОРМАЦИЯ О ПОСЛЕДНИХ ОБНОВЛЕНИЯХ')
			
			imgui.TextColoredRGB('{ffffff}[v14.6] Добавлен просмотр результата редактирования команд.')
			imgui.TextColoredRGB('{ffffff}[v14.6] Добавлен в тестовом режиме синтаксис ников пользователей в рациях.')

			imgui.TextColoredRGB('{CECECE}[v14.5] Исправление мелких недоработок.')
			imgui.TextColoredRGB('{CECECE}[v14.4] В тестовом режиме добавлены подписки, ограничивающие некоторые возможности.')
			imgui.TextColoredRGB('{CECECE}[v14.4] В тестовом режиме добавлена возможность изменения статуса команд скрита.')
			imgui.TextColoredRGB('{CECECE}[v14.3] Добавлены уведомления, которые можно включить командой /push.')
			imgui.TextColoredRGB('{CECECE}[v14.3] Исправлена система быстрого розыска, теперь она работает корректно.')
			imgui.TextColoredRGB('{CECECE}[v14.2] Обновлена система таймера маски, теперь она корректно работает.')
			imgui.TextColoredRGB('{CECECE}[v14.2] Расширенные настройки собраны в отдельное подменю.')
			imgui.TextColoredRGB('{CECECE}[v14.2] Частично изменён внешний дизайн основных окон.')
			imgui.TextColoredRGB('{CECECE}[v14.1] Изменена система дополнительных возможностей.')
			imgui.TextColoredRGB('{CECECE}[v14.1] Добавлена возможность использовать в доп. возможностях серверные команды.')
			imgui.TextColoredRGB('{CECECE}[v14.1] Добавлены новые переменные для дополнительных возможностей.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Исправлена скорость обновления скорости на спидометре.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Добавлен автоматический подсчёт и покупка аптечек и масок.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Изменена система менеджера паролей.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Добавлен авто-логин с вводом Google Authentificator`a.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Добавлена новая модификация в расширенных настройках.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Добавлена возможность использовать /ticket с выбором пункта КоАП.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Добавлена возможность настройки быстрого розыска в /ук.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Изменён внешний дизайн расширенных настроек.')
			imgui.TextColoredRGB('{CECECE}[до v14.1] Добавлена базовая кастомизация.')
			
		imgui.EndChild()
		
		
		
		--[[imgui.BeginChild('##Another_Info', imgui.ImVec2(610, 270), true)
			
			imgui.CenterTextColoredRGB('{FFA54F}ПОЛЕЗНАЯ ИНФОРМАЦИЯ')
			
			imgui.Text(u8'Полезная информация будет доступна чуть позже.')
			
		imgui.EndChild()]]
	else
		imgui.Text('')
		imgui.TextColoredRGB('Вы можете сообщить о недаработке (баге) или предложить какое-либо улучешние.')
		imgui.TextColoredRGB('Если в скрипте происходит какая-то ошибка и он вылетает, то укажите ошибку..')
		imgui.TextColoredRGB('.. которая появляется в консоли (~ или Ё) и напишите, что использовали перед этим.')
		imgui.TextColoredRGB('Ошибка имеет префикс (error), который подсвечен красным цветом.')
		imgui.TextColoredRGB('Не стоит оффтопить и писать просто так.')
		imgui.Text('')
		imgui.TextColoredRGB('• Discord') imgui.SameLine(80) if imgui.Button('Skezz Perry#2705') then setClipboardText('Skezz Perry#2705') end
		ShowHelpMarker('Copy discord')
		imgui.TextColoredRGB('• VK') imgui.SameLine(80) if imgui.Button('vk.com/skezzhkg') then setClipboardText('vk.com/skezzhkg') end
		ShowHelpMarker('Copy VK')
		imgui.Text('')

		if imgui.Button(u8'Отправить', imgui.ImVec2(615, 20)) then
			local _, id = sampGetPlayerIdByCharHandle(playerPed)
			local name = sampGetPlayerName(id)

			sendModeratorGroup(string.format(u8'-m\n(id %d ~ rang %d) %s ~ %s\n-m', id, player_status, name, inpcomment.v), true)
			inpcomment.v = ''
		end

		imgui.InputTextMultiline('##com_com', inpcomment, imgui.ImVec2(-1, imgui.GetTextLineHeight() * 6))
	end
end

function getStateCommand(name)
	if name_cmd.v ~= nil and name_cmd.v ~= '' then
		local path = string.format('moonloader//helper//commands//%s.txt', name)
		
		if doesFileExist(path) then
			if command_open ~= nil and command_open == path then
				return 'КОМАНДА ОТКРЫТА ДЛЯ РЕДАКТИРОВАНИЯ', 3 -- {32CD32}
			else 
				return 'КОМАНДА НАЙДЕНА И МОЖЕТ БЫТЬ ОТКРЫТА', 2 -- {FFD700}
			end
		else
			return 'КОМАНДА НЕ НАЙДЕНА, ВОЗМОЖНО СОЗДАТЬ НОВУЮ', 1 -- {CD5C5C}
		end
	else
		return 'ОЖИДАНИЕ ВВОДА КОМАНДЫ', false -- {FFD700}
	end
end

function draw_another_custom_command()
	imgui.CenterTextColoredRGB('ДОПОЛНИТЕЛЬНЫЕ ВОЗМОЖНОСТИ')
	
	imgui.Text('')

	imgui.Text(u8' Название команды') 
	imgui.SameLine(147) imgui.Text(u8'Клавиши активации')
	imgui.SameLine(415) imgui.Text(u8'Состояние')

	imgui.PushItemWidth(120)
	if imgui.InputText('', name_cmd) then
		local path = string.format('moonloader//helper//commands//%s.txt', u8:decode(name_cmd.v))
		if command_open ~= path then command_open = '' end
	end ItemPovered('Здесь вы можете ввести название команды, которую хотите открыть или создать.') imgui.SameLine(144)

	draw_new_custom_hotkey() ItemPovered('Здесь вы можете добавить или изменить клавиши, которыми активируется данная команда.') imgui.SameLine(285)

	local name_result, result = getStateCommand(name_cmd.v)

	imgui.Button(u8(name_result), imgui.ImVec2(335, 20)) ItemPovered('Здесь указывается текущее состояние команды. Найдена или не найдена команда, открыта для редактирования она или нет.')

	if result and result < 3 then
		if imgui.Button(u8'ОТКРЫТЬ ИЛИ СОЗДАТЬ', imgui.ImVec2(610, 20)) then
			if name_cmd.v ~= nil and name_cmd.v ~= '' then
				if not sampIsChatCommandDefined(u8:decode(name_cmd.v)) then
					local path = string.format('moonloader//helper//commands//%s.txt', u8:decode(name_cmd.v))
				
					if doesFileExist(path) then
						local cmd_text = ''
						for line in io.lines(path) do
							if string.match(line, '{param = (%d+)}') then
								param_cmd = tonumber(string.match(line, '{param = (%d+)}'))
							else 
								cmd_text = string.format('%s%s\n', cmd_text, u8(line))
							end
						end
						text_cmd.v = cmd_text
						command_open = path
					
						pushMessage('Команда найдена и открыта для настройки', 3, 4)
					elseif not doesFileExist(path) then
						local filew = io.open(path, 'w')
						filew:write('')
						filew:close()
					
						param_cmd = 0
						text_cmd.v = u8'Новая команда'
						command_open = path
					
						pushMessage('Была создана новая команда.', 3, 4)
					end
				else
					pushMessage('Данная команда уже используется скриптом.', 3, 3)
				end
			else
				pushMessage('Не введено название команды.', 3, 3)
			end
		end ItemPovered('С помощью данной клавиши, если команда не найдена, вы сможете создать новую команду, или же открыть уже созданную.')
	elseif result == 3 then
		imgui.Text('')

		if imgui.Button(u8'ДОБАВИТЬ ПАРАМЕТР', imgui.ImVec2(173, 20)) then if param_cmd < 3 then param_cmd = param_cmd + 1 end end
		ItemPovered(string.format('[%d из 3] С помощью данной клавиши вы можете добавить один параметр для вашей команды.', param_cmd))
		imgui.SameLine()
		if imgui.Button(u8'УБРАТЬ ПАРАМЕТР', imgui.ImVec2(172, 20)) then if param_cmd > 0 then param_cmd = param_cmd - 1 end end
		imgui.SameLine()
		ItemPovered(string.format('[%d из 3] С помощью данной клавиши вы можете убрать один параметр для вашей команды.', param_cmd))
		if imgui.Button(u8'ОЧИСТИТЬ', imgui.ImVec2(253, 20)) then
			param_cmd, text_cmd.v, name_cmd.v, command_open = 0, '', '', ''
		end
		ItemPovered('С помощью данной клавиши вы можете очистить название команды, количество параметров и поле редактора команды.')

		if imgui.Button(u8'СОХРАНИТЬ КОМАНДУ', imgui.ImVec2(173, 20)) then
			if name_cmd.v ~= nil and name_cmd.v ~= '' then
				if not sampIsChatCommandDefined(u8:decode(name_cmd.v)) then
					local path = string.format('moonloader//helper//commands//%s.txt', u8:decode(name_cmd.v))
				
					if doesFileExist(path) and command_open == path then
						local filew = io.open(path, 'w')
						local save_text = string.format('{param = %d}\n%s', param_cmd, text_cmd.v)
						filew:write(u8:decode(save_text))
						filew:close()
					
						pushMessage('Команда успешно сохранена.', 3, 4)
					else
						pushMessage('Для начала нужно найти или создать команду.', 3, 3)
					end
				else
					pushMessage('Данная команда уже используется скриптом.', 3, 3)
				end	
			else
				pushMessage('Не введено название команды.', 3, 3)
			end
		end ItemPovered('С помощью данной клавиши вы можете сохранить изменения в команде.')

		imgui.SameLine()

		if imgui.Button(u8'УДАЛИТЬ КОМАНДУ', imgui.ImVec2(172, 20)) then
			if name_cmd.v ~= nil and name_cmd.v ~= '' then
				if not sampIsChatCommandDefined(u8:decode(name_cmd.v)) then
					local path = string.format('moonloader//helper//commands//%s.txt', u8:decode(name_cmd.v))
				
					if doesFileExist(path) and command_open == path then
						os.remove(path)
					else
						pushMessage('Для начала нужно найти или создать команду.', 3, 3)	
					end
				else
					pushMessage('Невозможно удалить данную команду.', 3, 3)
				end
			else
				pushMessage('Не введено название команды.', 3, 3)
			end
		end ItemPovered('С помощью данной клавиши вы можете удалить команду.')

		imgui.SameLine()
		if imgui.Button(u8'ПЕРЕМЕННЫЕ И ФУНКЦИИ', imgui.ImVec2(253, 20)) then
			show_help.v = not show_help.v
		end ItemPovered('С помощью данной клавиши вы можете открыть список доступных переменных и функций.')

		imgui.Text('')
		if not edit_command_text then command_name_text = 'РЕДАКТИРОВАНИЕ' else command_name_text = 'РЕЗУЛЬТАТ' end
		if imgui.Button(u8(command_name_text), imgui.ImVec2(610, 20)) then
			edit_command_text = not edit_command_text
		end
	
		if not edit_command_text then
			imgui.PushItemWidth(510)
			imgui.InputTextMultiline('##TextForCmd', text_cmd, imgui.ImVec2(-1, imgui.GetTextLineHeight() * 22))
		else
			imgui.BeginChild('##blook', imgui.ImVec2(610, 320), true, imgui.WindowFlags.VerticalScrollbar)
				if lastText == text_cmd.v then
					for line in string.gmatch(newText, '[^\n]+') do
						imgui.TextColoredRGB('{ffffff}' .. line)
					end

					--imgui.Text(newText)
				else
					lastText = text_cmd.v
					newText = u8:decode(lastText)

					newText = showMyResult(newText)
				end
			imgui.EndChild()
		end
	else
		imgui.Text('')
		imgui.CenterTextColoredRGB('Для начала редактирования откройте любую команду.')
	end
end

function draw_settings_allcommands()
	imgui.BeginChild('##blook', imgui.ImVec2(210, 470), true, imgui.WindowFlags.VerticalScrollbar)
		imgui.Columns(2)
		imgui.Separator()
	
		imgui.SetColumnWidth(-1, 60) imgui.CenterColumnText(u8'ON • OFF') imgui.NextColumn()
		imgui.SetColumnWidth(-1, 150) imgui.CenterColumnText(u8'НАЗВАНИЕ КОМАНДЫ') imgui.NextColumn()
	
		for name, commands in pairs(scriptCommands.default) do
			imgui.Separator()

			imgui.SetCursorPosX((imgui.GetColumnOffset() + (imgui.GetColumnWidth() / 2)) - 15)
			if imgui.ToggleButton('##' .. name, imgui.ImBool(commands[1])) then
				if commands[1] then
					scriptCommands.default[name][1] = false
					sampUnregisterChatCommand(name)
				else
					scriptCommands.default[name][1] = true
					sampRegisterChatCommand(name, _G[commands[2]])
				end
			end imgui.NextColumn()

			imgui.CenterColumnText(u8(name)) imgui.NextColumn()
		end
	imgui.EndChild()
end

function draw_new_custom_hotkey()
	if name_cmd.v ~= nil and name_cmd.v ~= '' then
		local path = string.format('moonloader//helper//commands//%s.txt', u8:decode(name_cmd.v))

		if ini.custom_hkey[u8:decode(name_cmd.v)] ~= nil then
			for id, val in pairs(hotkey_cust_butt) do
				if u8:decode(name_cmd.v) == val.name then
					if val.key.v ~= nil then
						if imgui.HotKey('##' .. val.name, hotkey_cust_butt[id].key, hotkey_cust_butt[id].last, 124) then
							if not rkeys.isHotKeyDefined(hotkey_cust_butt[id].key.v) then
								rkeys.changeHotKey(hotkey_cust_butt[id].bind, hotkey_cust_butt[id].key.v)
			
								local key = ' '
								for _, val in pairs(hotkey_cust_butt[id].key.v) do
									key = string.format('%s, %s', key, val)
								end
								
								ini.custom_hkey[val.name] = string.gsub(key, '%s,%s', '')
								inicfg.save(ini, 'Helper for MIA.ini')
								pushMessage('Для этой команды установленно новое сочетание клавиш.', 3, 4)
							else
								hotkey_cust_butt[id].key = hotkey_cust_butt[id].last
								pushMessage('Данное сочетание клавиш уже используется.', 3, 3)
							end
						end
					else
						imgui.TextColoredRGB('{CD5C5C}команда не имеет клавиш активации')
					end
				end
			end
		elseif doesFileExist(path) then
			if imgui.Button(u8'ДОБАВИТЬ', imgui.ImVec2(124, 20)) then
				if not name_cmd.v:find('йцукенгшщзхъфывапролджэячсмитьбюЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ') then
					ini.custom_hkey[name_cmd.v] = -1
					table.insert(hotkey_cust_butt, {key = {v = {-1}}, last = {}, bind = -1, name = name_cmd.v})
					
					hotkey_cust_butt[#hotkey_cust_butt].bind = rkeys.registerHotKey(hotkey_cust_butt[#hotkey_cust_butt].key.v, true, function()
						if isKeyCheckAvailable() then
							process_command(hotkey_cust_butt[#hotkey_cust_butt].name)
						end
					end)
					
					inicfg.save(ini, 'Helper for MIA.ini')
				else
					pushMessage('Команда не должна быть на русском языке.', 3, 3)
				end
			end
		else
			imgui.Button(u8'НЕДОСТУПНО', imgui.ImVec2(124, 20))
		end
	else
		imgui.Button(u8'НЕДОСТУПНО', imgui.ImVec2(124, 20))
	end
end

local color = imgui.ImFloat4(imgui.ImColor(ini.custom['TitleBgActive']):GetFloat4())
local color_low_custom = imgui.ImFloat3(color.v[1], color.v[2], color.v[3])

function draw_customization()
	imgui.CenterTextColoredRGB('РАСШИРЕННЫЕ НАСТРОЙКИ | КАСТОМИЗАЦИЯ')
	imgui.Text('')
	
	if imgui.Button(u8'СОХРАНИТЬ И ПРИМЕНИТЬ НОВЫЕ ЗНАЧЕНИЯ', imgui.ImVec2(615, 20)) then
		inicfg.save(ini, 'Helper for MIA.ini')
		apply_custom_style()
	end
	
	if custom_style then name_of_custom = 'РАСШИРЕННАЯ КАСТОМИЗАЦИЯ' else name_of_custom = 'БАЗОВАЯ КАСТОМИЗАЦИЯ' end
	if imgui.Button(u8(name_of_custom), imgui.ImVec2(615, 20)) then
		custom_style = not custom_style
	end
	
	imgui.Text('')

	if custom_style then
		for obj in pairs(ini.custom) do
			local color = imgui.ImFloat4(imgui.ImColor(ini.custom[obj]):GetFloat4())
			
			if imgui.ColorEdit4(obj, color) then
				local colors = imgui.ImColor.FromFloat4(color.v[1], color.v[2], color.v[3], color.v[4]):GetU32()
				ini.custom[obj] = colors
			end
			
			if descript_f[obj] ~= nil then
				ShowHelpMarker(descript_f[obj])
			else
				ShowHelpMarker('Пояснение не было добавлено.')
			end
		end
	else
		imgui.Text(u8'Изменяя основной цвет, каждый элемент imgui-окон и цвет префикса сообщений')
		imgui.Text(u8'подстроится под него и станет идентичным, не считая прозрачности, которая будет')
		imgui.Text(u8'у всех элементов разная. Если вам нужно изменить цвет какого-то конкретного')
		imgui.Text(u8'элемента, то воспользуйтесь расширенной кастомизацией.')
		imgui.Text('')
		if imgui.ColorEdit3('##ЕТО_ШЕДЕВР', color_low_custom) then
			local color = color_low_custom 
			local color_tab = {['TitleBgActive'] = 255, ['CloseButton'] = 255, ['SliderGrabActive'] = 255, ['ScrollbarGrab'] = 90, ['ResizeGrip'] = 90, ['ScrollbarGrabActive'] = 255, ['ButtonHovered'] = 155, ['FrameBg'] = 90, ['ScrollbarBg'] = 90, ['FrameBgHovered'] = 155, ['ButtonActive'] = 255, ['FrameBgActive'] = 255, ['SliderGrab'] = 90, ['ResizeGripHovered'] = 90, ['Button'] = 90}
			
			for obj, val in pairs(color_tab) do
				local colors = imgui.ImColor.FromFloat4(color.v[1], color.v[2], color.v[3], val / 255):GetU32()
				ini.custom[obj] = colors
			end
			
			local rgb = {color.v[1] * 255, color.v[2] * 255, color.v[3] * 255}
			ini.set.color_line = '0xFF' .. colorRgbToHex(rgb)
		end
		imgui.SameLine() imgui.Text(u8'Основной цвет')
	end
end

function register_custom_hotkey() 
	for name, val in pairs(ini.hkey) do
		if val then
			for key in string.gmatch(val, '[^,%s]+') do
				table.insert(hotkey_butt[name].key.v, tonumber(key))
			end
		end
	end
	
	local i_n = 0
	for name, val in pairs(ini.custom_hkey) do
		table.insert(hotkey_cust_butt, i_n, {key = {v = {}}, last = {}, bind = -1, name = name})
		for key in string.gmatch(val, '[^,%s]+') do
			table.insert(hotkey_cust_butt[i_n].key.v, tonumber(key))
		end
		
		i_n = i_n + 1
	end
end

function add_new_hotkey()
	for name, val in pairs(hotkey_cust_butt) do
		hotkey_cust_butt[name].bind = rkeys.registerHotKey(hotkey_cust_butt[name].key.v, true, function()
			if isKeyCheckAvailable() then
				process_command(hotkey_cust_butt[name].name)
			end
		end)
	end

	hotkey_butt['eat'].bind = rkeys.registerHotKey(hotkey_butt['eat'].key.v, true, function()
		if isKeyCheckAvailable() then
			sampSendChat('/eat')
		end
	end)
	
	hotkey_butt['menu'].bind = rkeys.registerHotKey(hotkey_butt['menu'].key.v, true, function()
		show_menu.v = not show_menu.v 
	end)
	
	hotkey_butt['open'].bind = rkeys.registerHotKey(hotkey_butt['open'].key.v, true, function()
		if isKeyCheckAvailable() then
			command_upopen()
		end
	end)
	
	hotkey_butt['smart_su'].bind = rkeys.registerHotKey(hotkey_butt['smart_su'].key.v, true, function()
		if suspect_id[1] ~= nil then
			if IPC(suspect_id[1]) then
				command_su(string.format('%d %d %s', suspect_id[1], suspect_id[2], suspect_id[3])) 
			end
		end
	end)
		
	hotkey_butt['lock'].bind = rkeys.registerHotKey(hotkey_butt['lock'].key.v, true, function()
		if isKeyCheckAvailable() then
			sampSendChat('/lock 1')
		end
	end)
	
	hotkey_butt['camera'].bind = rkeys.registerHotKey(hotkey_butt['camera'].key.v, true, function()
		if ini.set.camera then
			cameraActive = not cameraActive
			sampSendChat('/do На плечевой стропе установлена камера видеофиксации, камера активна.') 
		end
	end)
	
	hotkey_butt['fast_menu'].bind = rkeys.registerHotKey(hotkey_butt['fast_menu'].key.v, true, function()
		if isKeyCheckAvailable() then
			local result, ped = getCharPlayerIsTargeting(playerHandle)
			if result then
				_, targetid = sampGetPlayerIdByCharHandle(ped)
				fastMenu.v = not fastMenu.v
			elseif fastMenu.v then
				fastMenu.v = false
			else
				targetid = nil
				fastMenu.v = not fastMenu.v
			end
		end
	end)
	
	hotkey_butt['onfoot_m'].bind = rkeys.registerHotKey(hotkey_butt['onfoot_m'].key.v, true, function()
		if ini.set.message_megafon then
			command_r(string.format('$m to DISP 10-57 F, 10-20 %s (%s), CODE: 3, nRFR, over **', calculateZone(), kvadrat()))
		else
			addChat('Для работы данной функции включите её в расширенных настройках.')
		end
	end)
	
	hotkey_butt['onvec_m'].bind = rkeys.registerHotKey(hotkey_butt['onvec_m'].key.v, true, function()
		lua_thread.create(function()
			local pid, id = sampGetNearestDriver()
			if id ~= -1 then
				local z, k = calculateZone(), kvadrat()
					
				sampSendChat('/m Внимание! Водитель ' .. tCarsName[id - 399] .. ' с номером ' .. pid .. '!')
				wait(1500)
				sampSendChat('/m Немедленно остановите транспортное средство и прижмитесь к обочине!')
					
				if last_message.name == sampGetPlayerName(pid) then
					wait(1000)
					sampSendChat('/m В случае неподчинения будет открыт огонь на поражение!')
					if ini.set.message_megafon then
						wait(1000)
						command_r(string.format('$m to DISP, 10-57 V за %s с номером %d, 10-20 %s (%s), CODE: 3, nRFR, over **', tCarsName[id - 399], pid, z, k))
					end
					
					local stars, reason = tonumber(ini.uk_set.insubordination:match('(%d+)[%s]|.+')), ini.uk_set.insubordination:match('[%d+][%s]|[%s](.+)')
					
					addChat(string.format('Чтобы объявить %s[%d] в розыск по статье %s нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerName(pid), pid, reason))
					suspect_id = {pid, stars, reason, sampGetPlayerName(pid), -1}
					
				end
				
				last_message = {id = pid, name = sampGetPlayerName(pid)}
			else
				sampSendChat('/m Немедленно остановите транспортное средство и прижмитесь к обочине!')
			end
		end)
	end)
	
	hotkey_butt['camhack_off'].bind = rkeys.registerHotKey(hotkey_butt['camhack_off'].key.v, true, function()
		if isKeyCheckAvailable() then
			destroy_camhack()
		end
	end)
	
	hotkey_butt['camhack_on'].bind = rkeys.registerHotKey(hotkey_butt['camhack_on'].key.v, true, function()
		if isKeyCheckAvailable() then
			on_camhack()
		end
	end)
end

function on_camhack()
	if not flymode and isKeyCheckAvailable() then     
		posX, posY, posZ = getCharCoordinates(playerPed)
		angZ = getCharHeading(playerPed)
		angZ = angZ * -1.0
		setFixedCameraPosition(posX, posY, posZ, 0.0, 0.0, 0.0)
		angY = 0.0 
		lockPlayerControl(true)
		flymode = not flymode
		type_vision = 0
		color_infra, color_night = 0x88FFFFFF, 0x88FFFFFF
	end
end

function destroy_camhack()
	if flymode then
		radarHud = 0    
		angPlZ = angZ * -1.0
		lockPlayerControl(false)
		restoreCameraJumpcut()
		setCameraBehindPlayer()
		flymode = false
		setInfraredVision(false)
		setNightVision(false)
		type_vision = 0
		color_infra, color_night = 0x88FFFFFF, 0x88FFFFFF
	end
end

function patch_samp_time_set(enable)
	if enable and default == nil then
		default = readMemory(sampGetBase() + 0x9C0A0, 4, true)
		writeMemory(sampGetBase() + 0x9C0A0, 4, 0x000008C2, true)
	elseif enable == false and default ~= nil then
		writeMemory(sampGetBase() + 0x9C0A0, 4, default, true)
		default = nil
	end
end


function isPlayerCar(ped)
	if isCharInAnyCar(ped) then
		local carid = getCarModel(storeCarCharIsInNoSave(ped))
		return carid
	else
		return 0
	end
end

function sampGetPlayerIdByTarget()
	local result, ped = getCharPlayerIsTargeting(playerHandle)

	if result then
		local iresult, id = sampGetPlayerIdByCharHandle(ped)
		if iresult then return id end
	end

	return false
end

function imgui.CenterColumnText(text)
    imgui.SetCursorPosX((imgui.GetColumnOffset() + (imgui.GetColumnWidth() / 2)) - imgui.CalcTextSize(text).x / 2)
    imgui.Text(text)
end

function sampGetMarkCharByVehicle(ped)
	local _, id = sampGetPlayerIdByCharHandle(ped)
	local uid = 1
	if id < 50 then 
		uid = id 
	else
		uid = string.sub(tostring(id), 0, 2)
		if tonumber(uid) > 50 then
			uid = tonumber(uid) - 50
		end
	end

	if isCharSittingInAnyCar(ped) then
		if isCharInAnyCar(ped) or isCharOnAnyBike(ped) then
			local vehicle = storeCarCharIsInNoSave(ped)
			
			if doesVehicleExist(vehicle) then
				local model = getCarModel(vehicle)
				
				if model >= 596 and model <= 599 then
					local maxp = getMaximumNumberOfPassengers(vehicle)
					local res, int = getNumberOfPassengers(vehicle)

					--[[if res and int > 0 then
						for i = 1, maxp do
							if not isCarPassengerSeatFree(vehicle, i) then
								local ped = getCharInCarPassengerSeat(vehicle, i)
								if doesCharExist(ped) then
									if sampIsPoliceOfficerById(ped) then
										return string.format('A-%s', uid)
									end
								end
							end
						end
					end]]
					
					return string.format('L-%d', uid) 
				elseif model == 601 or model == 427 or model == 528 then
					return string.format('C-%d', uid) 
				elseif model == 415 then
					return string.format('H-%d', uid) 
				elseif model == 523 then
					return string.format('M-%d', uid)
				end
			end
		end
	end
	
	return string.format('Unit-%d', id)
end

function sampIsPoliceOfficerById(ped)
	local res, id = sampGetPlayerIdByCharHandle(ped)
	if res then
		if IPC(id) then
			if sampGetPlayerColor(id) == 4278190335 then
				return true
			elseif sampGetPlayerColor(id) == 2236962 then
				local model = getCharModel(ped)
				
				if model >= 280 and model <= 286 then 
					return true 
				elseif model == 288 then 
					return true
				elseif model >= 265 and model <= 267  then 
					return true
				elseif model >= 300 and model <= 311 and model ~= 308 then 
					return true
				end
			end
		end
	end
	
	return false
end

function sampGetNearestDriver()
	local driver = {playerId = -1, vehicleId = -1}
	local maxDistance = 55

	if isCharSittingInAnyCar(playerPed) then
		local vehiclePed = storeCarCharIsInNoSave(playerPed)

		for _, ped in pairs(getAllChars()) do
			if doesCharExist(ped) then
				if isCharOnScreen(ped) then
					if isCharSittingInAnyCar(ped) and not isCharInAnyPoliceVehicle(ped) then
						local vehicle = storeCarCharIsInNoSave(ped)
						local driverVehicle = getDriverOfCar(vehicle)

						if driverVehicle == ped then
							local _, id = sampGetPlayerIdByCharHandle(ped)
							local distance = sampGetDistanceToPlayer(id)

							if distance < maxDistance then
								if vehicle ~= vehiclePed then
									local vehicleId = getCarModel(vehicle)

									maxDistance = distance
									driver = {playerId = playerId, vehicleId = vehicleId}
								end
							end
						end
					end
				end
			end
		end
	end

	return driver.playerId, driver.vehicleId
end

function sampIsPlayerCarHaveSuspect(id)
	if IPC(id) then
		local result, ped = sampGetCharHandleBySampPlayerId(id)

		if result then
			if isCharSittingInAnyCar(ped) and isCharSittingInAnyCar(playerPed) then
				local vehicle = storeCarCharIsInNoSave(ped)
				local mvehicle = storeCarCharIsInNoSave(playerPed)

				if vehicle == mvehicle then
					return true
				end
			end
		end
	end

	return false
end

function sampIsPlayerCar(id)
	if IPC(id) then
		local res, ped = sampGetCharHandleBySampPlayerId(id)

		if res then
			if isCharSittingInAnyCar(ped) then
				local vehicle = storeCarCharIsInNoSave(ped)
				local vid = getCarModel(vehicle)

				return true, vid
			end
		end
	end

	return false, -1
end

function sampGetHelloByTime()
	local hour = tonumber(os.date('%H'))

	if hour > 3 and hour <= 12 then	      return 'Доброе утро'
	elseif hour > 12 and hour <= 18 then  return 'Добрый день'
	elseif hour > 18 and hour <= 22 then  return 'Добрый вечер'
	elseif hour > 22 and hour <= 3 then   return 'Доброй ночи'
	else
		return 'Здравствуйте'
	end
end

function sampGetDistanceToPlayer(id)
	local result, playerId = sampGetPlayerIdByCharHandle(playerPed)

	if result and playerId == id then 
		return 1
	end

	if IPC(id) then
		local _result, ped = sampGetCharHandleBySampPlayerId(id)

		if _result then
			local x, y, z = getCharCoordinates(playerPed)
			local _x, _y, _z = getCharCoordinates(ped)

			return getDistanceBetweenCoords3d(x, y, z, _x, _y, _z)
		end
	end

	return 4500
end

function getTimeLast(time)
	local lget = {}

	lget[2] = 60 + (time[3] - os.date('%S'))
	lget[1] = time[2] - os.date('%M') - 1

	return lget
end

function sampGetPassedTimeByPeriod(hour, minute, secund, period)
	local time = getTimeByPeriod(hour, minute, secund, period)
	
	if tonumber(os.date('%H')) > (time[1] + 1) then
		return true
	elseif tonumber(os.date('%H')) == (time[1] + 1) then
		if tonumber(os.date('%M')) == (60 - time[2]) and tonumber(os.date('%S')) >= time[3] then
			return true
		elseif tonumber(os.date('%M')) > (60 - time[2]) then
			return true
		else
			return false
		end
	elseif tonumber(os.date('%M')) == time[2] and tonumber(os.date('%S')) >= time[3] then
		return true
	elseif tonumber(os.date('%M')) > time[2] then
		return true
	else
		return false
	end
end

function getTimeByPeriod(hour, minute, secund, period)
	if period < 60 then
		local get = {}
		if minute + period >= 60 then
			hour = hour + 1
			if hour > 23 then hour = 00 end
			minute = period - (60 - minute)
		else
			minute = minute + period
		end
		get[1] = hour
		get[2] = minute
		get[3] = secund
		return get
	end
end

function IPC(id)
	local result, playerId = sampGetPlayerIdByCharHandle(playerPed)

	if result then
		return sampIsPlayerConnected(id) or tonumber(id) == tonumber(playerId)
	end

	return false
end

function sampGetPlayerFractionByid(id)
	local color = {
		[4278190335] = 'МВД',
		[4291624704] = 'Правительство',
		[4294927872] = 'ТВ-Радио',
		[301989887] = 'Гражданские',
		[4278220149] ='Russian Mafia',
		[4288230246] = 'La Cosa Nostra',
		[4278229248] = 'Grove Street',
		[4291559679] = 'The Ballas',
		[4284901119] = 'The Rifa',
		[4294927974] = 'Мин. здравоохранения',
		[4288243251] = 'Мин. обороны',
		[4290445312] = 'Yakuza',
		[4278242559] = 'Varios Los Aztecas',
		[4294954240] = 'Los Santos Vagos'
	}

	return color[sampGetPlayerColor(id)] or 'Неизвестно'
end

function sampGetOnlineInFraction()
	local online = {mvd = {all = 0, player = {}},
		prav = {all = 0, player = {}},
		mm = {all = 0, player = {}},
		mz = {all = 0, player = {}},
		mo = {all = 0, player = {}},
		civ = {all = 0, player = {}},
		rm = {all = 0, player = {}},
		lcn = {all = 0, player = {}},
		yak = {all = 0, player = {}},
		grv = {all = 0, player = {}},
		bal = {all = 0, player = {}},
		rif = {all = 0, player = {}},
		vag = {all = 0, player = {}},
		azt = {all = 0, player = {}},
		mask = {all = 0, player = {}},
		all = {all = 0, player = {}}
	}
	for id = 0, 1000 do 
		if IPC(id) then
			if sampGetPlayerColor(id) == 4278190335 		then online.mvd.all = online.mvd.all + 1; online.mvd.player[online.mvd.all] = id
			elseif sampGetPlayerColor(id) == 4291624704 	then online.prav.all = online.prav.all + 1; online.prav.player[online.prav.all] = id
			elseif sampGetPlayerColor(id) == 4294927872		then online.mm.all = online.mm.all + 1; online.mm.player[online.mm.all] = id
			elseif sampGetPlayerColor(id) == 301989887 		then online.civ.all = online.civ.all + 1; online.civ.player[online.civ.all] = id
			elseif sampGetPlayerColor(id) == 4278220149 	then online.rm.all = online.rm.all + 1; online.rm.player[online.rm.all] = id
			elseif sampGetPlayerColor(id) == 4288230246 	then online.lcn.all = online.lcn.all + 1; online.lcn.player[online.lcn.all] = id
			elseif sampGetPlayerColor(id) == 4278229248 	then online.grv.all = online.grv.all + 1; online.grv.player[online.grv.all] = id
			elseif sampGetPlayerColor(id) == 4291559679 	then online.bal.all = online.bal.all + 1; online.bal.player[online.bal.all] = id
			elseif sampGetPlayerColor(id) == 4284901119 	then online.rif.all = online.rif.all + 1; online.rif.player[online.rif.all] = id
			elseif sampGetPlayerColor(id) == 4294927974 	then online.mz.all = online.mz.all + 1; online.mz.player[online.mz.all] = id
			elseif sampGetPlayerColor(id) == 4288243251 	then online.mo.all = online.mo.all + 1; online.mo.player[online.mo.all] = id
			elseif sampGetPlayerColor(id) == 4290445312 	then online.yak.all = online.yak.all + 1; online.yak.player[online.yak.all] = id
			elseif sampGetPlayerColor(id) == 4278242559 	then online.azt.all = online.azt.all + 1; online.azt.player[online.azt.all] = id
			elseif sampGetPlayerColor(id) == 4294954240 	then online.vag.all = online.vag.all + 1; online.vag.player[online.vag.all] = id
			elseif sampGetPlayerColor(id) == 2236962        then online.mask.all = online.mask.all + 1; online.mask.player[online.mask.all] = id
			else online.all.all = online.all.all + 1; online.all.player[online.all.all] = id
			end
		end
	end
	return online
end

function kvadrat(X, Y, Z)
    local KV = {
        [1] = "А",
        [2] = "Б",
        [3] = "В",
        [4] = "Г",
        [5] = "Д",
        [6] = "Ж",
        [7] = "З",
        [8] = "И",
        [9] = "К",
        [10] = "Л",
        [11] = "М",
        [12] = "Н",
        [13] = "О",
        [14] = "П",
        [15] = "Р",
        [16] = "С",
        [17] = "Т",
        [18] = "У",
        [19] = "Ф", 
        [20] = "Х",
        [21] = "Ц",
        [22] = "Ч",
        [23] = "Ш",
        [24] = "Я",
    }

	if X == nil or Y  == nil or Z == nil then
		X, Y, Z = 1.0, 1.0, 1.0
		X, Y, Z = getCharCoordinates(playerPed)
	end
	
	if X ~= nil and Y ~= nil and Z ~= nil then
		X = math.ceil((X + 3000) / 250)
		Y = math.ceil((Y * - 1 + 3000) / 250)
		Y = KV[Y]
		if Y ~= nil then
			local KVX = (Y.."-"..X)
		
			if KVX ~= nil then
				return KVX
			end
		end
	end

	return ''
end

function sampGetVehicleInfo(vehicle)
	if doesVehicleExist(vehicle) then
		local model = getCarModel(vehicle)
		local engine = isCarEngineOn(vehicle) -- двигатель
		local speed = math.floor(getCarSpeed(vehicle) * 2.02) - 1 -- cкорость
		local gear = getCarCurrentGear(vehicle) -- передача (т)
		local allgear = getCarNumberOfGears(vehicle) -- всего передач
		local mass = getCarMass(vehicle) -- масса
		local health = getCarHealth(vehicle)
		local lockd = isCarDoorFullyOpen(vehicle)
		local tire = {} -- массив состояния колёс
		for i = 0, 3 do
			tire[i] = isCarTireBurst(vehicle, i) -- заполнение массива состояния
		end
		
		return {model = model, engine = engine, speed = speed, gear = gear, allgear = allgear, mass = mass, health = health, lockd = lockd, tire = tire}
	else
		return -1
	end
end

function sampGetBodyPart(id)
	if id == 0 then body = 'Неизвестно'
	elseif id == 1 then body = 'Спина'
	elseif id == 2 then body = 'Голова'
	elseif id == 3 then body = 'Плечо левой руки'
	elseif id == 4 then body = 'Плечо правой руки'
	elseif id == 5 then body = 'Левая рука'
	elseif id == 6 then body = 'Правая рука'
	elseif id == 7 then body = 'Левое бедро'
	elseif id == 8 then body = 'Правое бедро'
	elseif id == 9 then body = 'Левая нога'
	elseif id == 10 then body = 'Правая нога'
	elseif id == 11 then body = 'Правая голень'
	elseif id == 12 then body = 'Левая голень'
	elseif id == 13 then body = 'Левое предплечие'
	elseif id == 14 then body = 'Правое предплечие'
	elseif id == 15 then body = 'Левая ключица'
	elseif id == 16 then body = 'Правая ключица'
	elseif id == 17 then body = 'Шея'
	elseif id == 18 then body = 'Челюсть'
	else body = 'Неизвестно'
	end

	return body
end

function sampGetWeaponName(id)
	if id == 0 then weap = 'Fist'
	elseif id == 1 then weap = 'Knuckle'
	elseif id == 2 then weap = 'Golf club'
	elseif id == 3 then weap = 'Police baton'
	elseif id == 4 then weap = 'Knife'
	elseif id == 5 then weap = 'Baseball bat'
	elseif id == 6 then weap = 'Shovel'
	elseif id == 7 then weap = 'Cue'
	elseif id == 8 then weap = 'Katana'
	elseif id == 9 then weap = 'Chainsaw'
	elseif id == 10 then weap = 'Double sided Dildo'
	elseif id == 11 then weap = 'Dildo'
	elseif id == 12 then weap = 'Vibrator'
	elseif id == 13 then weap = 'Silver vibrator'
	elseif id == 14 then weap = 'Flower'
	elseif id == 15 then weap = 'Stick'
	elseif id == 16 then weap = 'Grenade'
	elseif id == 17 then weap = 'Tear Gas'
	elseif id == 18 then weap = 'Cocktail of Molotov'
	elseif id == 22 then weap = 'Gun of 9mm'
	elseif id == 23 then weap = 'SD pistol 9mm'
	elseif id == 24 then weap = 'Desert Eagle'
	elseif id == 25 then weap = 'ShotGun'
	elseif id == 26 then weap = 'Edge ShotGun'
	elseif id == 27 then weap = 'Combat ShotGun'
	elseif id == 28 then weap = 'Usi'
	elseif id == 29 then weap = 'MP-5'
	elseif id == 30 then weap = 'AK-47'
	elseif id == 31 then weap = 'M4'
	elseif id == 32 then weap = 'Tec-9'
	elseif id == 33 then weap = 'Rifle'
	elseif id == 34 then weap = 'Sniper Rifle'
	elseif id == 35 then weap = 'RPG-7'
	elseif id == 36 then weap = 'Rocket Launcher'
	elseif id == 37 then weap = 'Flamer'
	elseif id == 38 then weap = 'Minigun'
	elseif id == 39 then weap = 'Bag of C4'
	elseif id == 40 then weap = 'Detonator for C4'
	elseif id == 41 then weap = 'Spray'
	elseif id == 42 then weap = 'Огнетушитель'
	elseif id == 43 then weap = 'Photo Camera'
	elseif id == 44 then weap = 'Night Vision'
	elseif id == 45 then weap = 'Hot Vision'
	elseif id == 46 then weap = 'Parachute'
	elseif id == 49 then weap = 'Vehicle'
	else weap = 'Неизвестно'
	end

	return weap
end

function checkValiditySubscription(date)
	if string.match(date, '(%d+)%.(%d+)%.(%d+)') then
		local day, month, year = string.match(date, '(%d+)%.(%d+)%.(%d+)')
		local _day, _month, _year = os.date('%d'), os.date('%m'), os.date('%Y')

		local all1 = (tonumber(year) * 365) + (tonumber(month) * 30) + tonumber(day)
		local all2 = (_year * 365) + (_month * 30) + _day

		if all1 > all2 then
			return true, all1 - all2
		end
	end
end

function sampWeaponScene(id)
	local wname = weapons.get_name(id)

	if wname ~= nil then
		if wname == '9mm' then wname = 'p9mm' end
		wname = string.gsub(wname, '-', '_')
		wname = string.gsub(wname, ' ', '_')
	
		if ini.rpweapon[wname] ~= nil then
			if ini.rpweapon[wname] ~= '' then
				return true, ini.rpweapon[wname]
			end
		end
	end

	return false, ''
end

function sampWeaponSceneOff(id)
	local wname = weapons.get_name(id)

	if wname ~= nil then
		if wname == '9mm' then wname = 'p9mm' end
		wname = string.gsub(wname, '-', '_')
		wname = string.gsub(wname, ' ', '_')
	
		if ini.rpweaponoff[wname] ~= nil then
			if ini.rpweaponoff[wname] ~= '' then
				return true, ini.rpweaponoff[wname]
			end
		end
	end
	
	return false, ''
end

function calculateZone(x, y, z)
	if x == nil then
		x, y, z = getCharCoordinates(playerPed)
	end
	
    local streets = {{"Avispa Country Club", -2667.810, -302.135, -28.831, -2646.400, -262.320, 71.169},
    {"Easter Bay Airport", -1315.420, -405.388, 15.406, -1264.400, -209.543, 25.406},
    {"Avispa Country Club", -2550.040, -355.493, 0.000, -2470.040, -318.493, 39.700},
    {"Easter Bay Airport", -1490.330, -209.543, 15.406, -1264.400, -148.388, 25.406},
    {"Garcia", -2395.140, -222.589, -5.3, -2354.090, -204.792, 200.000},
    {"Shady Cabin", -1632.830, -2263.440, -3.0, -1601.330, -2231.790, 200.000},
    {"East Los Santos", 2381.680, -1494.030, -89.084, 2421.030, -1454.350, 110.916},
    {"LVA Freight Depot", 1236.630, 1163.410, -89.084, 1277.050, 1203.280, 110.916},
    {"Blackfield Intersection", 1277.050, 1044.690, -89.084, 1315.350, 1087.630, 110.916},
    {"Avispa Country Club", -2470.040, -355.493, 0.000, -2270.040, -318.493, 46.100},
    {"Temple", 1252.330, -926.999, -89.084, 1357.000, -910.170, 110.916},
    {"Unity Station", 1692.620, -1971.800, -20.492, 1812.620, -1932.800, 79.508},
    {"LVA Freight Depot", 1315.350, 1044.690, -89.084, 1375.600, 1087.630, 110.916},
    {"Los Flores", 2581.730, -1454.350, -89.084, 2632.830, -1393.420, 110.916},
    {"Starfish Casino", 2437.390, 1858.100, -39.084, 2495.090, 1970.850, 60.916},
    {"Easter Bay Chemicals", -1132.820, -787.391, 0.000, -956.476, -768.027, 200.000},
    {"Downtown Los Santos", 1370.850, -1170.870, -89.084, 1463.900, -1130.850, 110.916},
    {"Esplanade East", -1620.300, 1176.520, -4.5, -1580.010, 1274.260, 200.000},
    {"Market Station", 787.461, -1410.930, -34.126, 866.009, -1310.210, 65.874},
    {"Linden Station", 2811.250, 1229.590, -39.594, 2861.250, 1407.590, 60.406},
    {"Montgomery Intersection", 1582.440, 347.457, 0.000, 1664.620, 401.750, 200.000},
    {"Frederick Bridge", 2759.250, 296.501, 0.000, 2774.250, 594.757, 200.000},
    {"Yellow Bell Station", 1377.480, 2600.430, -21.926, 1492.450, 2687.360, 78.074},
    {"Downtown Los Santos", 1507.510, -1385.210, 110.916, 1582.550, -1325.310, 335.916},
    {"Jefferson", 2185.330, -1210.740, -89.084, 2281.450, -1154.590, 110.916},
    {"Mulholland", 1318.130, -910.170, -89.084, 1357.000, -768.027, 110.916},
    {"Avispa Country Club", -2361.510, -417.199, 0.000, -2270.040, -355.493, 200.000},
    {"Jefferson", 1996.910, -1449.670, -89.084, 2056.860, -1350.720, 110.916},
    {"Julius Thruway West", 1236.630, 2142.860, -89.084, 1297.470, 2243.230, 110.916},
    {"Jefferson", 2124.660, -1494.030, -89.084, 2266.210, -1449.670, 110.916},
    {"Julius Thruway North", 1848.400, 2478.490, -89.084, 1938.800, 2553.490, 110.916},
    {"Rodeo", 422.680, -1570.200, -89.084, 466.223, -1406.050, 110.916},
    {"Cranberry Station", -2007.830, 56.306, 0.000, -1922.000, 224.782, 100.000},
    {"Downtown Los Santos", 1391.050, -1026.330, -89.084, 1463.900, -926.999, 110.916},
    {"Redsands West", 1704.590, 2243.230, -89.084, 1777.390, 2342.830, 110.916},
    {"Little Mexico", 1758.900, -1722.260, -89.084, 1812.620, -1577.590, 110.916},
    {"Blackfield Intersection", 1375.600, 823.228, -89.084, 1457.390, 919.447, 110.916},
    {"Los Santos International", 1974.630, -2394.330, -39.084, 2089.000, -2256.590, 60.916},
    {"Beacon Hill", -399.633, -1075.520, -1.489, -319.033, -977.516, 198.511},
    {"Rodeo", 334.503, -1501.950, -89.084, 422.680, -1406.050, 110.916},
    {"Richman", 225.165, -1369.620, -89.084, 334.503, -1292.070, 110.916},
    {"Downtown Los Santos", 1724.760, -1250.900, -89.084, 1812.620, -1150.870, 110.916},
    {"The Strip", 2027.400, 1703.230, -89.084, 2137.400, 1783.230, 110.916},
    {"Downtown Los Santos", 1378.330, -1130.850, -89.084, 1463.900, -1026.330, 110.916},
    {"Blackfield Intersection", 1197.390, 1044.690, -89.084, 1277.050, 1163.390, 110.916},
    {"Conference Center", 1073.220, -1842.270, -89.084, 1323.900, -1804.210, 110.916},
    {"Montgomery", 1451.400, 347.457, -6.1, 1582.440, 420.802, 200.000},
    {"Foster Valley", -2270.040, -430.276, -1.2, -2178.690, -324.114, 200.000},
    {"Blackfield Chapel", 1325.600, 596.349, -89.084, 1375.600, 795.010, 110.916},
    {"Los Santos International", 2051.630, -2597.260, -39.084, 2152.450, -2394.330, 60.916},
    {"Mulholland", 1096.470, -910.170, -89.084, 1169.130, -768.027, 110.916},
    {"Yellow Bell Gol Course", 1457.460, 2723.230, -89.084, 1534.560, 2863.230, 110.916},
    {"The Strip", 2027.400, 1783.230, -89.084, 2162.390, 1863.230, 110.916},
    {"Jefferson", 2056.860, -1210.740, -89.084, 2185.330, -1126.320, 110.916},
    {"Mulholland", 952.604, -937.184, -89.084, 1096.470, -860.619, 110.916},
    {"Aldea Malvada", -1372.140, 2498.520, 0.000, -1277.590, 2615.350, 200.000},
    {"Las Colinas", 2126.860, -1126.320, -89.084, 2185.330, -934.489, 110.916},
    {"Las Colinas", 1994.330, -1100.820, -89.084, 2056.860, -920.815, 110.916},
    {"Richman", 647.557, -954.662, -89.084, 768.694, -860.619, 110.916},
    {"LVA Freight Depot", 1277.050, 1087.630, -89.084, 1375.600, 1203.280, 110.916},
    {"Julius Thruway North", 1377.390, 2433.230, -89.084, 1534.560, 2507.230, 110.916},
    {"Willowfield", 2201.820, -2095.000, -89.084, 2324.000, -1989.900, 110.916},
    {"Julius Thruway North", 1704.590, 2342.830, -89.084, 1848.400, 2433.230, 110.916},
    {"Temple", 1252.330, -1130.850, -89.084, 1378.330, -1026.330, 110.916},
    {"Little Mexico", 1701.900, -1842.270, -89.084, 1812.620, -1722.260, 110.916},
    {"Queens", -2411.220, 373.539, 0.000, -2253.540, 458.411, 200.000},
    {"Las Venturas Airport", 1515.810, 1586.400, -12.500, 1729.950, 1714.560, 87.500},
    {"Richman", 225.165, -1292.070, -89.084, 466.223, -1235.070, 110.916},
    {"Temple", 1252.330, -1026.330, -89.084, 1391.050, -926.999, 110.916},
    {"East Los Santos", 2266.260, -1494.030, -89.084, 2381.680, -1372.040, 110.916},
    {"Julius Thruway East", 2623.180, 943.235, -89.084, 2749.900, 1055.960, 110.916},
    {"Willowfield", 2541.700, -1941.400, -89.084, 2703.580, -1852.870, 110.916},
    {"Las Colinas", 2056.860, -1126.320, -89.084, 2126.860, -920.815, 110.916},
    {"Julius Thruway East", 2625.160, 2202.760, -89.084, 2685.160, 2442.550, 110.916},
    {"Rodeo", 225.165, -1501.950, -89.084, 334.503, -1369.620, 110.916},
    {"Las Brujas", -365.167, 2123.010, -3.0, -208.570, 2217.680, 200.000},
    {"Julius Thruway East", 2536.430, 2442.550, -89.084, 2685.160, 2542.550, 110.916},
    {"Rodeo", 334.503, -1406.050, -89.084, 466.223, -1292.070, 110.916},
    {"Vinewood", 647.557, -1227.280, -89.084, 787.461, -1118.280, 110.916},
    {"Rodeo", 422.680, -1684.650, -89.084, 558.099, -1570.200, 110.916},
    {"Julius Thruway North", 2498.210, 2542.550, -89.084, 2685.160, 2626.550, 110.916},
    {"Downtown Los Santos", 1724.760, -1430.870, -89.084, 1812.620, -1250.900, 110.916},
    {"Rodeo", 225.165, -1684.650, -89.084, 312.803, -1501.950, 110.916},
    {"Jefferson", 2056.860, -1449.670, -89.084, 2266.210, -1372.040, 110.916},
    {"Hampton Barns", 603.035, 264.312, 0.000, 761.994, 366.572, 200.000},
    {"Temple", 1096.470, -1130.840, -89.084, 1252.330, -1026.330, 110.916},
    {"Kincaid Bridge", -1087.930, 855.370, -89.084, -961.950, 986.281, 110.916},
    {"Verona Beach", 1046.150, -1722.260, -89.084, 1161.520, -1577.590, 110.916},
    {"Commerce", 1323.900, -1722.260, -89.084, 1440.900, -1577.590, 110.916},
    {"Mulholland", 1357.000, -926.999, -89.084, 1463.900, -768.027, 110.916},
    {"Rodeo", 466.223, -1570.200, -89.084, 558.099, -1385.070, 110.916},
    {"Mulholland", 911.802, -860.619, -89.084, 1096.470, -768.027, 110.916},
    {"Mulholland", 768.694, -954.662, -89.084, 952.604, -860.619, 110.916},
    {"Julius Thruway South", 2377.390, 788.894, -89.084, 2537.390, 897.901, 110.916},
    {"Idlewood", 1812.620, -1852.870, -89.084, 1971.660, -1742.310, 110.916},
    {"Ocean Docks", 2089.000, -2394.330, -89.084, 2201.820, -2235.840, 110.916},
    {"Commerce", 1370.850, -1577.590, -89.084, 1463.900, -1384.950, 110.916},
    {"Julius Thruway North", 2121.400, 2508.230, -89.084, 2237.400, 2663.170, 110.916},
    {"Temple", 1096.470, -1026.330, -89.084, 1252.330, -910.170, 110.916},
    {"Glen Park", 1812.620, -1449.670, -89.084, 1996.910, -1350.720, 110.916},
    {"Easter Bay Airport", -1242.980, -50.096, 0.000, -1213.910, 578.396, 200.000},
    {"Martin Bridge", -222.179, 293.324, 0.000, -122.126, 476.465, 200.000},
    {"The Strip", 2106.700, 1863.230, -89.084, 2162.390, 2202.760, 110.916},
    {"Willowfield", 2541.700, -2059.230, -89.084, 2703.580, -1941.400, 110.916},
    {"Marina", 807.922, -1577.590, -89.084, 926.922, -1416.250, 110.916},
    {"Las Venturas Airport", 1457.370, 1143.210, -89.084, 1777.400, 1203.280, 110.916},
    {"Idlewood", 1812.620, -1742.310, -89.084, 1951.660, -1602.310, 110.916},
    {"Esplanade East", -1580.010, 1025.980, -6.1, -1499.890, 1274.260, 200.000},
    {"Downtown Los Santos", 1370.850, -1384.950, -89.084, 1463.900, -1170.870, 110.916},
    {"The Mako Span", 1664.620, 401.750, 0.000, 1785.140, 567.203, 200.000},
    {"Rodeo", 312.803, -1684.650, -89.084, 422.680, -1501.950, 110.916},
    {"Pershing Square", 1440.900, -1722.260, -89.084, 1583.500, -1577.590, 110.916},
    {"Mulholland", 687.802, -860.619, -89.084, 911.802, -768.027, 110.916},
    {"Gant Bridge", -2741.070, 1490.470, -6.1, -2616.400, 1659.680, 200.000},
    {"Las Colinas", 2185.330, -1154.590, -89.084, 2281.450, -934.489, 110.916},
    {"Mulholland", 1169.130, -910.170, -89.084, 1318.130, -768.027, 110.916},
    {"Julius Thruway North", 1938.800, 2508.230, -89.084, 2121.400, 2624.230, 110.916},
    {"Commerce", 1667.960, -1577.590, -89.084, 1812.620, -1430.870, 110.916},
    {"Rodeo", 72.648, -1544.170, -89.084, 225.165, -1404.970, 110.916},
    {"Roca Escalante", 2536.430, 2202.760, -89.084, 2625.160, 2442.550, 110.916},
    {"Rodeo", 72.648, -1684.650, -89.084, 225.165, -1544.170, 110.916},
    {"Market", 952.663, -1310.210, -89.084, 1072.660, -1130.850, 110.916},
    {"Las Colinas", 2632.740, -1135.040, -89.084, 2747.740, -945.035, 110.916},
    {"Mulholland", 861.085, -674.885, -89.084, 1156.550, -600.896, 110.916},
    {"King's", -2253.540, 373.539, -9.1, -1993.280, 458.411, 200.000},
    {"Redsands East", 1848.400, 2342.830, -89.084, 2011.940, 2478.490, 110.916},
    {"Downtown", -1580.010, 744.267, -6.1, -1499.890, 1025.980, 200.000},
    {"Conference Center", 1046.150, -1804.210, -89.084, 1323.900, -1722.260, 110.916},
    {"Richman", 647.557, -1118.280, -89.084, 787.461, -954.662, 110.916},
    {"Ocean Flats", -2994.490, 277.411, -9.1, -2867.850, 458.411, 200.000},
    {"Greenglass College", 964.391, 930.890, -89.084, 1166.530, 1044.690, 110.916},
    {"Glen Park", 1812.620, -1100.820, -89.084, 1994.330, -973.380, 110.916},
    {"LVA Freight Depot", 1375.600, 919.447, -89.084, 1457.370, 1203.280, 110.916},
    {"Regular Tom", -405.770, 1712.860, -3.0, -276.719, 1892.750, 200.000},
    {"Verona Beach", 1161.520, -1722.260, -89.084, 1323.900, -1577.590, 110.916},
    {"East Los Santos", 2281.450, -1372.040, -89.084, 2381.680, -1135.040, 110.916},
    {"Caligula's Palace", 2137.400, 1703.230, -89.084, 2437.390, 1783.230, 110.916},
    {"Idlewood", 1951.660, -1742.310, -89.084, 2124.660, -1602.310, 110.916},
    {"Pilgrim", 2624.400, 1383.230, -89.084, 2685.160, 1783.230, 110.916},
    {"Idlewood", 2124.660, -1742.310, -89.084, 2222.560, -1494.030, 110.916},
    {"Queens", -2533.040, 458.411, 0.000, -2329.310, 578.396, 200.000},
    {"Downtown", -1871.720, 1176.420, -4.5, -1620.300, 1274.260, 200.000},
    {"Commerce", 1583.500, -1722.260, -89.084, 1758.900, -1577.590, 110.916},
    {"East Los Santos", 2381.680, -1454.350, -89.084, 2462.130, -1135.040, 110.916},
    {"Marina", 647.712, -1577.590, -89.084, 807.922, -1416.250, 110.916},
    {"Richman", 72.648, -1404.970, -89.084, 225.165, -1235.070, 110.916},
    {"Vinewood", 647.712, -1416.250, -89.084, 787.461, -1227.280, 110.916},
    {"East Los Santos", 2222.560, -1628.530, -89.084, 2421.030, -1494.030, 110.916},
    {"Rodeo", 558.099, -1684.650, -89.084, 647.522, -1384.930, 110.916},
    {"Easter Tunnel", -1709.710, -833.034, -1.5, -1446.010, -730.118, 200.000},
    {"Rodeo", 466.223, -1385.070, -89.084, 647.522, -1235.070, 110.916},
    {"Redsands East", 1817.390, 2202.760, -89.084, 2011.940, 2342.830, 110.916},
    {"The Clown's Pocket", 2162.390, 1783.230, -89.084, 2437.390, 1883.230, 110.916},
    {"Idlewood", 1971.660, -1852.870, -89.084, 2222.560, -1742.310, 110.916},
    {"Montgomery Intersection", 1546.650, 208.164, 0.000, 1745.830, 347.457, 200.000},
    {"Willowfield", 2089.000, -2235.840, -89.084, 2201.820, -1989.900, 110.916},
    {"Temple", 952.663, -1130.840, -89.084, 1096.470, -937.184, 110.916},
    {"Prickle Pine", 1848.400, 2553.490, -89.084, 1938.800, 2863.230, 110.916},
    {"Los Santos International", 1400.970, -2669.260, -39.084, 2189.820, -2597.260, 60.916},
    {"Garver Bridge", -1213.910, 950.022, -89.084, -1087.930, 1178.930, 110.916},
    {"Garver Bridge", -1339.890, 828.129, -89.084, -1213.910, 1057.040, 110.916},
    {"Kincaid Bridge", -1339.890, 599.218, -89.084, -1213.910, 828.129, 110.916},
    {"Kincaid Bridge", -1213.910, 721.111, -89.084, -1087.930, 950.022, 110.916},
    {"Verona Beach", 930.221, -2006.780, -89.084, 1073.220, -1804.210, 110.916},
    {"Verdant Bluffs", 1073.220, -2006.780, -89.084, 1249.620, -1842.270, 110.916},
    {"Vinewood", 787.461, -1130.840, -89.084, 952.604, -954.662, 110.916},
    {"Vinewood", 787.461, -1310.210, -89.084, 952.663, -1130.840, 110.916},
    {"Commerce", 1463.900, -1577.590, -89.084, 1667.960, -1430.870, 110.916},
    {"Market", 787.461, -1416.250, -89.084, 1072.660, -1310.210, 110.916},
    {"Rockshore West", 2377.390, 596.349, -89.084, 2537.390, 788.894, 110.916},
    {"Julius Thruway North", 2237.400, 2542.550, -89.084, 2498.210, 2663.170, 110.916},
    {"East Beach", 2632.830, -1668.130, -89.084, 2747.740, -1393.420, 110.916},
    {"Fallow Bridge", 434.341, 366.572, 0.000, 603.035, 555.680, 200.000},
    {"Willowfield", 2089.000, -1989.900, -89.084, 2324.000, -1852.870, 110.916},
    {"Chinatown", -2274.170, 578.396, -7.6, -2078.670, 744.170, 200.000},
    {"El Castillo del Diablo", -208.570, 2337.180, 0.000, 8.430, 2487.180, 200.000},
    {"Ocean Docks", 2324.000, -2145.100, -89.084, 2703.580, -2059.230, 110.916},
    {"Easter Bay Chemicals", -1132.820, -768.027, 0.000, -956.476, -578.118, 200.000},
    {"The Visage", 1817.390, 1703.230, -89.084, 2027.400, 1863.230, 110.916},
    {"Ocean Flats", -2994.490, -430.276, -1.2, -2831.890, -222.589, 200.000},
    {"Richman", 321.356, -860.619, -89.084, 687.802, -768.027, 110.916},
    {"Green Palms", 176.581, 1305.450, -3.0, 338.658, 1520.720, 200.000},
    {"Richman", 321.356, -768.027, -89.084, 700.794, -674.885, 110.916},
    {"Starfish Casino", 2162.390, 1883.230, -89.084, 2437.390, 2012.180, 110.916},
    {"East Beach", 2747.740, -1668.130, -89.084, 2959.350, -1498.620, 110.916},
    {"Jefferson", 2056.860, -1372.040, -89.084, 2281.450, -1210.740, 110.916},
    {"Downtown Los Santos", 1463.900, -1290.870, -89.084, 1724.760, -1150.870, 110.916},
    {"Downtown Los Santos", 1463.900, -1430.870, -89.084, 1724.760, -1290.870, 110.916},
    {"Garver Bridge", -1499.890, 696.442, -179.615, -1339.890, 925.353, 20.385},
    {"Julius Thruway South", 1457.390, 823.228, -89.084, 2377.390, 863.229, 110.916},
    {"East Los Santos", 2421.030, -1628.530, -89.084, 2632.830, -1454.350, 110.916},
    {"Greenglass College", 964.391, 1044.690, -89.084, 1197.390, 1203.220, 110.916},
    {"Las Colinas", 2747.740, -1120.040, -89.084, 2959.350, -945.035, 110.916},
    {"Mulholland", 737.573, -768.027, -89.084, 1142.290, -674.885, 110.916},
    {"Ocean Docks", 2201.820, -2730.880, -89.084, 2324.000, -2418.330, 110.916},
    {"East Los Santos", 2462.130, -1454.350, -89.084, 2581.730, -1135.040, 110.916},
    {"Ganton", 2222.560, -1722.330, -89.084, 2632.830, -1628.530, 110.916},
    {"Avispa Country Club", -2831.890, -430.276, -6.1, -2646.400, -222.589, 200.000},
    {"Willowfield", 1970.620, -2179.250, -89.084, 2089.000, -1852.870, 110.916},
    {"Esplanade North", -1982.320, 1274.260, -4.5, -1524.240, 1358.900, 200.000},
    {"The High Roller", 1817.390, 1283.230, -89.084, 2027.390, 1469.230, 110.916},
    {"Ocean Docks", 2201.820, -2418.330, -89.084, 2324.000, -2095.000, 110.916},
    {"Last Dime Motel", 1823.080, 596.349, -89.084, 1997.220, 823.228, 110.916},
    {"Bayside Marina", -2353.170, 2275.790, 0.000, -2153.170, 2475.790, 200.000},
    {"King's", -2329.310, 458.411, -7.6, -1993.280, 578.396, 200.000},
    {"El Corona", 1692.620, -2179.250, -89.084, 1812.620, -1842.270, 110.916},
    {"Blackfield Chapel", 1375.600, 596.349, -89.084, 1558.090, 823.228, 110.916},
    {"The Pink Swan", 1817.390, 1083.230, -89.084, 2027.390, 1283.230, 110.916},
    {"Julius Thruway West", 1197.390, 1163.390, -89.084, 1236.630, 2243.230, 110.916},
    {"Los Flores", 2581.730, -1393.420, -89.084, 2747.740, -1135.040, 110.916},
    {"The Visage", 1817.390, 1863.230, -89.084, 2106.700, 2011.830, 110.916},
    {"Prickle Pine", 1938.800, 2624.230, -89.084, 2121.400, 2861.550, 110.916},
    {"Verona Beach", 851.449, -1804.210, -89.084, 1046.150, -1577.590, 110.916},
    {"Robada Intersection", -1119.010, 1178.930, -89.084, -862.025, 1351.450, 110.916},
    {"Linden Side", 2749.900, 943.235, -89.084, 2923.390, 1198.990, 110.916},
    {"Ocean Docks", 2703.580, -2302.330, -89.084, 2959.350, -2126.900, 110.916},
    {"Willowfield", 2324.000, -2059.230, -89.084, 2541.700, -1852.870, 110.916},
    {"King's", -2411.220, 265.243, -9.1, -1993.280, 373.539, 200.000},
    {"Commerce", 1323.900, -1842.270, -89.084, 1701.900, -1722.260, 110.916},
    {"Mulholland", 1269.130, -768.027, -89.084, 1414.070, -452.425, 110.916},
    {"Marina", 647.712, -1804.210, -89.084, 851.449, -1577.590, 110.916},
    {"Battery Point", -2741.070, 1268.410, -4.5, -2533.040, 1490.470, 200.000},
    {"The Four Dragons Casino", 1817.390, 863.232, -89.084, 2027.390, 1083.230, 110.916},
    {"Blackfield", 964.391, 1203.220, -89.084, 1197.390, 1403.220, 110.916},
    {"Julius Thruway North", 1534.560, 2433.230, -89.084, 1848.400, 2583.230, 110.916},
    {"Yellow Bell Gol Course", 1117.400, 2723.230, -89.084, 1457.460, 2863.230, 110.916},
    {"Idlewood", 1812.620, -1602.310, -89.084, 2124.660, -1449.670, 110.916},
    {"Redsands West", 1297.470, 2142.860, -89.084, 1777.390, 2243.230, 110.916},
    {"Doherty", -2270.040, -324.114, -1.2, -1794.920, -222.589, 200.000},
    {"Hilltop Farm", 967.383, -450.390, -3.0, 1176.780, -217.900, 200.000},
    {"Las Barrancas", -926.130, 1398.730, -3.0, -719.234, 1634.690, 200.000},
    {"Pirates in Men's Pants", 1817.390, 1469.230, -89.084, 2027.400, 1703.230, 110.916},
    {"City Hall", -2867.850, 277.411, -9.1, -2593.440, 458.411, 200.000},
    {"Avispa Country Club", -2646.400, -355.493, 0.000, -2270.040, -222.589, 200.000},
    {"The Strip", 2027.400, 863.229, -89.084, 2087.390, 1703.230, 110.916},
    {"Hashbury", -2593.440, -222.589, -1.0, -2411.220, 54.722, 200.000},
    {"Los Santos International", 1852.000, -2394.330, -89.084, 2089.000, -2179.250, 110.916},
    {"Whitewood Estates", 1098.310, 1726.220, -89.084, 1197.390, 2243.230, 110.916},
    {"Sherman Reservoir", -789.737, 1659.680, -89.084, -599.505, 1929.410, 110.916},
    {"El Corona", 1812.620, -2179.250, -89.084, 1970.620, -1852.870, 110.916},
    {"Downtown", -1700.010, 744.267, -6.1, -1580.010, 1176.520, 200.000},
    {"Foster Valley", -2178.690, -1250.970, 0.000, -1794.920, -1115.580, 200.000},
    {"Las Payasadas", -354.332, 2580.360, 2.0, -133.625, 2816.820, 200.000},
    {"Valle Ocultado", -936.668, 2611.440, 2.0, -715.961, 2847.900, 200.000},
    {"Blackfield Intersection", 1166.530, 795.010, -89.084, 1375.600, 1044.690, 110.916},
    {"Ganton", 2222.560, -1852.870, -89.084, 2632.830, -1722.330, 110.916},
    {"Easter Bay Airport", -1213.910, -730.118, 0.000, -1132.820, -50.096, 200.000},
    {"Redsands East", 1817.390, 2011.830, -89.084, 2106.700, 2202.760, 110.916},
    {"Esplanade East", -1499.890, 578.396, -79.615, -1339.890, 1274.260, 20.385},
    {"Caligula's Palace", 2087.390, 1543.230, -89.084, 2437.390, 1703.230, 110.916},
    {"Royal Casino", 2087.390, 1383.230, -89.084, 2437.390, 1543.230, 110.916},
    {"Richman", 72.648, -1235.070, -89.084, 321.356, -1008.150, 110.916},
    {"Starfish Casino", 2437.390, 1783.230, -89.084, 2685.160, 2012.180, 110.916},
    {"Mulholland", 1281.130, -452.425, -89.084, 1641.130, -290.913, 110.916},
    {"Downtown", -1982.320, 744.170, -6.1, -1871.720, 1274.260, 200.000},
    {"Hankypanky Point", 2576.920, 62.158, 0.000, 2759.250, 385.503, 200.000},
    {"K.A.C.C. Military Fuels", 2498.210, 2626.550, -89.084, 2749.900, 2861.550, 110.916},
    {"Harry Gold Parkway", 1777.390, 863.232, -89.084, 1817.390, 2342.830, 110.916},
    {"Bayside Tunnel", -2290.190, 2548.290, -89.084, -1950.190, 2723.290, 110.916},
    {"Ocean Docks", 2324.000, -2302.330, -89.084, 2703.580, -2145.100, 110.916},
    {"Richman", 321.356, -1044.070, -89.084, 647.557, -860.619, 110.916},
    {"Randolph Industrial Estate", 1558.090, 596.349, -89.084, 1823.080, 823.235, 110.916},
    {"East Beach", 2632.830, -1852.870, -89.084, 2959.350, -1668.130, 110.916},
    {"Flint Water", -314.426, -753.874, -89.084, -106.339, -463.073, 110.916},
    {"Blueberry", 19.607, -404.136, 3.8, 349.607, -220.137, 200.000},
    {"Linden Station", 2749.900, 1198.990, -89.084, 2923.390, 1548.990, 110.916},
    {"Glen Park", 1812.620, -1350.720, -89.084, 2056.860, -1100.820, 110.916},
    {"Downtown", -1993.280, 265.243, -9.1, -1794.920, 578.396, 200.000},
    {"Redsands West", 1377.390, 2243.230, -89.084, 1704.590, 2433.230, 110.916},
    {"Richman", 321.356, -1235.070, -89.084, 647.522, -1044.070, 110.916},
    {"Gant Bridge", -2741.450, 1659.680, -6.1, -2616.400, 2175.150, 200.000},
    {"Lil' Probe Inn", -90.218, 1286.850, -3.0, 153.859, 1554.120, 200.000},
    {"Flint Intersection", -187.700, -1596.760, -89.084, 17.063, -1276.600, 110.916},
    {"Las Colinas", 2281.450, -1135.040, -89.084, 2632.740, -945.035, 110.916},
    {"Sobell Rail Yards", 2749.900, 1548.990, -89.084, 2923.390, 1937.250, 110.916},
    {"The Emerald Isle", 2011.940, 2202.760, -89.084, 2237.400, 2508.230, 110.916},
    {"El Castillo del Diablo", -208.570, 2123.010, -7.6, 114.033, 2337.180, 200.000},
    {"Santa Flora", -2741.070, 458.411, -7.6, -2533.040, 793.411, 200.000},
    {"Playa del Seville", 2703.580, -2126.900, -89.084, 2959.350, -1852.870, 110.916},
    {"Market", 926.922, -1577.590, -89.084, 1370.850, -1416.250, 110.916},
    {"Queens", -2593.440, 54.722, 0.000, -2411.220, 458.411, 200.000},
    {"Pilson Intersection", 1098.390, 2243.230, -89.084, 1377.390, 2507.230, 110.916},
    {"Spinybed", 2121.400, 2663.170, -89.084, 2498.210, 2861.550, 110.916},
    {"Pilgrim", 2437.390, 1383.230, -89.084, 2624.400, 1783.230, 110.916},
    {"Blackfield", 964.391, 1403.220, -89.084, 1197.390, 1726.220, 110.916},
    {"'The Big Ear'", -410.020, 1403.340, -3.0, -137.969, 1681.230, 200.000},
    {"Dillimore", 580.794, -674.885, -9.5, 861.085, -404.790, 200.000},
    {"El Quebrados", -1645.230, 2498.520, 0.000, -1372.140, 2777.850, 200.000},
    {"Esplanade North", -2533.040, 1358.900, -4.5, -1996.660, 1501.210, 200.000},
    {"Easter Bay Airport", -1499.890, -50.096, -1.0, -1242.980, 249.904, 200.000},
    {"Fisher's Lagoon", 1916.990, -233.323, -100.000, 2131.720, 13.800, 200.000},
    {"Mulholland", 1414.070, -768.027, -89.084, 1667.610, -452.425, 110.916},
    {"East Beach", 2747.740, -1498.620, -89.084, 2959.350, -1120.040, 110.916},
    {"San Andreas Sound", 2450.390, 385.503, -100.000, 2759.250, 562.349, 200.000},
    {"Shady Creeks", -2030.120, -2174.890, -6.1, -1820.640, -1771.660, 200.000},
    {"Market", 1072.660, -1416.250, -89.084, 1370.850, -1130.850, 110.916},
    {"Rockshore West", 1997.220, 596.349, -89.084, 2377.390, 823.228, 110.916},
    {"Prickle Pine", 1534.560, 2583.230, -89.084, 1848.400, 2863.230, 110.916},
    {"Easter Basin", -1794.920, -50.096, -1.04, -1499.890, 249.904, 200.000},
    {"Leafy Hollow", -1166.970, -1856.030, 0.000, -815.624, -1602.070, 200.000},
    {"LVA Freight Depot", 1457.390, 863.229, -89.084, 1777.400, 1143.210, 110.916},
    {"Prickle Pine", 1117.400, 2507.230, -89.084, 1534.560, 2723.230, 110.916},
    {"Blueberry", 104.534, -220.137, 2.3, 349.607, 152.236, 200.000},
    {"El Castillo del Diablo", -464.515, 2217.680, 0.000, -208.570, 2580.360, 200.000},
    {"Downtown", -2078.670, 578.396, -7.6, -1499.890, 744.267, 200.000},
    {"Rockshore East", 2537.390, 676.549, -89.084, 2902.350, 943.235, 110.916},
    {"San Fierro Bay", -2616.400, 1501.210, -3.0, -1996.660, 1659.680, 200.000},
    {"Paradiso", -2741.070, 793.411, -6.1, -2533.040, 1268.410, 200.000},
    {"The Camel's Toe", 2087.390, 1203.230, -89.084, 2640.400, 1383.230, 110.916},
    {"Old Venturas Strip", 2162.390, 2012.180, -89.084, 2685.160, 2202.760, 110.916},
    {"Juniper Hill", -2533.040, 578.396, -7.6, -2274.170, 968.369, 200.000},
    {"Juniper Hollow", -2533.040, 968.369, -6.1, -2274.170, 1358.900, 200.000},
    {"Roca Escalante", 2237.400, 2202.760, -89.084, 2536.430, 2542.550, 110.916},
    {"Julius Thruway East", 2685.160, 1055.960, -89.084, 2749.900, 2626.550, 110.916},
    {"Verona Beach", 647.712, -2173.290, -89.084, 930.221, -1804.210, 110.916},
    {"Foster Valley", -2178.690, -599.884, -1.2, -1794.920, -324.114, 200.000},
    {"Arco del Oeste", -901.129, 2221.860, 0.000, -592.090, 2571.970, 200.000},
    {"Fallen Tree", -792.254, -698.555, -5.3, -452.404, -380.043, 200.000},
    {"The Farm", -1209.670, -1317.100, 114.981, -908.161, -787.391, 251.981},
    {"The Sherman Dam", -968.772, 1929.410, -3.0, -481.126, 2155.260, 200.000},
    {"Esplanade North", -1996.660, 1358.900, -4.5, -1524.240, 1592.510, 200.000},
    {"Financial", -1871.720, 744.170, -6.1, -1701.300, 1176.420, 300.000},
    {"Garcia", -2411.220, -222.589, -1.14, -2173.040, 265.243, 200.000},
    {"Montgomery", 1119.510, 119.526, -3.0, 1451.400, 493.323, 200.000},
    {"Creek", 2749.900, 1937.250, -89.084, 2921.620, 2669.790, 110.916},
    {"Los Santos International", 1249.620, -2394.330, -89.084, 1852.000, -2179.250, 110.916},
    {"Santa Maria Beach", 72.648, -2173.290, -89.084, 342.648, -1684.650, 110.916},
    {"Mulholland Intersection", 1463.900, -1150.870, -89.084, 1812.620, -768.027, 110.916},
    {"Angel Pine", -2324.940, -2584.290, -6.1, -1964.220, -2212.110, 200.000},
    {"Verdant Meadows", 37.032, 2337.180, -3.0, 435.988, 2677.900, 200.000},
    {"Octane Springs", 338.658, 1228.510, 0.000, 664.308, 1655.050, 200.000},
    {"Come-A-Lot", 2087.390, 943.235, -89.084, 2623.180, 1203.230, 110.916},
    {"Redsands West", 1236.630, 1883.110, -89.084, 1777.390, 2142.860, 110.916},
    {"Santa Maria Beach", 342.648, -2173.290, -89.084, 647.712, -1684.650, 110.916},
    {"Verdant Bluffs", 1249.620, -2179.250, -89.084, 1692.620, -1842.270, 110.916},
    {"Las Venturas Airport", 1236.630, 1203.280, -89.084, 1457.370, 1883.110, 110.916},
    {"Flint Range", -594.191, -1648.550, 0.000, -187.700, -1276.600, 200.000},
    {"Verdant Bluffs", 930.221, -2488.420, -89.084, 1249.620, -2006.780, 110.916},
    {"Palomino Creek", 2160.220, -149.004, 0.000, 2576.920, 228.322, 200.000},
    {"Ocean Docks", 2373.770, -2697.090, -89.084, 2809.220, -2330.460, 110.916},
    {"Easter Bay Airport", -1213.910, -50.096, -4.5, -947.980, 578.396, 200.000},
    {"Whitewood Estates", 883.308, 1726.220, -89.084, 1098.310, 2507.230, 110.916},
    {"Calton Heights", -2274.170, 744.170, -6.1, -1982.320, 1358.900, 200.000},
    {"Easter Basin", -1794.920, 249.904, -9.1, -1242.980, 578.396, 200.000},
    {"Los Santos Inlet", -321.744, -2224.430, -89.084, 44.615, -1724.430, 110.916},
    {"Doherty", -2173.040, -222.589, -1.0, -1794.920, 265.243, 200.000},
    {"Mount Chiliad", -2178.690, -2189.910, -47.917, -2030.120, -1771.660, 576.083},
    {"Fort Carson", -376.233, 826.326, -3.0, 123.717, 1220.440, 200.000},
    {"Foster Valley", -2178.690, -1115.580, 0.000, -1794.920, -599.884, 200.000},
    {"Ocean Flats", -2994.490, -222.589, -1.0, -2593.440, 277.411, 200.000},
    {"Fern Ridge", 508.189, -139.259, 0.000, 1306.660, 119.526, 200.000},
    {"Bayside", -2741.070, 2175.150, 0.000, -2353.170, 2722.790, 200.000},
    {"Las Venturas Airport", 1457.370, 1203.280, -89.084, 1777.390, 1883.110, 110.916},
    {"Blueberry Acres", -319.676, -220.137, 0.000, 104.534, 293.324, 200.000},
    {"Palisades", -2994.490, 458.411, -6.1, -2741.070, 1339.610, 200.000},
    {"North Rock", 2285.370, -768.027, 0.000, 2770.590, -269.740, 200.000},
    {"Hunter Quarry", 337.244, 710.840, -115.239, 860.554, 1031.710, 203.761},
    {"Los Santos International", 1382.730, -2730.880, -89.084, 2201.820, -2394.330, 110.916},
    {"Missionary Hill", -2994.490, -811.276, 0.000, -2178.690, -430.276, 200.000},
    {"San Fierro Bay", -2616.400, 1659.680, -3.0, -1996.660, 2175.150, 200.000},
    {"Restricted Area", -91.586, 1655.050, -50.000, 421.234, 2123.010, 250.000},
    {"Mount Chiliad", -2997.470, -1115.580, -47.917, -2178.690, -971.913, 576.083},
    {"Mount Chiliad", -2178.690, -1771.660, -47.917, -1936.120, -1250.970, 576.083},
    {"Easter Bay Airport", -1794.920, -730.118, -3.0, -1213.910, -50.096, 200.000},
    {"The Panopticon", -947.980, -304.320, -1.1, -319.676, 327.071, 200.000},
    {"Shady Creeks", -1820.640, -2643.680, -8.0, -1226.780, -1771.660, 200.000},
    {"Back o Beyond", -1166.970, -2641.190, 0.000, -321.744, -1856.030, 200.000},
    {"Mount Chiliad", -2994.490, -2189.910, -47.917, -2178.690, -1115.580, 576.083},
    {"Tierra Robada", -1213.910, 596.349, -242.990, -480.539, 1659.680, 900.000},
    {"Flint County", -1213.910, -2892.970, -242.990, 44.615, -768.027, 900.000},
    {"Whetstone", -2997.470, -2892.970, -242.990, -1213.910, -1115.580, 900.000},
    {"Bone County", -480.539, 596.349, -242.990, 869.461, 2993.870, 900.000},
    {"Tierra Robada", -2997.470, 1659.680, -242.990, -480.539, 2993.870, 900.000},
    {"San Fierro", -2997.470, -1115.580, -242.990, -1213.910, 1659.680, 900.000},
    {"Las Venturas", 869.461, 596.349, -242.990, 2997.060, 2993.870, 900.000},
    {"Red County", -1213.910, -768.027, -242.990, 2997.060, 596.349, 900.000},
    {"Los Santos", 44.615, -2892.970, -242.990, 2997.060, -768.027, 900.000}}
    for i, v in ipairs(streets) do
        if (x >= v[2]) and (y >= v[3]) and (z >= v[4]) and (x <= v[5]) and (y <= v[6]) and (z <= v[7]) then
            return v[1]
        end
    end
    return "Unknown"
end

function sampGetColorByPlayer(id)
	local a, r, g, b = explode_argb(sampGetPlayerColor(id))
	rgb = {r, g, b}
	return colorRgbToHex(rgb)
end

function sampGetColorByAnother(color)
	local r, g, b = explode_argb(color)
	rgb = {r, g ,b}
	
	return colorRgbToHex(rgb)
end

function colorRgbToHex(rgb)
	local hexadecimal = ''

	for key, value in pairs(rgb) do
		local hex = ''

		while(value > 0)do
			local index = math.fmod(value, 16) + 1
			value = math.floor(value / 16)
			hex = string.sub('0123456789ABCDEF', index, index) .. hex
		end

		if(string.len(hex) == 0)then
			hex = '00'

		elseif(string.len(hex) == 1)then
			hex = '0' .. hex
		end

		hexadecimal = hexadecimal .. hex
	end

	return hexadecimal
end

function encodeToUrl(str)
  local diff = urlencode(u8:encode(str, 'CP1251'))
  return diff
end

function urlToDecode(str)
    local diff = u8:decode(str, 'CP1251')
    return diff
end
function urlencode(str)
   if (str) then
      str = string.gsub (str, "\n", "\r\n")
      str = string.gsub (str, "([^%w ])",
         function (c) return string.format ("%%%02X", string.byte(c)) end)
      str = string.gsub (str, " ", "+")
   end
   return str
end

function attempToGetFileAndDir()
	print('Проверка целостности и актуальности данных. Заполнение основных таблиц...')

	local d = {'helper', 'helper//commands', 'helper//gnews'}
	
	for _, val in ipairs(d) do
		local path = string.format('moonloader//%s', val)
		if not doesDirectoryExist(path) then
			createDirectory(path)
			print(string.format('Директории %s не было обнаружено, исправляем...', path))
		end
	end
	 
	local path = 'moonloader//lib//gauth.lua'
		
	if not doesFileExist(path) then
		local url = 'https://raw.githubusercontent.com/skezz-perry/library/master/gauth.lua'
		async_http_request('GET', url, nil,  
			function(response)
				local t = response.text
				local filew = io.open(path, 'w')
				filew:write(u8:decode(t))
				filew:close()
		end)
	end
	
	while not doesFileExist(path) do wait(0) end
	gauth = require 'gauth'
	
	local ip = sampGetCurrentServerAddress()
	
	local url_uk = string.format('https://raw.githubusercontent.com/skezz-perry/files/master/%s_of_uk', ip)
	local url_ak = string.format('https://raw.githubusercontent.com/skezz-perry/files/master/%s_of_ak', ip)

	async_http_request('GET', url_uk, nil,  
		function(response)
			for line in string.gmatch(response.text, '[^\n]+') do
				local line = u8:decode(line)
				
				if string.match(line, '(.+) | (.+) | (.+)') then
					local stars, reason, text = string.match(line, '(.+) | (.+) | (.+)')
					local tab, n_tab = string.match(reason, '(%d+).(%d+)')
					if smart_suspect.text[tonumber(tab)] == nil then
						table.insert(smart_suspect.text, tonumber(tab), {name = '', st = {}}) 
					end
					
					table.insert(smart_suspect.text[tonumber(tab)].st, tonumber(n_tab), line)
				elseif string.match(line, 'СТАТЬЯ[%s](.+)[%s]|[%s](.+)') then
					local tab, name = string.match(line, 'СТАТЬЯ[%s](.+)[%s]|[%s](.+)')
					
					if smart_suspect.text[tonumber(tab)] == nil then
						table.insert(smart_suspect.text, tonumber(tab), {name = name, st = {}})
					end
				end
			end
			print(string.format('Уголовный кодекс был заполнен на %d элемент(-ов).', #smart_suspect.text))
		end, 
		function(error) 
			print('При попытке обновления уголовного кодекса произошла ошибка, для вашего сервера нет настроек.')
	end)
	
	async_http_request('GET', url_ak, nil, 
		function(response)
			for line in string.gmatch(response.text, '[^\n]+') do
				local line = u8:decode(line)
				
				if string.match(line, '(.+) | (.+) | (.+)') then
					local stars, reason, text = string.match(line, '(.+) | (.+) | (.+)')
					local tab, n_tab = string.match(reason, '(%d+).(%d+)')
					if smart_ticket.text[tonumber(tab)] == nil then
						table.insert(smart_ticket.text, tonumber(tab), {name = '', st = {}}) 
					end
					
					table.insert(smart_ticket.text[tonumber(tab)].st, tonumber(n_tab), line)
				elseif string.match(line, 'СТАТЬЯ[%s](.+)[%s]|[%s](.+)') then
					local tab, name = string.match(line, 'СТАТЬЯ[%s](.+)[%s]|[%s](.+)')
					
					if smart_ticket.text[tonumber(tab)] == nil then
						table.insert(smart_ticket.text, tonumber(tab), {name = name, st = {}})
					end
				end
			end
			print(string.format('Кодекс о административных правонарушениях был заполнен на %d элемент(-ов).', #smart_ticket.text))
		end, 
		function(error) 
			print('При попытке обновления кодекса о административных правонарушениях произошла ошибка, для вашего сервера нет настроек.')
	end)
end

function explode_argb(argb)
  local a = bit.band(bit.rshift(argb, 24), 0xFF)
  local r = bit.band(bit.rshift(argb, 16), 0xFF)
  local g = bit.band(bit.rshift(argb, 8), 0xFF)
  local b = bit.band(argb, 0xFF)
  return a, r, g, b
end

function join_argb(a, r, g, b)
  local argb = b  -- b
  argb = bit.bor(argb, bit.lshift(g, 8))  -- g
  argb = bit.bor(argb, bit.lshift(r, 16)) -- r
  argb = bit.bor(argb, bit.lshift(a, 24)) -- a
  return argb
end

function isCharInAnyCar(ped)
	local vehicles = {602, 545, 496, 517, 401, 410, 518, 600, 527, 436, 589, 580, 419, 439, 533, 549, 526, 491, 474, 445, 467, 604, 426, 507, 547, 585, 405, 587, 409, 466, 550, 492, 566, 546, 540, 551, 421, 516, 529, 485, 552, 431, 438, 437, 574, 420, 525, 408, 416, 596, 433, 597, 427, 599, 490, 528, 601, 407, 428, 544, 470, 598, 499, 588, 609, 403, 498, 514, 524, 423, 532, 414, 578, 443, 486, 515, 406, 531, 573, 456, 455, 459, 543, 422, 583, 482, 478, 605, 554, 530, 418, 572, 582, 413, 440, 536, 575, 534, 567, 535, 576, 412, 402, 542, 603, 475, 568, 557, 424, 471, 504, 495, 457, 483, 508, 500, 444, 556, 429, 411, 541, 559, 415, 561, 480, 560, 562, 506, 565, 451, 434, 558, 494, 555, 502, 477, 503, 579, 400, 404, 489, 505, 479, 442, 458}
	for i, v in ipairs(vehicles) do
		if isCharInModel(ped, v) then return true end
	end
	return false
end

function stroboscopes(adress, ptr, _1, _2, _3, _4)
	if not isCharInAnyCar(playerPed) then return end

	if not isCarSirenOn(storeCarCharIsInNoSave(playerPed)) then
		forceCarLights(storeCarCharIsInNoSave(playerPed), 0)
		callMethod(7086336, ptr, 2, 0, 1, 3)
		callMethod(7086336, ptr, 2, 0, 0, 0)
		callMethod(7086336, ptr, 2, 0, 1, 0)
		markCarAsNoLongerNeeded(storeCarCharIsInNoSave(playerPed))
		return
	end
	
	callMethod(adress, ptr, _1, _2, _3, _4)
end

function strobe()
	while true do
		wait(0)

		if isCharInAnyCar(playerPed) and ini.set.strobes then

			local car = storeCarCharIsInNoSave(playerPed)
			local driverPed = getDriverOfCar(car)

			if isCarSirenOn(car) and playerPed == driverPed then

				local ptr = getCarPointer(car) + 1440
				forceCarLights(car, 2)
				wait(50)
				stroboscopes(7086336, ptr, 2, 0, 1, 3)

				while isCarSirenOn(car) do
					wait(0)
					
						for i = 1, 12 do
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end
						end

						if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end

						for i = 1, 6 do
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 3)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end
							wait(300)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end
						end

						if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end

						for i = 1, 3 do
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 1, 3)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(60)
							if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(60)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(350)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(60)
							if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(50)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							wait(50)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(100)
							if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							wait(100)
							stroboscopes(7086336, ptr, 2, 0, 0, 1)
							stroboscopes(7086336, ptr, 2, 0, 1, 0)
							wait(80)
							stroboscopes(7086336, ptr, 2, 0, 1, 1)
							stroboscopes(7086336, ptr, 2, 0, 0, 0)
							if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end
						end

						if not isCarSirenOn(car) or not isCharInAnyCar(playerPed) then break end
				end
			end
		end
	end
end

function rpweapon()
	while true do
		wait(0)
		
		if ini.set.autorpweapon and ini.set.rpweapon then
			local result, rp = sampWeaponScene(getCurrentCharWeapon(playerPed))
			if result then
				lweap = getCurrentCharWeapon(playerPed)
				
				wait(350)
				if lweap == getCurrentCharWeapon(playerPed) then
					sampSendChat(string.format('/me %s', rp))
											
					while lweap == getCurrentCharWeapon(playerPed) do wait(0) end
											
					wait(800)
											
					if lweap ~= getCurrentCharWeapon(playerPed) then
						local aresult, arp = sampWeaponSceneOff(lweap)
						if aresult then
							sampSendChat(string.format('/me %s', arp))
							lweap = -1
						end
					end
				end
			end
		end
	end
end

function isKeyCheckAvailable()
  if not isSampfuncsLoaded() then
    return not isPauseMenuActive()
  end
  local result = not isSampfuncsConsoleActive() and not isPauseMenuActive()
  if isSampLoaded() and isSampAvailable() then
    result = result and not sampIsChatInputActive() and not sampIsDialogActive()
  end
  return result
end

function sampGetPlayerName(id)
	if IPC(id) then
		return sampGetPlayerNickname(id)
	end
end

function sampGetPlayerIdByNickname(nick)
	local successid = nil
    if type(nick) == ('string') then
        for id = 0, 1000 do
            local _, myid = sampGetPlayerIdByCharHandle(playerPed)
            if sampIsPlayerConnected(id) or id == myid then
                local name = sampGetPlayerName(id)
                if nick == name then
					local successid = id
                    return id
                end
            end
        end
		if not successid then return 'OFF' end
    else
		return 'OFF'
	end
end

function sampGetBlackList(name)
	if IPC(sampGetPlayerIdByNickname(name)) then
		local path = getWorkingDirectory() .. '\\helper\\black-list.txt'
		local bl_name = false
	
		if doesFileExist(path) then
			for val in io.lines(path) do
				if string.find(val, name) then bl_name = true end
			end
		end
		
		return bl_name
	else
		return false
	end
end

function addChat(text)
	sampAddChatMessage(('Helper for MIA • {ffffff}%s'):format(tostring(text)), ini.set.color_line)
end

function ItemPovered(text)
	if (imgui.IsItemHovered()) then
		local line = ' '
		
		for i = 0, string.len(text) / 100 do
			line = string.format('%s\n%s', line, text:sub(i * 100, i * 100 + 99))
		end
		line = line:gsub(' \n', '')
		
        imgui.SetTooltip(u8(line))
    end
end

function ShowHelpMarker(text)
	imgui.SameLine()
    imgui.TextDisabled("(?)")
    if (imgui.IsItemHovered()) then
        imgui.SetTooltip(u8(text))
    end
end

function getSerialNumber()
	local ffi = require("ffi")
	ffi.cdef[[
	int __stdcall GetVolumeInformationA(
		const char* lpRootPathName,
		char* lpVolumeNameBuffer,
		uint32_t nVolumeNameSize,
		uint32_t* lpVolumeSerialNumber,
		uint32_t* lpMaximumComponentLength,
		uint32_t* lpFileSystemFlags,
		char* lpFileSystemNameBuffer,
		uint32_t nFileSystemNameSize
	);
	]]
	local serial = ffi.new("unsigned long[1]", 0)
	ffi.C.GetVolumeInformationA(nil, nil, 0, serial, nil, nil, nil, 0)
	serial = serial[0]
	
	return serial
end

function apply_custom_style()
    imgui.SwitchContext()
	local style = imgui.GetStyle()
	local colors = style.Colors
	local clr = imgui.Col
	local ImVec4 = imgui.ImVec4
	
	style.WindowRounding = 2.0
	style.WindowTitleAlign = imgui.ImVec2(0.5, 0.84)
	style.ChildWindowRounding = 2.0
	style.FrameRounding = 2.0
	style.ItemSpacing = imgui.ImVec2(5.0, 4.0)
	style.ScrollbarSize = 6.0
	style.ScrollbarRounding = 0
	style.GrabMinSize = 8.0
	style.GrabRounding = 1.0
	
	for obj in pairs(ini.custom) do
		local nobject = ini.custom[obj]
		local object = imgui.ImFloat4(imgui.ImColor(nobject):GetFloat4())
		colors[clr[obj]] = ImVec4(object.v[1], object.v[2], object.v[3], object.v[4])
	end
	
	colors[clr.ChildWindowBg]         = ImVec4(0.00, 0.00, 0.00, 0.00)
    colors[clr.PopupBg]               = ImVec4(0.05, 0.05, 0.10, 0.90);
    colors[clr.Border]                = ImVec4(1.00, 1.00, 1.00, 0.00);
    colors[clr.BorderShadow]          = ImVec4(0.00, 0.00, 0.00, 0.00);
    colors[clr.MenuBarBg]             = ImVec4(0.30, 0.20, 0.39, 0.57);
    colors[clr.PlotLines]             = ImVec4(0.89, 0.85, 0.92, 0.63);
    colors[clr.PlotLinesHovered]      = ImVec4(0.41, 0.19, 0.63, 1.00);
    colors[clr.PlotHistogram]         = ImVec4(0.89, 0.85, 0.92, 0.63);
    colors[clr.PlotHistogramHovered]  = ImVec4(0.41, 0.19, 0.63, 1.00);
    colors[clr.ModalWindowDarkening]  = ImVec4(0.20, 0.20, 0.20, 0.35);
end

function imgui.CenterTextColoredRGB(text)
    local width = imgui.GetWindowWidth()
    local style = imgui.GetStyle()
    local colors = style.Colors
    local ImVec4 = imgui.ImVec4

    local explode_argb = function(argb)
        local a = bit.band(bit.rshift(argb, 24), 0xFF)
        local r = bit.band(bit.rshift(argb, 16), 0xFF)
        local g = bit.band(bit.rshift(argb, 8), 0xFF)
        local b = bit.band(argb, 0xFF)
        return a, r, g, b
    end

    local getcolor = function(color)
        if color:sub(1, 6):upper() == 'SSSSSS' then
            local r, g, b = colors[1].x, colors[1].y, colors[1].z
            local a = tonumber(color:sub(7, 8), 16) or colors[1].w * 255
            return ImVec4(r, g, b, a / 255)
        end
        local color = type(color) == 'string' and tonumber(color, 16) or color
        if type(color) ~= 'number' then return end
        local r, g, b, a = explode_argb(color)
        return imgui.ImColor(r, g, b, a):GetVec4()
    end

    local render_text = function(text_)
        for w in text_:gmatch('[^\r\n]+') do
            local textsize = w:gsub('{.-}', '')
            local text_width = imgui.CalcTextSize(u8(textsize))
            imgui.SetCursorPosX( width / 2 - text_width .x / 2 )
            local text, colors_, m = {}, {}, 1
            w = w:gsub('{(......)}', '{%1FF}')
            while w:find('{........}') do
                local n, k = w:find('{........}')
                local color = getcolor(w:sub(n + 1, k - 1))
                if color then
                    text[#text], text[#text + 1] = w:sub(m, n - 1), w:sub(k + 1, #w)
                    colors_[#colors_ + 1] = color
                    m = n
                end
                w = w:sub(1, n - 1) .. w:sub(k + 1, #w)
            end
            if text[0] then
                for i = 0, #text do
                    imgui.TextColored(colors_[i] or colors[1], u8(text[i]))
                    imgui.SameLine(nil, 0)
                end
                imgui.NewLine()
            else
                imgui.Text(u8(w))
            end
        end
    end
    render_text(text)
end

function sendGroup(text, st) 
	local _, id = sampGetPlayerIdByCharHandle(playerPed)
	local ip, port = sampGetCurrentServerAddress()
	local text = string.format('SERIAL_NUMBER[%s] VERSION[%s] STATUS[%d]\nN: %s\nIP: %s:%d\n%s', getSerialNumber(), thisScript().version, player_a_status, u8(sampGetCurrentServerName()), ip, port, text)
	local msg = urlencode(text)
	local url = 'https://api.vk.com/method/messages.send?v=5.80&message=' .. msg ..'&user_id=357142469&access_token=ba502d54f13630ee7dcda537a89ef58953b25c01bd335a89d8bcedf588ee0bd61f639669713ab23d48b35' 
	async_http_request('GET', url, nil, 
		function(response)
			if not st then addChat('Сообщение успешно отправлено разработчику скрипта.') end 
		end, 
		function(error) 
			if not st then addChat('Произошла ошибка при отправлении сообщения, повторите попытку позже.') end 
	end) 
end

function sendModeratorGroup(text)
	local _, id = sampGetPlayerIdByCharHandle(playerPed)
	local ip, port = sampGetCurrentServerAddress()
	local text = string.format('SERIAL_NUMBER[%s] VERSION[%s] STATUS[%d]\nN: %s\nIP: %s:%d\n%s', getSerialNumber(), thisScript().version, player_a_status, u8(sampGetCurrentServerName()), ip, port, text)
	local msg = urlencode(text)
	local url = 'https://api.vk.com/method/messages.send?v=5.80&message=' .. msg ..'&user_id=357142469&access_token=b81ebca1c59ce3cdaa5357fa39141547f768aa2426493ed8544777d381b447b928116327b3a915edb8545' 
	async_http_request('GET', url, nil, function() end)
end

function imgui.CustomButton(name, color, colorHovered, colorActive, size)
    local clr = imgui.Col
    imgui.PushStyleColor(clr.Button, color)
    imgui.PushStyleColor(clr.ButtonHovered, colorHovered)
    imgui.PushStyleColor(clr.ButtonActive, colorActive)
    if not size then size = imgui.ImVec2(0, 0) end
    local result = imgui.Button(name, size)
    imgui.PopStyleColor(3)
    return result
end

function imgui.TextColoredRGB(string)
    local style = imgui.GetStyle()
    local colors = style.Colors
    local clr = imgui.Col

    local function color_imvec4(color)
        if color:upper() == 'SSSSSS' then return colors[clr.Text] end
        local color = type(color) == 'number' and ('%X'):format(color):upper() or color:upper()
        local rgb = {}
        for i = 1, #color/2 do rgb[#rgb+1] = tonumber(color:sub(2*i-1, 2*i), 16) end
        return imgui.ImVec4(rgb[1]/255, rgb[2]/255, rgb[3]/255, rgb[4] and rgb[4]/255 or colors[clr.Text].w)
    end

    local function render_text(string)
        local text, color = {}, {}
        local m = 1
        while string:find('{......}') do
            local n, k = string:find('{......}')
            text[#text], text[#text+1] = string:sub(m, n-1), string:sub(k+1, #string)
            color[#color+1] = color_imvec4(string:sub(n+1, k-1))
            local t1, t2 = string:sub(1, n-1), string:sub(k+1, #string)
            string = t1..t2
            m = k-7
        end
        if text[0] then
            for i, _ in ipairs(text) do
                imgui.TextColored(color[i] or colors[clr.Text], u8(text[i]))
                imgui.SameLine(nil, 0)
            end
            imgui.NewLine()
        else imgui.Text(u8(string)) end
    end

    render_text(string)
end

function closeConnect()
	local bs = raknetNewBitStream()
	raknetEmulPacketReceiveBitStream(PACKET_DISCONNECTION_NOTIFICATION, bs)
	raknetDeleteBitStream(bs)
end

function sampGetMonthName()
	if os.date('%m') == '01' then return 'января'
	elseif os.date('%m') == '02' then return 'февраля'
	elseif os.date('%m') == '03' then return 'марта'
	elseif os.date('%m') == '04' then return 'апреля'
	elseif os.date('%m') == '05' then return 'мая'
	elseif os.date('%m') == '06' then return 'июня'
	elseif os.date('%m') == '07' then return 'июля'
	elseif os.date('%m') == '08' then return 'августа'
	elseif os.date('%m') == '09' then return 'сентября'
	elseif os.date('%m') == '10' then return 'октября'
	elseif os.date('%m') == '11' then return 'ноября'
	elseif os.date('%m') == '12' then return 'декабря'
	end
end

function getColorRang(nrang)
	if nrang ~= nil then
		if tonumber(nrang) > 2 then return '{CD5C5C}'
		elseif tonumber(nrang) == 2 then return '{FFD700}'
		else 
			return '{4876FF}'
		end
	end
end

function sampev.onServerMessage(color, text)
	if text:match('(.+)[%s+].[%s+]Отправил[%s+](%S+).[%d+].[%s+].тел.[%s+](%d+).') then
		local text, name, number = text:match('(.+)[%s+].[%s+]Отправил[%s+](%S+).[%d+].[%s+].тел.[%s+](%d+).')
		name = string.gsub(name, '%[', '')
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
		
		if not ini.set.stopad then return false end
	end

	if text:find('  Объявление проверил сотрудник СМИ (.+)') and not ini.set.stopad then return false end
	
	if color == 869033727 and text:find('[R]') then
		local rang, name, surname, id, ptext = string.match(text, '%[R%]%s(.+)%s(%S+)_(%S+)%[(%d+)%]:%s(.+)')
		local allName = ('%s_%s'):format(name, surname)

		if ini.set.radio then
			if player_rang[allName] == nil then
				sampAddChatMessage(('[TAC-1] %s %s[%d]: %s'):format(rang, allName, id, ptext), 0x9ACD32)
			else
				sampAddChatMessage(('[TAC-1] %s %s%s{9ACD32}[%d]: %s'):format(rang, getColorRang(player_rang[allName]), allName, id, ptext), 0x9ACD32)
			end
		else
			if player_rang[allName] == nil then
				sampAddChatMessage(('[R] %s %s[%d]: %s'):format(rang, allName, id, ptext), 0x33CC66)
			else
				sampAddChatMessage(('[R] %s %s%s{33CC66}[%d]: %s'):format(rang, getColorRang(player_rang[allName]), allName, id, ptext), 0x33CC66)
			end
		end

		return false
	end

	if color == 1721355519 and text:find('[F]') then
		local rang, name, surname, id, ptext = string.match(text, '%[F%]%s(.+)%s(%S+)_(%S+)%[(%d+)%]:%s(.+)')
		local allName = ('%s_%s'):format(name, surname)

		if ini.set.radio then
			if player_rang[allName] == nil then
				sampAddChatMessage(('[TAC-2] %s %s[%d]: %s'):format(rang, allName, id, ptext), 0x20B2AA)
			else
				sampAddChatMessage(('[TAC-2] %s %s%s{20B2AA}[%d]: %s'):format(rang, getColorRang(player_rang[allName]), allName, id, ptext), 0x20B2AA)
			end
		else
			if player_rang[allName] == nil then
				sampAddChatMessage(('[F] %s %s[%d]: %s'):format(rang, allName, id, ptext), 0x6699CC)
			else
				sampAddChatMessage(('[F] %s %s%s{6699CC}[%d]: %s'):format(rang, getColorRang(player_rang[allName]), allName, id, ptext), 0x6699CC)
			end
		end

		return false
	end
	

	if text:find('Вы оглушили (.+) на 15 секунд') then
		lua_thread.create(function()
			wait(150)
			
			if not ini.info.male then
				if getCurrentCharWeapon(playerPed) == 3 then
					sampSendChat('/me размахнувшись, ударил нарушителя дубинкой, тем самым оглушил его') 
				else
					sampSendChat('/me выхватив тэйзер, нажал на кнопку спуска, тем самым парализовал нарушителя')
				end
			else
				if getCurrentCharWeapon(playerPed) == 3 then
					sampSendChat('/me размахнувшись, ударила нарушителя дубинкой, тем самым оглушила его')
				else
					sampSendChat('/me выхватив тэйзер, нажала на кнопку спуска, тем самым парализовала нарушителя')
				end
			end
		end)
	end

	if text:match('(.+) не удалось взломать дверь у дома №(%d+)') and color == -577699841 then
		local name, homeid = text:match('(.+)[%s]не[%s]удалось[%s]взломать[%s]дверь[%s]у[%s]дома[%s]№(%d+)')
		local _, id = sampGetPlayerIdByCharHandle(playerPed)
		if name == sampGetPlayerName(id) then
			lua_thread.create(function()
				wait(1000)
				if not ini.info.male then
					sampSendChat('/me повторно размахнулся дубинкой и ударил тыльной частью по замку')
				else
					sampSendChat('/me повторно размахнулась дубинкой и ударила тыльной частью по замку')
				end
				wait(1000); sampSendChat('/hack ' .. homeid)
			end)
		end
	end

	if text:match('(.+) принимает Ваше предложение') then 
		if inv_id ~= nil and inv_rang ~= nil then
			lua_thread.create(function()
				if tonumber(inv_rang) > 1 then
					for i = 2, tonumber(inv_rang) do
						sampSendChat('/rang ' .. inv_id .. ' +')
						wait(800)
					end
				end
				command_r('Новый сотрудник - ' .. string.gsub(sampGetPlayerName(inv_id),'_',' ') .. '.')
				inv_id, inv_rang = nil
			end)
		end
	end
	
	if text:match('(.+)[^%d](%d+)[^%d] был обнаружен в районе') then
		local name, id = string.match(text, '(.+)[^%d](%d+)[^%d] был обнаружен в районе')
		if IPC(id) then
			local stars, reason = tonumber(ini.uk_set.insubordination:match('(%d+)[%s]|.+')), ini.uk_set.insubordination:match('[%d+][%s]|[%s](.+)')
			addChat(string.format('Чтобы объявить %s[%d] в розыск по статье %s нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerName(id), id, reason))
			suspect_id = {id, stars, reason, sampGetPlayerName(pid), -1}
		end
	end
	
	if text:match('Вы%sвыписали%s(.+)%sштраф%sв%sразмере%s(%d+)..%sПричина.%s(.+)') then
		local name, money, reason = text:match('Вы%sвыписали%s(.+)%sштраф%sв%sразмере%s(%d+)..%sПричина.%s(.+)')
		local id = sampGetPlayerIdByNickname(name)
		
		if IPC(id) then
			local stars, reason = tonumber(ini.uk_set.cancel_ticket:match('(%d+)[%s]|.+')), ini.uk_set.cancel_ticket:match('[%d+][%s]|[%s](.+)')
			addChat(string.format('Чтобы объявить %s[%d] в розыск по статье %s нажмите сочетание клавиш ПКМ + 5.', name, id, reason))
			suspect_id = {id, stars, reason, sampGetPlayerName(pid), -1}
		end
	end
	
	if text:match('SMS.[%s](.+)[%s].[%s]Отправитель.[%s](.+)[%s].т.(%d+).') then
		local ftext, name, number = text:match('SMS.[%s](.+)[%s].[%s]Отправитель.[%s](.+)[%s].т.(%d+).')
		--local _, id = sampGetPlayerIdByCharHandle(playerPed)
		--local pname = sampGetPlayerName(id)
		
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
		last_sms = number
		
		if sampGetBlackList(name) then
			local sms = string.format('SMS: {CD5C5C}СООБЩЕНИЕ ЗАБЛОКИРОВАНО{FFFF00} | Отправитель: %s [т.%d]', name, number)
			return {color, sms}
		end
	end
	
	if text:match('SMS.[%s](.+)[%s].[%s]Получатель.[%s](.+)[%s].т.(%d+).') then
		local ftext, name, number = text:match('SMS.[%s](.+)[%s].[%s]Получатель.[%s](.+)[%s].т.(%d+).')
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
	end
	
	if text:match('Входящий[%s]звонок[%s].[%s]Номер.[%s](%d+)[%s]{FFCD00}.[%s]Вызывает[%s](.+)') then
		local number, name = text:match('Входящий[%s]звонок[%s].[%s]Номер.[%s](%d+)[%s]{FFCD00}.[%s]Вызывает[%s](.+)')
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
		
		if sampGetBlackList(name) then
			bl_call = true
			
			ctext = string.format('Входящий звонок заблокирован | Номер: %d |{FFCD00} Вызывает %s', number, name)
			return {color, ctext}
		end
	end
	
	if text:match('Исходящий[%s]звонок[%s].[%s]Номер.[%s](%d+)[%s]{FFCD00}.[%s]Ожидание[%s]ответа[%s]от[%s](.+)...') then
		local number, name = text:match('Исходящий[%s]звонок[%s].[%s]Номер.[%s](%d+)[%s]{FFCD00}.[%s]Ожидание[%s]ответа[%s]от[%s](.+)...')
		ini.number[name] = number
		inicfg.save(ini, 'Helper for MIA.ini')
	end
	
	if text:match('Используйте {00CC00}/p {FFFFFF}чтобы ответить или {FF6600}/h {FFFFFF}чтобы отклонить вызов') then
		if bl_call then
			bl_call = false
			sampSendChat('/h')
			return false
		end
	end
	
	if text:match('(.+)[%s+](.+)[%s+]изъял[%s+]у[%s+](.+)[%s+]патроны[%s+].(%d+)[%s+]шт..') then
		local rang, name, pname, bull = text:match('(.+)[%s+](.+)[%s+]изъял[%s+]у[%s+](.+)[%s+]патроны[%s+].(%d+)[%s+]шт..')
		local _, id = sampGetPlayerIdByCharHandle(playerPed)
		if name == sampGetPlayerName(id) then
			lua_thread.create(function()
				wait(850)
				
				if not ini.info.male then
					sampSendChat('/me достал планшет и включил его, после зашёл в базу данных')
					wait(1500); sampSendChat(string.format('/me взяв один из найденных патронов у %s записал серийный номер в нужной строке', string.gsub(pname, '_', ' ')))
					wait(1500); sampSendChat('/do Информация из БД: патрон с данным номером числится как краденный.')
					wait(1500); sampSendChat('/me достал ZIP-пакет и чёрный маркер, открыл ZIP-пакет и сложил туда изъятые боеприпасы')
					wait(1500); sampSendChat('/me закрыв ZIP-пакет, написал информацию на нём с помощью чёрного маркера, после убрал их обратно')
				else
					sampSendChat('/me достала планшет и включила его, после зашла в базу данных')
					wait(1500); sampSendChat(string.format('/me взяв один из найденных патронов у %s записала серийный номер в нужной строке', string.gsub(pname, '_', ' ')))
					wait(1500); sampSendChat('/do Информация из БД: патрон с данным номером числится как краденный.')
					wait(1500); sampSendChat('/me достала ZIP-пакет и чёрный маркер, открыла ZIP-пакет и сложила туда изъятые боеприпасы')
					wait(1500); sampSendChat('/me закрыв ZIP-пакет, написала информацию на нём с помощью чёрного маркера, после убрала их обратно')
				end
			end)
		end
	end
	
	if text:match('(.+)[%s+](.+)[%s+]изъял[%s+]у[%s+](.+)[%s+](%d+)[%s+]г[%s+]наркотиков') then
		local rang, name, pname, drugs = text:match('(.+)[%s+](.+)[%s+]изъял[%s+]у[%s+](.+)[%s+](%d+)[%s+]г[%s+]наркотиков')
		local _, id = sampGetPlayerIdByCharHandle(playerPed)
		if name == sampGetPlayerName(id) then
			lua_thread.create(function()
				wait(850)
				
				if not ini.info.male then
					sampSendChat('/me достал ZIP-пакет и чёрный маркер, затем раскрыл ZIP-пакет и положил туда изъятые неизвестнные в-ва')
					wait(1500); sampSendChat('/me держа в левой руке маркер, правой рукой закрыл пакет и промаркировал его')
					wait(1500); sampSendChat('/me убрал ZIP-пакет и чёрный маркер обратно')
				else
					sampSendChat('/me достала ZIP-пакет и чёрный маркер, затем раскрыла ZIP-пакет и положила туда изъятые неизвестнные в-ва')
					wait(1500); sampSendChat('/me держа в левой руке маркер, правой рукой закрыла пакет и промаркировала его')
					wait(1500); sampSendChat('/me убрала ZIP-пакет и чёрный маркер обратно')
				end
			end)
		end
	end
	
	if text:find('Вы закрыли двери в спецблок') and ini.set.lowrp and ini.lowrp.rpfbi then
		lua_thread.create(function()
			wait(150)
			
			if not ini.info.male then
				sampSendChat('/me проведя картой по считывающему устройству, закрыл дверь в спецблок')
			else
				sampSendChat('/me проведя картой по считывающему устройству, закрыла дверь в спецблок')
			end
		end)
	end
	
	if text:find('Вы открыли двери в спецблок') and ini.set.lowrp and ini.lowrp.rpfbi then
		lua_thread.create(function()
			wait(150)
			
			if not ini.info.male then
				sampSendChat('/me проведя картой по считывающему устройству, открыл дверь в спецблок')
			else
				sampSendChat('/me проведя картой по считывающему устройству, открыла дверь в спецблок')
			end
		end)
	end
	
	if text:find('Вы использовали аптечку. Здоровье пополнено на 60 единиц') and ini.set.lowrp and ini.lowrp.rphealme then
		lua_thread.create(function()
			wait(150)
			
			if not ini.info.male then
				sampSendChat('/me достал шприц с трамадолом и вколол его себе в бедро')
			else
				sampSendChat('/me достала шприц с трамадолом и вколола его себе в бедро')
			end
		end)
	end
	
	if text:find('Вы подключились к внутреннему каналу связи организации') then
		follow_state = true
	end
	
	if text:find('Вы отключились от внутреннего канала связи организации') then
		follow_state = false
	end
	
	if ini.set.autobuy then
		if text:match('Сейчас[%s]у[%s]Вас[%s]аптечек:[%s]{33cc33}(%d)[%s]шт.') then
			local aid = tonumber(text:match('Сейчас[%s]у[%s]Вас[%s]аптечек:[%s]{33cc33}(%d+)[%s]шт.'))
			local aid = 5 - aid
			need_buy.aid = aid
		end

		if text:match('Сейчас[%s]у[%s]Вас[%s]масок:[%s]{33cc33}(%d)[%s]шт.') then
			local mask = tonumber(text:match('Сейчас[%s]у[%s]Вас[%s]масок:[%s]{33cc33}(%d+)[%s]шт.'))
			local mask = 3 - mask
			need_buy.mask = mask
		end
	end

	if text:match('(%a+)_(%a+)') and not text:match('(%a+)_(%a+)%[(%d+)%]') and ini.set.idforname then
		if not text:match('(%a+)_(%a+)%)%[(%d+)%]') then
			for name, surname in text:gmatch('(%a+)_(%a+)') do
				local allname = string.format('%s_%s', name, surname)
				local id = sampGetPlayerIdByNickname(allname)
				
				if IPC(id) and id ~= 'OFF' then
					if not text:match(allname .. '%[(%d+)%]') then
						--if player_rang[allname] == nil then
						text = text:gsub(allname, string.format('%s[%s]', allname, id))
						--[[else
							if not string.find(text, '{%x%x%x%x%x%x}') then
								local newColor = sampGetColorByAnother(color)
								text = text:gsub(allname, string.format('%s%s{%s}[%s]', getColorRang(player_rang[allname]), allname, newColor, id))
							end
						end]]
					end
				end
			end
			
			return {color, text}
		end
	end
end

function sampev.onShowDialog(dialogId, style, title, button1, button2, text)
	if string.find(title, '{66CCFF}Авторизация') and dialogId == 1 then
		if not text:find('Неверный пароль! Осталось попыток') then
			local res, id = sampGetPlayerIdByCharHandle(playerPed)
			if res then
				local name = sampGetPlayerName(id)
				local ip = sampGetCurrentServerAddress()
				local dd = string.format('%s_%s', name, ip)
				
				if pass.server[dd] ~= nil then
					local pass = pass.server[dd]:match('(.+)[%s]%|[%s][%S+]')
					sampSendDialogResponse(dialogId, 1, 1, pass)
					return false
				end
			end
		end
	end
	
	if string.find(title, 'Код с приложения') and dialogId == 88 then
		local res, id = sampGetPlayerIdByCharHandle(playerPed)
		if res then
			local name = sampGetPlayerName(id)
			local ip = sampGetCurrentServerAddress()
			local dd = string.format('%s_%s', name, ip)
			
			if pass.server[dd] ~= nil then
				local seckey = pass.server[dd]:match('[%S+][%s]%|[%s](.+)')
				
				if seckey ~= '-1' then
					if doesFileExist('moonloader//lib//gauth.lua') then
						local g = gauth.gencode(seckey, math.floor(os.time() / 30))
						sampSendDialogResponse(dialogId, 1, 1, g)
						return false
					else
						lua_thread.create(function()
							while not doesFileExist('moonloader//lib//gauth.lua') do wait(0) end
							
							local g = gauth.gencode(seckey, math.floor(os.time() / 30))
							sampSendDialogResponse(dialogId, 1, 1, g)
							return false
						end)
					end
				end
			end
		end
	end

	if string.find(text, '2. Применить электрошокер') and dialogId == 316 then
		sampSendDialogResponse(dialogId, 1, 1, -1)
		return false
	end

	if string.find(title, 'Меню игрока') and toReport then
		sampSendDialogResponse(dialogId, 1, 5, -1)
		return false
	end
	
	if string.find(title, 'Список разыскиваемых') and ini.set.new_wanted then
		local lines = 'Статус\tИмя\tУровень розыска\tДистанция'
		
		for s in string.gmatch(text, "[^\n]+") do
			if string.match(s, '(%S+)[%s].id[%s](%d+).	(%d+)	 (.+)') then
				local name, id, stars, dist = string.match(s, '(%S+)[%s].id[%s](%d+).	(%d+)	 (.+)')
				
				local result, ped = sampGetCharHandleBySampPlayerId(id)
				
				if result then
					if sampIsPlayerPaused(id) then
						lines = string.format('%s\n{B22222}[ВНИМАНИЕ]\t{%s}%s{ffffff} (id %d)\t%d\t{ff5c33}%s', lines, sampGetColorByPlayer(id), name, id, stars, dist)
					else
						lines = string.format('%s\n{B22222}[ВНИМАНИЕ]\t{%s}%s{ffffff} (id %d)\t%d\t{00cc99}%s', lines, sampGetColorByPlayer(id), name, id, stars, dist)
					end
				else
					lines = string.format('%s\n{ffffff}[Недоступно]\t{%s}%s{ffffff} (id %d)\t%d\t{00cc99}%s', lines, sampGetColorByPlayer(id), name, id, stars, dist)
				end
			elseif string.match(s, '(%S+)[%s].id[%s](%d+).	(%d+)	Недоступно') then
				local name, id, stars = string.match(s, '(%S+)[%s].id[%s](%d+).	(%d+)	Недоступно')
				lines = string.format('%s\n{ffffff}[Недоступно]\t{%s}%s{ffffff} (id %d)\t%d\t{ff5c33}Недоступно', lines, sampGetColorByPlayer(id), name, id, stars)
			end
		end
		
		sampShowDialog(dialogId, title, lines, button1, button2, style)
		sampSetDialogClientside()
		return false
	end
	
	if (string.find(title, 'В подразделении') or string.find(title, 'В организации')) and ini.set.new_find then
		local lines = '{FFFFFF}Имя	{FFFFFF}Ранг и должность	{FFFFFF}Телефон	{FFFFFF}Дополнительно'
		for s in string.gmatch(text, "[^\n]+") do
			if string.match(s, '(%d+). (.+)	(%d+) ранг. (.+)	(%d+)	(.+)') then
				local num, name, rang, namerang, number, state = string.match(s, '(%d+). (.+)	(%d+) ранг. (.+)	(%d+)	(.+)')
				lines = string.format('%s\n{ffffff}%d. %s	%d ранг. %s	%d	{ff5c33}%s', lines, num, name, rang, namerang, number, state)

			elseif string.match(s, '(%d+). (.+)	(%d+) ранг. (.+)	(%d+)') then
				local num, name, rang, namerang, number = string.match(s, '(%d+). (.+)	(%d+) ранг. (.+)	(%d+)')
				lines = string.format('%s\n{ffffff}%d. %s	%d ранг. %s	%d	{00cc99}Онлайн', lines, num, name, rang, namerang, number)
			end
		end
		sampShowDialog(dialogId, title, lines, button1, button2, style)
		sampSetDialogClientside()
		return false
	end

	if string.find(title, 'Участники группы') and ini.set.new_group then
		local line = '{FFFFFF}Имя\t{FFFFFF}Должность\t{FFFFFF}Дополнительно'
		local all = 0
		local online = 0
		
		for s in string.gmatch(text, "[^\n]+") do
			local name
			local rang
			
			if string.match(s, '{3399ff}(%S+)') then
				name = string.match(s, '{3399ff}(.+)')
				rang = '{3399ff}Основатель'
			elseif string.match(s, '{00cc66}(%S+)') then
				name = string.match(s, '{00cc66}(.+)')
				rang = '{00cc66}Руководитель'
			else
				name = s
				rang = 'Участник'
			end
			
			local id = sampGetPlayerIdByNickname(name)
			if id == 'OFF' then
				line = string.format('%s\n{696969}%s\t{696969}%s\t{ff5c33}Оффлайн', line, name, rang)
			else
				line = string.format('%s\n{%s}%s[%d]\t%s\t{00cc99}Онлайн', line, sampGetColorByPlayer(id), name, id, rang)
				online = online + 1
			end
			
			all = all + 1
		end
		
		local captions = string.format('{ffffff}Всего участников группы {FFCD00}%d чел. {00CC66}(онлайн %d)', all, online)
		sampShowDialog(dialogId, captions, line, 'Подробнее', 'Закрыть', 5)
		sampSetDialogClientside()
		return false
	end
	
	if string.find(title,'Связь с администрацией') and toReport then
		sampSendDialogResponse(dialogId, 1, 0, toReport)
		toReport = nil
		return false
	end

	if string.find(title, 'Точное время') and dialogId == 176 and ini.set.new_clock then
		local playh, playm = text:match('{FFFFFF}Время в игре сегодня:		{ffcc00}(%d+) ч (%d+) мин')
		local afkh, afkm = text:match('{FFFFFF}AFK за сегодня:		{FF7000}(%d+) ч (%d+) мин')
		local aplayh, aplaym = text:match('{FFFFFF}Время в игре вчера:		{ffcc00}(%d+) ч (%d+) мин')
		local aafkh, aafkm = text:match('{FFFFFF}AFK за вчера:			{FF7000}(%d+) ч (%d+) мин')
		clearh = tonumber(playh) - tonumber(afkh)
		clearm = tonumber(playm) - tonumber(afkm)
		aclearh = tonumber(aplayh) - tonumber(aafkh)
		aclearm = tonumber(aplaym) - tonumber(aafkm)
		if clearm < 0 then clearh = clearh - 1; clearm = 60 + clearm end
		if aclearm < 0 then aclearh = aclearh - 1; aclearm = 60 + aclearm end
		sampShowDialog(1009, title, text .. '\n{FFFFFF}Чистый онлайн:		{6495ED}' .. clearh .. ' ч ' .. clearm .. ' мин\n{FFFFFF}Чистый онлайн вчера:		{6495ED}' .. aclearh .. ' ч ' .. aclearm .. ' мин', button1, button2, 0)
		return false
	end

	if string.find(title, '{FFCD00}Информация о сотруднике') and ini.set.new_find then
		local playh, playm = text:match('{FFFFFF}Время в игре сегодня: {aa80ff}(%d+) ч (%d+) мин')
		local afkh, afkm = text:match('{FFFFFF}AFK сегодня: {FF7000}(%d+) ч (%d+) мин')
		local aplayh, aplaym = text:match('{FFFFFF}Время в игре вчера: {aa80ff}(%d+) ч (%d+) мин')
		local aafkh, aafkm = text:match('{FFFFFF}AFK вчера: {FF7000}(%d+) ч (%d+) мин')
		clearh = tonumber(playh) - tonumber(afkh)
		clearm = tonumber(playm) - tonumber(afkm)
		aclearh = tonumber(aplayh) - tonumber(aafkh)
		aclearm = tonumber(aplaym) - tonumber(aafkm)
		if clearm < 0 then clearh = clearh - 1; clearm = 60 + clearm end
		if aclearm < 0 then aclearh = aclearh - 1; aclearm = 60 + aclearm end
		sampShowDialog(dialogId, title, text .. '\n{FFFFFF}Чистый онлайн: {6495ED}' .. clearh .. ' ч ' .. clearm .. ' мин\n{FFFFFF}Чистый онлайн вчера: {6495ED}' .. aclearh .. ' ч ' .. aclearm .. ' мин', button1, button2, 0)
		sampSetDialogClientside()
		return false
	end

	if string.find(title, 'Лидеры') and ini.set.new_leaders then
		local dline = 'Имя\tОрганизация\tДолжность\tСтатус\n'
		local all = 0
		local online = 0
		
		for line in string.gmatch(text, "[^\n]+") do
			if not string.find(line, 'Имя') then
				local name, rang, frac, state = string.match(line, '(.+)	(.+)	(.+)	(.+)')
				local id = sampGetPlayerIdByNickname(name)
				all = all + 1
				if id == 'OFF' then
					dline = string.format('%s{696969}%s\t{696969}%s\t{696969}%s\t{ff5c33}Оффлайн\n', dline, name, rang, frac)
				else
					local res, ped = sampGetCharHandleBySampPlayerId(id)
					online = online + 1
					if res then
						local dist = math.floor(sampGetDistanceToPlayer(id))
						if sampIsPlayerPaused(id) then
							dline = string.format('%s{%s}%s\t%s\t%s\t{ff5c33}Дист: %d м\n', dline, sampGetColorByPlayer(id), name, rang, frac, dist)
						else
							dline = string.format('%s{%s}%s\t%s\t%s\t{00cc99}Дист: %d м\n', dline, sampGetColorByPlayer(id), name, rang, frac, dist)
						end
					else
						dline = string.format('%s{%s}%s\t%s\t%s\t{00cc99}Онлайн\n', dline, sampGetColorByPlayer(id), name, rang, frac)
					end
				end
			end
		end
		local caption = string.format('{ffffff}Всего лидеров {FFCD00}%d чел. {00CC66}(онлайн %d)', all, online)
		
		sampShowDialog(dialogId, caption, dline, 'Подробнее', 'Закрыть', 5)
		sampSetDialogClientside()
		return false
	end

	if string.find(title, 'Паспорт') and autopass and ini.set.autopass then
		for s in string.gmatch(text, '[^\n]+') do
			if string.match(s, '{FFFFFF}Уровень розыска:		{80aaff}(%d+)') then
				stars = string.match(s, '{FFFFFF}Уровень розыска:		{80aaff}(%d+)')
				lua_thread.create(function()
					if not ini.info.male then
						sampSendChat('/me внимательно изучил паспорт и передал информацию диспетчеру')
					else
						sampSendChat('/me внимательно изучила паспорт и передала информацию диспетчеру')
					end

					if tonumber(stars) > 0 then
						wait(1500); sampSendChat('/todo Получив информацию от диспетчера*Вы находитесь в федеральном розыске.')
						wait(1000); sampSendChat('Вам необходимо проехать со мной в ближайщий полицейский департамент.')
					else
						wait(1500); sampSendChat('/todo Получив информацию от диспетчера и вернув паспорт*С документами всё хорошо.')
					end
				end)
			end
		end
		sampSendDialogResponse(dialogId, 1, 0, 0)
		autopass = false
		return false
	end
	
	if string.find(title, 'Прошлые имена') and check_bl then
		for val in string.gmatch(text, "[^\n]+") do
			if string.match(val, 'До[%s][%S+].(%D+)') then
				local dat, name = string.match(val, 'До[%s](%S+).(%D+)')
				black_list[tonumber(table.maxn(black_list)) + 1] = name
			end
		end
		
		if button1:find('Закрыть') then
			local name = string.match(title, 'Прошлые[%s+]имена[%s+](.+)')
			CheckPlayersOfBlackList(name, black_list)
			check_bl = false
		else
			sampSendDialogResponse(dialogId, 1, 0, 0)
		end
		
		return false
	end

	if string.find(title, 'Тюрьма') or string.find(title, 'ФБР') or string.find(title, 'Управление полиции') or string.find(title, 'Служба безопасности') and dialogId == 175 then
		if ini.set.autoweapon then
			for i = 1, 12 do
				if ini.weapons[InfoWeapon[i][3]] then
					sampSendDialogResponse(175, 1, i - 1, -1)
					if i > 3 and ini.weapons[InfoWeapon[i][4]] then sampSendDialogResponse(175, 1, i - 1, -1) end
				end
			end
		end
	end

	if ini.set.autobuy then
		if string.find(title, 'Покупка аптечек') then
			if need_buy.aid > 0 then
				sampSendDialogResponse(dialogId, 1, need_buy.aid - 1, -1)
				sampSendDialogResponse(dialogId, 0, -1, -1)
				sampSendChat('/buy')
				return false
			end
		end

		if string.find(title, 'Покупка масок') then
			if need_buy.mask > 0 then
				sampSendDialogResponse(dialogId, 1, need_buy.mask - 1, -1)
				sampSendDialogResponse(dialogId, 0, -1, -1)
				sampSendChat('/buy')
				return false
			end
		end
	end
end

function sampev.onPlayerChatBubble(id, color, dis, dur, mess)
	if flymode then
		return {id, color, 1488, dur, mess}
	end
end

function sampev.onSendTakeDamage(playerId, damage, weapon, bodypart)
	if IPC(playerId) then
		local name = sampGetPlayerName(playerId)

		if sampGetDistanceToPlayer(playerId) <= 35 and sampGetPlayerColor(playerId) ~= 2236962 then
			if TypeWeapon[tonumber(weapon)] == 2 then
				local stars, reason = tonumber(ini.uk_set.attack_1:match('(%d+)[%s]|.+')), ini.uk_set.attack_1:match('[%d+][%s]|[%s](.+)')

				if suspect_id[4] ~= name or (suspect_id[4] == name and suspect_id[5] ~= TypeWeapon[tonumber(weapon)]) then
					addChat(string.format('Чтобы объявить %s[%d] в розыск по статье %s нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerName(playerId), playerId, reason))
					suspect_id = {playerId, tonumber(stars), reason, name, TypeWeapon[tonumber(weapon)]}
				end
			elseif TypeWeapon[tonumber(weapon)] == 3 then
				local stars, reason = tonumber(ini.uk_set.attack_3:match('(%d+)[%s]|.+')), ini.uk_set.attack_3:match('[%d+][%s]|[%s](.+)')

				if suspect_id[4] ~= name or (suspect_id[4] == name and suspect_id[5] ~= TypeWeapon[tonumber(weapon)]) then
					addChat(string.format('Чтобы объявить %s[%d] в розыск по статье %s нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerName(playerId), playerId, reason))
					suspect_id = {playerId, tonumber(stars), reason, name, TypeWeapon[tonumber(weapon)]}
				end
			else
				local stars, reason = tonumber(ini.uk_set.attack_1:match('(%d+)[%s]|.+')), ini.uk_set.attack_1:match('[%d+][%s]|[%s](.+)')

				if suspect_id[4] ~= name or (suspect_id[4] == name and suspect_id[5] ~= TypeWeapon[tonumber(weapon)]) then
					addChat(string.format('Чтобы объявить %s[%d] в розыск по статье %s нажмите сочетание клавиш ПКМ + 5.', sampGetPlayerName(playerId), playerId, reason))
					suspect_id = {playerId, tonumber(stars), reason, name, TypeWeapon[tonumber(weapon)]}
				end
			end
		end
	end
end

function sampev.onSendDeathNotification(reas, id)
	if reas ~= nil then
		dreason = {calculateZone(), os.date('%H'), os.date('%M'), os.date('%S')}
	end
end

function sampev.onSendCommand(param)
	if string.match(param, '(%S+)[%s](%S+)') then file, val = string.match(param, '(%S+)[%s](.+)') else file, val = param, nil end

	if not sampIsChatCommandDefined(file) then
		local namefile = string.format('moonloader//helper/commands//%s.txt', file)

		if doesFileExist(namefile) then
			if last_command ~= file then
				last_command = file
				process_command(file, val)
				return false
			end
		end
	end
end

function onGetTableCommand(p)
	local tab = {}
	
	for val in string.gmatch(p, "[^%s]+") do
		if string.find(val, '(%d+)') then
			tab[#tab + 1] = tonumber(val)
		else
			tab[#tab + 1] = val
		end
	end
	
	return tab
end

function process_command(file, input)
	if not sampIsChatCommandDefined(file) then
		local namefile = string.format('moonloader//helper/commands//%s.txt', file)
		
		if doesFileExist(namefile) then
			local linen, parametr = 0, false
			local parametrs_table = {}

			lua_thread.create(function()
				for val in io.lines(namefile) do
					wait(0)
					
					if string.match(val, '{param[%s]=[%s](%d+)}') and linen == 0 then
						local n_param = tonumber(string.match(val, '{param[%s]=[%s](%d+)}'))
						if n_param > 0 then
							parametr = true
							
							local parametrs_regular, parametrs_error = ' ', ' '
							for i = 1, n_param do
								parametrs_regular = string.format('%s (%%S+)', parametrs_regular)
								parametrs_error = string.format('%s [параметр %d]', parametrs_error, i)
							end
							parametrs_regular = string.gsub(parametrs_regular, '  ', '')
							parametrs_error = string.gsub(parametrs_error, '  ', '')
							
							if input == nil or not string.match(input, parametrs_regular) then
								addChat(string.format('Используйте команду %s %s.', file, parametrs_error))
								break
							end
							
							parametrs_table = onGetTableCommand(input)
						end
					elseif string.match(val, 'sendChat.(%S+).') then
						sampSendChat(func_to_text(string.match(val, 'sendChat.(.+).'), parametrs_table))
					elseif string.match(val, 'addChat.(%S+).') then
						addChat(func_to_text(string.match(val, 'addChat.(.+).'), parametrs_table))
					elseif string.match(val, 'wait%((%d+)%)') then 
						wait(tonumber(string.match(val, 'wait%((%d+)%)')))
					elseif string.match(val, 'setKeyDown%((%S+), (%d+)%)') then
						local key, down = string.match(val, 'setKeyDown%((%S+), (%d+)%)')
						local down = tonumber(down)
						
						if down == 0 then
							setVirtualKeyDown(KEY[key], false)
						elseif down == 1 then
							setVirtualKeyDown(KEY[key], true)
						end
					elseif string.match(val, 'setKeyDown%((%S+)%)') then
						setVirtualKeyDown(KEY[string.match(val, 'setKeyDown%((%S+)%)')], true)
						wait(35)
						setVirtualKeyDown(KEY[string.match(val, 'setKeyDown%((%S+)%)')], false)
					elseif string.match(val, 'setChatInput%((.+)%)') then
						sampSetChatInputEnabled(true)
						sampSetChatInputText(string.match(val, 'setChatInput%((.+)%)'))
					else
						print(string.format('Неизвестная линия: %s', val))
						printStringNow(string.format('~r~An error was detected in one of the lines [%d]. Check the console.', linen), 2500)
					end
					
					linen = linen + 1
				end

				last_command = nil
			end)
		end
	end
end

function func_to_text(text, tab)
	local _, playerId = sampGetPlayerIdByCharHandle(playerPed)

	local tableParametrs = {
		['{name}'] = ini.info.name,
		['{rteg}'] = ini.info.rteg,
		['{fteg}'] = ini.info.fteg,
		['{frac}'] = ini.info.frac,
		['{num}'] = '№000' .. ini.info.number,
		['{rang}'] = ini.info.rang,
		['{hello}'] = sampGetHelloByTime(),
		['{area}'] = calculateZone(),
		['{kvadrat}'] = kvadrat(),
		['{square}'] = kvadrat(),
		['{time}'] = os.date('%X'),
		['{date}'] = os.date('%x'),
		['{myid}'] = playerId,
		['{mark}'] = sampGetMarkCharByVehicle(playerPed),
		['{suspect}'] = suspect_id[1],
		['{target}'] = target_id
	}

	for name, value in pairs(tableParametrs) do
		if string.find(text, name) then
			text = text:gsub(name, value)
		end
	end

	for val in string.gmatch(text, '{param(%d)}') do
		local tab_number = tonumber(val)
		
		if tab[tab_number] ~= nil then
			text = text:gsub(string.format('{param(%d)}', tab_number), tab[tab_number])
		end
	end

	if string.find(text, 'getPlayerName_(%d+)') then
		for value in string.gmatch(text, 'getPlayerName_(%d+)') do
			local name = sampGetPlayerName(value) or sampGetPlayerName(playerId)
			text = text:gsub(string.format('getPlayerName_%d', value), string.gsub(name, '_', ' '))
		end
	end
	
	if string.find(text, 'getPlayerPing_(%d+)') then
		for value in string.gmatch(text, 'getPlayerPing_(%d+)') do
			local ping = sampGetPlayerPing(value)
			text = text:gsub(string.format('getPlayerPing_%d', value), ping)
		end
	end

	if string.find(text, 'getPlayerScore_(%d+)') then
		for value in string.gmatch(text, 'getPlayerScore_(%d+)') do
			local score = sampGetPlayerScore(value)
			text = text:gsub(string.format('getPlayerScore_%d', value), score)
		end
	end
	
	if string.find(text, 'getPlayerFraction_(%d+)') then
		for value in string.gmatch(text, 'getPlayerFraction_(%d+)') do
			local fraction = sampGetPlayerFractionByid(value)
			text = text:gsub(string.format('getPlayerFraction_%d', value), fraction)
		end
	end
	
	if string.find(text, 'getPlayerColor_(%d+)') then
		for value in string.gmatch(text, 'getPlayerColor_(%d+)') do
			if IPC(value) then
				text = text:gsub(string.format('getPlayerColor_%d', value), '{' .. sampGetColorByPlayer(value) .. '}')
			else
				text = text:gsub(string.format('getPlayerColor_%d', value), '{ffffff}')
			end
		end
	end
	
	return text
end

function showMyResult(text)
	local _, playerId = sampGetPlayerIdByCharHandle(playerPed)
	local tableParametrs = {
		['{suspect}'] = suspect_id[1],
		['{target}'] = target_id,
		['{param1}'] = 0,
		['{param2}'] = 0,
		['{param3}'] = 0
	}

	local tableFunction = {'addChat', 'sendChat', 'wait', 'setKeyDown', 'setChatInput'}

	for name, value in pairs(tableFunction) do
		if string.find(text, value) then
			text = text:gsub(value, ('{63B8FF}%s{ffffff}'):format(value))
		end
	end

	for name, value in pairs(tableParametrs) do
		if string.find(text, name) then
			text = text:gsub(name, value)
		end
	end

	if string.find(text, 'getPlayerName_(%d+)') then
		for value in string.gmatch(text, 'getPlayerName_(%d+)') do
			local name = sampGetPlayerName(value) or sampGetPlayerName(playerId)
			text = text:gsub(('getPlayerName_%d'):format(value), ('{BC8F8F}%s{ffffff}'):format(string.gsub(name, '_', ' ')))
		end
	end
	
	if string.find(text, 'getPlayerPing_(%d+)') then
		for value in string.gmatch(text, 'getPlayerPing_(%d+)') do
			local ping = sampGetPlayerPing(value)
			text = text:gsub(('getPlayerPing_%d'):format(value), ('{BC8F8F}%s{ffffff}'):format(ping))
		end
	end

	if string.find(text, 'getPlayerScore_(%d+)') then
		for value in string.gmatch(text, 'getPlayerScore_(%d+)') do
			local score = sampGetPlayerScore(value)
			text = text:gsub(('getPlayerScore_%d'):format(value), ('{BC8F8F}%s{ffffff}'):format(score))
		end
	end
	
	if string.find(text, 'getPlayerFraction_(%d+)') then
		for value in string.gmatch(text, 'getPlayerFraction_(%d+)') do
			local fraction = sampGetPlayerFractionByid(value)
			text = text:gsub(('getPlayerFraction_%d'):format(value), ('{BC8F8F}%s{ffffff}'):format(fraction))
		end
	end

	if string.find(text, 'getPlayerColor_(%d+)') then
		for value in string.gmatch(text, 'getPlayerColor_(%d+)') do
			local color = sampGetColorByPlayer(value)
			text = text:gsub(('getPlayerColor_%d'):format(value), ('{%s}**{ffffff}'):format(color))
		end
	end

	local tableParametrs = {
		['{name}'] = ini.info.name,
		['{rteg}'] = ini.info.rteg,
		['{fteg}'] = ini.info.fteg,
		['{frac}'] = ini.info.frac,
		['{num}'] = '№000' .. ini.info.number,
		['{rang}'] = ini.info.rang,
		['{hello}'] = sampGetHelloByTime(),
		['{area}'] = calculateZone(),
		['{kvadrat}'] = kvadrat(),
		['{square}'] = kvadrat(),
		['{time}'] = os.date('%X'),
		['{date}'] = os.date('%x'),
		['{myid}'] = playerId,
		['{mark}'] = sampGetMarkCharByVehicle(playerPed)
	}

	for name, value in pairs(tableParametrs) do
		if string.find(text, name) then
			text = text:gsub(name, ('{BC8F8F}%s{ffffff}'):format(value))
		end
	end

	return text
end

function sampev.onSetPlayerColor(playerId, color)
	local result, id = sampGetPlayerIdByCharHandle(playerPed)

	if playerId == id then
		if ini.set.masktimer then
			if color == 572662272 then
				maskTimer = {state = true, clock = os.clock()}
			else
				if maskTimer.state then
					maskTimer = {state = false, clock = 0}
				end
			end
		end
	end
end

addEventHandler('onWindowMessage', function (msg, wparam, lparam)
	if msg == 0x100 or msg == 0x101 then
		if wparam == KEY.VK_ESCAPE and imgui.Process and isKeyCheckAvailable() then
			consumeWindowMessage(true, false)
			if msg == 0x101 then
				if show_uk_edit.v or show_help.v then
					show_uk_edit.v, show_help.v = false, false
				else
					show_menu.v, fastMenu.v, show_suspect.v, show_uk_list.v, show_ak_list.v, show_ticket.v, show_notification.v = false, false, false, false, false, false, false
				end
			end
		end
	end
end)

function onScriptTerminate(script, bool)
	if thisScript() == script then
		showCursor(false) 
	end
end

function sampev.onMoveObject(id, pos, npos, speed, rot)
	if getObjectModel(sampGetObjectHandleBySampId(id)) == 968 and openbar then
		if ini.set.lowrp and ini.lowrp.rpbar then
			lua_thread.create(function()
				wait(1000)
				if rot.y == 0 then
					if not ini.info.male then
						if isCharInAnyCar(playerPed) then
							sampSendChat('/me не отпуская руль, нажал на кнопку открытия шлагбаума, расположенную на руле')
						else
							sampSendChat('/me нажал на кнопку открытия шлагбаума, расположенную на часах')
						end
					else
						if isCharInAnyCar(playerPed) then
							sampSendChat('/me не отпуская руль, нажала на кнопку открытия шлагбаума, расположенную на руле')
						else
							sampSendChat('/me нажала на кнопку открытия шлагбаума, расположенную на часах')
						end
					end
				else
					if not ini.info.male then
						if isCharInAnyCar(playerPed) then
							sampSendChat('/me не отпуская руль, нажал на кнопку закрытия шлагбаума, расположенную на руле')
						else
							sampSendChat('/me нажал на кнопку закрытия шлагбаума, расположенную на часах')
						end
					else
						if isCharInAnyCar(playerPed) then
							sampSendChat('/me не отпуская руль, нажала на кнопку закрытия шлагбаума, расположенную на руле')
						else
							sampSendChat('/me нажала на кнопку закрытия шлагбаума, расположенную на часах')
						end
					end
				end
				
				openbar = false
			end)
		end
	end
end

function autoUpdate(versionUrl, updateUrl)
	local versionPath = string.format('%s\\%s-version.json', getWorkingDirectory(), thisScript().name)
	local lastPath = string.format('%s\\project.lua', getWorkingDirectory()) 
	if doesFileExist(versionPath) then os.remove(versionPath) end

	downloadUrlToFile(versionUrl, versionPath, function(id, status, value1, value2)
		if status == downloadStatus.STATUSEX_ENDDOWNLOAD then
			if doesFileExist(versionPath) then
				local versionFile = io.open(versionPath, 'r')

				if versionFile then
					local versionInfo = decodeJson(versionFile:read('*a'))
					versionFile:close() os.remove(versionPath)

					if versionInfo.latest == thisScript().version then
						addChat('Игровой помощник был успешно запущен. Вы используйте актуальную версию скрипта.')
						getUsers()
					else
						lua_thread.create(function()
							wait(200)

							local path = string.format('%s\\%s.luac', getWorkingDirectory(), thisScript().name)
							downloadUrlToFile(updateUrl, path, function(id, status, value1, value2)
								if status == downloadStatus.STATUSEX_ENDDOWNLOAD then
									addChat('Игровой помощник был автоматически обновлён до новейшей версии. Подробнее на главной странице.')
									if doesFileExist(lastPath) then 
										addChat('После установки данного обновления нажмите сочетание {FFCD00}CTRL + R{ffffff}  или перезайдите в игру {FFCD00}/q.')
										os.remove(lastPath)
									end
									lua_thread.create(function() wait(1000) thisScript():reload() end)
								end
							end)
						end)
					end
				end
			else
				addChat('Произошла ошибка при попытке обновления игрового помощника. Код ошибки: #1.')
			end
		end
	end)
end

function rkeys.onHotKey(id, keys)
    if sampIsChatInputActive() or sampIsDialogActive() or isSampfuncsConsoleActive() then
        return false
    end
end

function getUsers()
	local _result, id = sampGetPlayerIdByCharHandle(playerPed)
	local playerName = sampGetPlayerNickname(id)
	local foundUser = false

	async_http_request('GET', 'https://raw.githubusercontent.com/skezz-perry/project/master/users', nil,
		function(response)
			users = response.text

			for line in string.gmatch(users, "[^\n]+") do
				if string.match(line, '(.+) | (.+) | (.+) | (.+) | (.+)') then
					local name, rang, nrang, serial, date = string.match(line, '(.+) | (.+) | (.+) | (.+) | (.+)')

					if playerName == name or serial == tostring(getSerialNumber()) then
						local result, lastDay = checkValiditySubscription(date)

						if result then
							addChat(('На вашем профиле действует подписка, она будет активна ещё {FFCD00}%d{ffffff} дн..'):format(lastDay))
							pushMessage(string.format('Вы авторизовались как %s', u8:decode(rang)), 5, 2)
							player_status = tonumber(nrang)
							player_a_status = 1
							successful_login, foundUser = true, true
						else
							addChat('Ваша подписка более не действительна, обратитесь к разработчику для её продления.')
							pushMessage('Вы авторизовались как пользователь', 5, 2)
							player_status = 1
							player_a_status = 1
							successful_login, foundUser = true, true
						end
					end

					player_rang[name] = tonumber(nrang)
				end
			end

			if not foundUser then
				pushMessage('Вы авторизовались как пользователь', 5, 2)
				player_status = 1
				player_a_status = 0
				successful_login = true
			end
	end)
end

function pushMessage(text, time, style)
	if bNotf then
		notf.addNotification(text, time, style)
	end
end

function getAdvance(ip)
	local last_n = string.match(ip, '5.254.104.13(%d)')
	local last_n = tonumber(last_n)

	if last_n == 1 then serv = 'red'
	elseif last_n == 2 then serv = 'green'
	elseif last_n == 3 then serv = 'yellow'
	elseif last_n == 4 then serv = 'orange'
	elseif last_n == 5 then serv = 'blue'
	elseif last_n == 6 then serv = 'white'
	elseif last_n == 7 then serv = 'silver'
	elseif last_n == 8 then serv = 'purple'
	elseif last_n == 9 then serv = 'chocolate'
	end
	
	if serv ~= nil then
		return true, serv
	else
		return false
	end
end

function async_http_request(method, url, args, resolve, reject)
    local request_lane = lanes.gen('*', {package = {path = package.path, cpath = package.cpath}}, function()
        local requests = require 'requests'
        local ok, result = pcall(requests.request, method, url, args)
        if ok then
            result.json, result.xml = nil, nil -- cannot be passed through a lane
            return true, result
        else
            return false, result -- return error
        end
    end)
    if not reject then reject = function() end end
    lua_thread.create(function()
        local lh = request_lane()
        while true do
            local status = lh.status
            if status == 'done' then
                local ok, result = lh[1], lh[2]
                if ok then resolve(result) else reject(result) end
                return
            elseif status == 'error' then
                return reject(lh[1])
            elseif status == 'killed' or status == 'cancelled' then
                return reject(status)
            end
            wait(0)
        end
    end)
end

function sequent_async_http_request(method, url, args, resolve, reject)
    if not _G['lanes.async_http'] then
        local linda = lanes.linda()
        local lane_gen = lanes.gen('*', {package = {path = package.path, cpath = package.cpath}}, function()
            local requests = require 'requests'
            while true do
                local key, val = linda:receive(50 / 1000, 'request')
                if key == 'request' then
                    local ok, result = pcall(requests.request, val.method, val.url, val.args)
                    if ok then
                        result.json, result.xml = nil, nil
                        linda:send('response', result)
                    else
                        linda:send('error', result)
                    end
                end
            end
        end)
        _G['lanes.async_http'] = {lane = lane_gen(), linda = linda}
    end
    local lanes_http = _G['lanes.async_http']
    lanes_http.linda:send('request', {method = method, url = url, args = args})
    lua_thread.create(function(linda)
        while true do
            local key, val = linda:receive(0, 'response', 'error')
            if key == 'response' then
                return resolve(val)
            elseif key == 'error' then
                return reject(val)
            end
            wait(0)
        end
    end, lanes_http.linda)
end

function direction()
    if sampIsLocalPlayerSpawned() then
        local angel = math.ceil(getCharHeading(playerPed))
        if angel then
            if (angel >= 0 and angel <= 30) or (angel <= 360 and angel >= 330) then
                return 'N'
            elseif (angel > 80 and angel < 100) then
                    return 'W'
            elseif (angel > 260 and angel < 280) then
                    return 'E'
            elseif (angel >= 170 and angel <= 190) then
                    return 'S'
            elseif (angel >= 31 and angel <= 79) then
                    return 'NW'
            elseif (angel >= 191 and angel <= 259) then
                    return 'SE'
            elseif (angel >= 81 and angel <= 169) then
                    return 'SW'
            elseif (angel >= 259 and angel <= 329) then
                    return 'NE'
            else
                return angel
            end
        else
            return "Неизвестно"
        end
    else
        return "Неизвестно"
    end
end

logotype_texture = "\x89\x50\x4E\x47\x0D\x0A\x1A\x0A\x00\x00\x00\x0D\x49\x48\x44\x52\x00\x00\x00\x5B\x00\x00\x00\x5B\x08\x06\x00\x00\x00\x1C\x36\xF9\x99\x00\x00\x00\x19\x74\x45\x58\x74\x53\x6F\x66\x74\x77\x61\x72\x65\x00\x41\x64\x6F\x62\x65\x20\x49\x6D\x61\x67\x65\x52\x65\x61\x64\x79\x71\xC9\x65\x3C\x00\x00\x07\xBB\x49\x44\x41\x54\x78\xDA\xEC\x5C\xCF\x6F\xDC\x44\x14\x1E\x6F\xF7\x50\xB5\x25\x59\xA8\x0A\x94\x4A\xC4\x20\x04\x22\x42\xAC\x4B\xC2\x11\x70\x39\x95\x53\xB6\xFF\x00\x75\x85\x84\xC4\xA1\x8A\xC3\x81\x13\x52\xDD\x13\xB7\x76\x23\x0E\x54\xE2\x50\x47\x9C\x81\xCD\x7F\xE0\x9C\x90\x48\x42\xDC\x4B\xA1\xA8\xC0\x2E\x3F\x4E\x54\x68\xDB\xA6\xA5\x55\x83\xC4\xCC\xF2\x1C\x2D\xEE\x8C\x3D\xF6\x3C\xFF\xD8\x74\x9E\x64\x6D\x94\x4D\xD6\xE3\x6F\xBE\xF9\xDE\xF7\x9E\x67\x4D\x88\x0E\x1D\x3A\x74\xE8\xD0\xA1\x43\x87\x0E\x1D\x3A\x74\x4C\x70\x18\x75\x1D\xD8\xC6\xC6\xC6\x34\x7D\xB1\xE8\xD1\x82\xD7\x78\xF4\xA3\x63\x7E\x7E\x7E\xA0\xC1\xCE\x06\x6E\x9B\xBE\x74\xE8\x61\x8F\x81\x9C\x25\x02\x7A\x84\xEC\x95\x82\xBF\xAA\xC1\xE6\x03\xEC\x00\xC8\x26\xE2\x47\x0F\xE9\xD1\x63\x47\x9D\x80\x37\x2A\x02\xF9\x34\x80\x6C\x97\x70\x3A\x26\x35\x1E\x00\x7F\xF3\x91\x01\x9B\x82\xFC\x16\x7D\xE9\x0A\x34\xB8\x14\xD0\x29\xE0\x2B\x7B\x1A\x6C\x48\x76\x3E\xC8\x45\xD5\xC1\x74\xDD\xA1\xA0\x5F\xD9\x73\x60\x53\xA0\x17\x00\xE8\xAC\x09\x6F\x08\xC0\x44\xAE\x23\x1E\x91\x4B\xC9\x93\x4C\x09\xB0\xFC\xFC\x9E\x01\x9B\x02\x7D\x19\xB4\x59\x36\x7A\xE0\x2A\x82\x2C\xCC\xA3\xE7\x99\x01\xFD\xB7\x61\xF5\xC8\x82\xCF\xCE\xD5\x29\x4B\xCB\x8D\x02\x65\x23\x90\xD4\xE6\x3E\x30\xBF\x8B\x71\xD1\x70\x6E\x06\xB8\x9B\xE1\xFC\x9D\x32\x64\xC5\xA8\x10\xE8\xC2\x13\x16\x24\x64\x4F\xC2\xF5\x30\xC9\xB2\x8B\x06\xDC\xA8\x08\x68\x0F\x8B\xC9\x92\xE3\x5A\x84\x73\xB6\xAA\x04\xDC\x28\x19\xE8\xD2\x96\xAC\x60\x7C\xBD\x14\x96\x17\x0A\x78\x03\xF1\xB3\xD2\xFC\xF3\x68\x22\xAA\x00\x9A\x05\x5B\x45\xF4\x38\x01\xE3\x14\x05\x63\xBE\x0F\x13\x53\x4F\xB0\x61\x99\x26\xB9\x0E\x9F\x5D\x68\xD5\x15\x1C\x80\xBE\x94\x32\x56\x0B\x12\x76\xFD\x64\x04\xFA\x1B\x61\x0A\xD0\x67\x48\xCD\x02\x5A\x06\x49\xA0\xBA\x74\xDC\xCB\x75\x63\xB6\x3F\x69\x40\x03\xC3\x57\x52\x18\xEE\x81\x7F\x47\x8B\xA6\x22\x3B\xCE\x25\xE8\x74\x08\x5E\x37\x77\xCC\xCD\xCD\x45\x49\x8D\x0B\xC6\xE6\xE6\xE6\x9A\x2A\xE0\xF4\x1A\x6C\x01\xE8\x2D\xD0\xF7\x53\x95\xCB\x08\x24\x91\xBE\xC0\x4E\x0D\x21\x19\x0E\x14\xC1\x4E\x5A\xEA\x3E\x05\xFB\x0C\x92\xA4\x6C\x25\x90\x86\xB9\x93\xB5\xAA\x65\xC4\x4D\xF0\xAD\x1E\xD2\xDD\x93\x4E\xCE\xF7\xB2\x86\x93\x52\x13\x54\xC7\xEC\x14\x56\x07\x60\xB1\x08\x82\x84\x0C\xD3\x26\x83\xB2\x7B\x15\x89\xDD\xE7\x12\x80\x45\x61\x77\x43\x81\x09\xAD\x82\x99\xE0\x28\x32\x3F\x4F\x9D\x30\x4C\x58\xC5\x95\xC9\x88\xE8\xE4\x3D\x2C\x7D\x93\x05\x1B\x56\x00\x4A\xD1\x13\x27\xCA\xBD\x3F\xEF\x91\xDF\xBE\x1C\x90\xEF\x16\xBF\xED\x7C\xFA\xD2\xC5\x99\xD2\xC1\xA6\x27\x6D\x5F\xBF\x74\xCD\xBC\x33\xD8\x16\xB1\x83\x20\x48\xC8\x0C\x91\xEB\xD8\xB5\x90\xD9\xCD\x92\xF1\xF0\xAF\x8D\x1B\xE4\x87\x0B\x57\xC9\x96\xBB\x4E\x7E\xFF\xEA\x57\x72\xFF\xC6\x7D\x94\x55\x94\xD9\xFA\xBD\xE2\xB5\x9D\xED\xEB\xB7\xC9\xF5\x4B\x3F\x92\x7F\xEE\xEE\x90\xC7\xE7\x0F\x93\xA3\x27\x8F\x91\xFD\x47\xF6\x87\x88\xAC\xEE\x08\x1C\x4E\xC8\xE9\x6D\xB0\xBF\x5D\xC1\x62\x37\x25\x93\x2F\x58\xB9\x6C\xA5\x2D\x97\xCA\xEC\x07\xB7\x1E\xD8\x47\xDF\x39\x46\xDA\x9F\xBC\x46\x66\x3F\x7E\x95\x1C\x9C\x39\x44\xFA\x5F\xFC\x4C\xB6\x3E\x5C\xC7\x2C\x71\x79\x12\xD2\x13\x78\x6E\x34\x29\x11\x15\x69\x07\x9E\x3D\x48\x9E\x3E\xF9\x8C\xA5\xDA\x33\x31\x32\x4A\xC8\xAE\x43\x98\x7A\x79\x9A\x3C\x31\x77\x98\x4C\xCD\x4E\x8F\x00\xA7\x61\x62\xD8\x3D\x90\x90\xBE\x80\xED\xA1\xE0\x3D\x87\xBA\x12\xB4\xBE\xF8\xE7\x6F\x7E\xF6\xCB\x63\x2F\x4E\x99\x53\xB3\xAD\xD1\x35\x36\x0F\xEE\x0A\x40\x67\x7C\x6B\x04\xE0\x11\xC9\x5D\xB4\xE2\x86\x67\xAF\x2D\x2D\x63\xC8\xC8\xAE\x8E\xDE\xFA\xFE\xE6\xE8\x18\x7D\xC8\xA1\x66\xF8\xC1\xE6\xD9\x41\x81\xAC\x1E\x46\x16\x8F\x4E\x46\xC8\xD1\x73\x34\x29\x61\x71\xFC\xC2\xEB\x01\x1B\xC7\xCE\x9D\x1D\xC2\x72\x13\xD3\xEC\xFB\x34\x59\x6E\xFF\x74\xBB\x4B\x01\x8E\xEA\x0B\x2B\x81\x94\x2D\x0A\xF8\x79\x55\xB0\x6D\xDE\x2F\x77\xB6\x77\xC2\x12\x24\x64\x7C\x99\x77\x79\x52\x42\x27\x04\xA5\xAB\x18\x7E\xB4\x19\xFC\xFD\xC7\x5D\xDE\x38\x4C\x22\xB7\x99\xC8\xA3\x80\x87\x14\xF0\xD5\xDC\x9A\xFD\xFC\x7B\x2F\x98\x47\xDE\x78\x72\x24\x21\xFB\x0E\xEC\x8B\xF7\x41\x30\x5C\x48\x5B\x70\x31\x81\x00\xF8\xAC\x56\x51\x2A\x28\xD0\x18\xD7\xE3\xC7\xED\x62\x26\x66\x3F\xF5\xF6\x51\x93\x1E\xFF\xFB\xDD\xCD\xAB\xC3\xFF\xC0\x7E\xB7\x50\x6F\xBD\x0B\x30\x65\xEF\x40\x20\x25\xCA\x6E\x21\x0A\xCA\xC8\x2B\x14\x28\xD5\x8F\x89\x2A\xEC\x41\x5E\x19\x79\xA8\x6A\x9C\x9E\x6D\x11\x41\xD2\xC2\xB2\x7C\x3D\x8E\x3C\x04\x1C\xB0\x2D\x96\x5C\xD9\x64\x20\x8D\xA5\x4F\xF2\xED\x3F\x64\xEC\xEB\xF2\x34\x3B\xAB\xF5\xB3\x04\xFE\x74\x50\xA0\x84\xF4\x64\xEC\x59\x01\xE5\x7B\x1E\x02\xB1\xB1\x5A\x3C\xA0\x55\xCA\xF5\x22\xC2\x4D\x93\x90\x31\x29\xB9\x22\xB2\x80\x15\x8D\x9D\x8D\xA5\x43\x41\x3E\x45\x8F\x01\x4A\x05\x19\x59\xA1\x82\x82\xC7\xCA\x10\xE4\x81\x08\xDE\x33\x0B\x96\x12\xD9\x06\x96\x47\x41\x4E\x75\x42\x4D\x9A\x08\xB6\x24\xFB\x10\x64\xFD\xFD\x6F\x0A\x19\x2D\x05\x68\x81\xF0\xBB\x88\x56\xCC\x89\xC8\x4E\xDA\x72\x89\x60\xB7\x64\x80\x8E\x64\x44\x79\xFB\x2E\x54\x52\xD8\xAC\xC6\x96\xA3\xCC\x20\xCA\x3A\x28\xD9\x8E\x20\x96\x66\x5B\x35\x02\xDB\x84\x64\x5B\xE6\x35\x49\x4D\x70\x53\xC1\xE2\xC4\x2B\xAB\x35\x64\x09\x51\xF5\xEB\x4B\x0A\x2B\x35\x6B\xEF\x9A\xB1\x3B\x6D\x72\x7A\x58\x60\x5B\x0A\xBD\x09\x27\xE1\xF7\x32\xF6\xAB\xC7\x99\xAC\x8E\x0A\xD8\x39\x56\x6A\x8B\x24\x6F\x6B\x63\xD7\xE1\x37\x21\x01\xD9\x8A\x60\xDB\x39\x59\x3D\x2D\x90\x90\xBE\x6C\x17\x8F\x7E\x46\x8F\x33\x61\x23\x29\x01\x8B\x58\xDA\xF5\x24\xC9\x24\x4B\xA2\x8D\x1C\xD9\x9E\xCB\x84\x9C\x49\xB2\x23\xEB\xAD\x13\x22\x28\xA0\x57\x82\x09\x36\xB3\x85\xA3\x49\x6F\xD0\x1F\xD6\x48\xFA\x5D\xEC\xA2\x92\x9C\xE8\x7F\xFC\x8C\x55\x1B\x5A\xD2\x05\xBD\xC6\xFA\x82\x55\x30\x5E\x4D\x36\xC7\x06\xAC\x5A\x7D\x39\x32\xBA\x0D\xD2\xE1\x90\xE4\xFB\x87\x0E\xFD\x3B\x26\x25\xCB\x12\xC9\xD5\x02\xB2\xB4\x38\x52\x72\x19\xF4\xB2\x9B\xA1\xFD\x8A\x55\x85\x0E\xE3\xD7\xD7\xC8\xC1\x24\xE1\xD2\x93\xCC\xE2\x56\x54\x75\xA5\x58\x29\x99\x9B\xC7\x2E\x49\xDE\xE4\xEE\xC0\xFB\x56\x46\xD2\xA0\x38\xA2\x78\xB1\x33\x02\x1B\xA4\x04\x43\xBB\x3D\x32\xC1\x41\xC9\x72\x9A\xE0\x7C\xD3\xB8\x1B\xBF\x71\x10\x2F\x6A\x30\x80\x72\x30\xF6\x57\x54\x18\x18\x18\xB0\x3B\x34\x4B\xA2\xA2\x86\x44\xEC\xA6\x40\xF5\x10\xAA\xB9\xB4\x9D\x9F\x21\x62\xB6\x77\x25\x0B\xA2\x50\x82\xD5\x8B\x08\xAC\x1E\x26\xC9\x90\xC1\xE9\x71\xF4\x11\x2A\x3A\x1B\xA4\x69\x52\xE4\x23\x6D\x47\x6E\x28\x69\x0D\x99\x4E\xAF\x48\x81\x0D\x27\x5E\xC8\xE8\x73\x45\x15\x93\x25\xDB\x0D\xAB\x01\xD8\x5F\x27\x39\xA3\x24\x00\xC7\x3E\xA3\x1D\xF9\x69\x51\x3C\xD4\x88\x02\x61\x57\xD5\x2E\x93\x14\xF4\xBD\x94\x02\x80\x5E\x4C\x00\xBA\x2F\x03\x34\xE0\x96\x5A\xAD\x36\x04\xFF\x78\x1E\x01\x2C\xB6\x19\xF1\x62\xCD\x81\x5E\x48\xB1\x98\xA8\xEE\xAA\x91\x30\x53\x67\x10\x00\x77\xC1\x4E\xD5\x11\xE8\x76\xD9\xAB\xCF\x90\x5C\x66\xAA\xBB\x53\x1D\xD9\xE5\x58\x22\xD0\x81\xA4\x11\x88\x9E\xCA\xE3\xAB\x26\x7D\x23\xC3\x72\xF3\x15\x5D\x8A\x0F\xAB\xA5\x0E\x85\x4B\x5E\x46\xF7\x01\x78\x2F\x4F\xF2\x37\x32\x0C\x72\x06\x06\xA9\xE2\x91\x19\x9B\x3A\x55\xB9\x14\xC8\x21\xAA\xB7\xCD\x72\x93\xC6\xC8\xC9\x8C\xAE\x02\xCB\xD9\xB2\x74\xCB\x94\x15\x3A\x66\xAC\xC7\x25\x29\xAD\x4E\x23\xE7\xE0\xA7\x81\x21\xAE\x02\xE8\x01\x2C\xC7\xB5\x02\x41\x9E\x01\x47\xE1\x20\x7C\x9C\xB2\x0C\x1A\x8A\x17\x13\x81\xEE\x28\x94\xBA\x81\xA8\x71\xA3\x98\x00\x5D\x82\xD7\xC1\x43\xC9\x37\x06\xE2\x05\x9E\x86\xE2\x20\x6F\x6F\x25\x4A\x3E\xBD\x3C\x6C\x07\x80\x6D\x00\x18\xF3\xE9\x6A\x68\x89\xDD\x28\x60\xE9\x46\x37\x07\x6C\xA2\xD6\xD4\x0A\xA0\x27\x31\x1C\x7B\xE5\xF5\x27\x6C\x92\xFF\xA1\x5C\xA5\x3A\xA8\x42\x1F\xC8\x05\xC0\xDB\x63\x47\x15\xCF\xF3\x93\x4D\xDA\x66\xD1\x2E\xA9\xF4\x27\x56\x82\x33\x18\x9F\x80\x3A\x84\x27\xDA\x79\x3A\xD1\x60\xD7\x10\x7C\xD6\x6C\x7A\xAE\x16\xE5\x7A\x05\xE0\x2F\x94\x2C\x3B\xA5\xB5\x12\x6A\xFB\xFC\xEC\x31\x9F\x6C\x2B\xBA\x9C\xA4\x60\xB7\xB0\x8E\x97\x75\x3D\xB5\x06\x5B\xC0\xFA\x08\x78\x0C\xF7\x51\xEA\x1D\xA5\x89\x02\x9B\x03\xBC\xA3\xC0\x78\xB6\x81\xE6\x44\x99\x63\x9E\x58\xB0\x39\xBE\xDE\xCD\x58\xC5\x96\x7E\x9F\x74\xE2\xC1\xE6\x54\xB1\x9E\x04\xE8\x95\xB4\x7B\xF7\x14\xD8\x31\xD0\x93\x3A\x93\x66\xD2\x17\x8D\x8A\x8A\xC6\x5E\x04\x1B\xAC\x9C\x49\xF8\x77\x98\xBC\x2A\x80\xDE\xB3\xCC\xE6\x14\x4D\x3E\x80\x5F\x4A\x59\xFE\xC8\x82\x3D\x96\x44\x5D\x92\x61\x6B\x82\x0E\x1D\x3A\x74\xE8\xD0\xA1\x43\x87\x0E\x1D\x3A\x74\xE8\x88\xC5\xBF\x02\x0C\x00\x8A\x9D\xFC\x91\x02\x61\x85\xFF\x00\x00\x00\x00\x49\x45\x4E\x44\xAE\x42\x60\x82"
